I wish I'd looked at open pull requests sooner, because we were having the exact same issue with the vmdk output. I'd been using bash magic to evaluate the actual size of the file tar, but your approach seems saner.