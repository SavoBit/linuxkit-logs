Well this still works with streaming, it doesn't break that.

What did you have in mind that was different? As far as I could tell there is no point were I could maintain a list of files without re-reading. All images are processed here [ImageTar](https://github.com/linuxkit/linuxkit/blob/master/src/cmd/linuxkit/moby/image.go#L99) that uses the docker client API to stuff the contents of the image into a Reader. Then just writes it directly to the tar writer while excluding or replacing some files.

I guess I could put all the logic there, however I would need the same logic when files are added outside of images. :woman_shrugging: I went this way at first but it seemed a bit gross passing around a pointer to a list.

