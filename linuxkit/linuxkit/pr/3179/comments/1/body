This looks good to me. I don't have an immediately accessible device with `tpm2` (wish I did) or I would test it out as well.

Do we want some sort of preference of one over the other if both exist? Based on this, it looks like it tries `/dev/random` (assuming it to be hwrng, which may or may not be accurate) and then also tries tpm2? My assumption is that we would do one or the other.

It may be fair to say, highly unlikely to have both, but that may be a bad assumption. 