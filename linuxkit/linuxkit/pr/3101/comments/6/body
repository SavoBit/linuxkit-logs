Thanks for the additional comments on the tests.  I've re-written as `onboot` tests as you've requested.  I realize there's still a bit more to tidy up here, but I wanted to at least resolve the issues that you've raised so far.