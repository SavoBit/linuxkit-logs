The rationale for the change in #2961 seemed to be around supporting (cross?) biarch, for which it was not a complete fix (plenty of other places would have needed changing), nor was it clear that a fix was needed at all, for _that_ case.

The rationale here seems much clearer &mdash; specifically  `--rewrite-arch` certainly does need an apk arch name and if uname and apk disagree for arm32 we have to take the apk name. AIUI the paths within the mirror mush also use apk names or apk won't find them. Also unlike the kernel this package is pretty closely tied to alpine.

I'm assuming this doesn't require updates to all the downstream packages since they rely on `/etc/apk/repositories` and `apk` colluding to DTRT, very few (if any) of them should ever be hardcoding a path under `/mirror`.

In the issue it says `Build failed; unable to find /mirrors/armv7l/`, but I'd have expected you to trip over something along the lines of "unknown arch armv7l used with --rewrite-arch` first, what happened there? Did it actually build an empty repo for an unknown arch or something?

This PR goes part of the way to supporting the new arch but surely at least `tools/alpine/push-manifest.sh` needs an update before an armv7 image can actually be built and pushed. I guess there will be other bits across the tree to come too (kernel, `scripts/push-manifest.sh`, the linuxkit build tooling, probably some subset of pkg). Do you have a full working end to end build of armhf from which you cherry-picked this first standalone fix or are you still chipping away at it?

However before we go too far down the path of getting this PR in we should also step back and ask ourselves what we as a project need in order to support a new arch. In particular I think we need a maintainer accessible build machine in order to do the builds which get pushed to hub (which only maintainers can do, and which all maintainers have to be able to do for various boring reasons). I'm not sure what else is needed, @rn was more closely involved in the addition of s390x recently so he may have a better idea.