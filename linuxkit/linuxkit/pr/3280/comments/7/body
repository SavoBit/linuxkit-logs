Thanks for the update. the diff is not much easier to read.

I'm not sure I like this approach. This seems to mount/unmount all disk type devices instead of stopping when one suitable device is found.