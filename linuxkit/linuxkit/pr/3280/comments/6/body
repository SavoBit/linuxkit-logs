I've split the commits as advised.