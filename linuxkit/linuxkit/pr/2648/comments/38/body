> then a new `linuxkit build` command 

ITYM `linuxkit generate`? Not mad enamoured on the name, but no better ideas (`bake` or `substitute` came to mind but not sure they are better).

> I don't understand why you need to walk directories in the code. 

Is that to avoid assuming that the package `linuxkit/foo` is built from `pkg/foo`? Not sure if this holds today (I suspect so). It may not hold for 3rd party repos I guess.

My only concern is whether or not there is some existing YAML templating syntax/library/spec which we could be reusing here instead of inventing my own, and as a corollary to that how `<>` interacts with regular YAML syntax and also how it interacts with the permissible tags for things on hub (i.e. what if I push a literal `linuxkit/foo:<x.y.z>` to hub and want to use it? Are `<>` valid in that context).