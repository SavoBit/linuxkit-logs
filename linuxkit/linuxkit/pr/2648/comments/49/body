You can already get the package hash from a git tag today already, it's currently exposed as the `hash-commit` in `NewFromCLI`.

Although I'm not really sure I follow your use case, I would expect that if the git repo was tagged X.Y there would be a image on hub tagged as `linuxkit/foo:X.Y` so you don't need the indirection you are adding here in the common case. `linxukit pkg push` should push these automatically if the repo is tagged.

I'm also confused by your reference to figuring out the commit and building it since that (specifically building) should be out of scope here I think.

If you give:
```
tags:
  - name: <2.1>
    hash: bb0c6ae2f12a1b55df24ebce2067784a931285df
```
are you expecting to do something more complex than blindly replacing `<2.1>` with `bb0c6ae2f12a1b55df24ebce2067784a931285df`? If so then that's not what I understood from the most recent summary of what this PR was doing https://github.com/linuxkit/linuxkit/pull/2648#issuecomment-355530363.

This PR sorely need to be also adding some documentation for the feature(s) it is adding, the PR comments are now covering too many alternatives and possibilities I have no idea what it is actually intending to do any more. Please add in-tree documentation as a priority so we have a shared understanding of the (current) intention here.