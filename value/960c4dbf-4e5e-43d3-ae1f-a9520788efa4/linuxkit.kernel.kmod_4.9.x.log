[INFO    ] 2017-06-07T15:34:21.982359261Z: Running Test linuxkit.kernel.kmod_4.9.x in /tmp/build/test/cases/020_kernel/010_kmod_4.9.x
[INFO    ] 2017-06-07T15:34:21.982445986Z: Running command: [/bin/sh -x /tmp/build/test/cases/020_kernel/010_kmod_4.9.x/test.sh]
[STDERR  ] 2017-06-07T15:34:22.003751604Z: + set -e
[STDERR  ] 2017-06-07T15:34:22.003787178Z: + . /tmp/build/test/cases/_lib/lib.sh
[STDERR  ] 2017-06-07T15:34:22.003854513Z: + [ -f src/github.com/linuxkit/rtf/lib/lib.sh ]
[STDERR  ] 2017-06-07T15:34:22.003908614Z: + LINUXKIT_TMPDIR=/tmp/build/test/cases/_tmp
[STDERR  ] 2017-06-07T15:34:22.003945234Z: + [ -f /tmp/build/test/cases/_tmp/env.sh ]
[STDERR  ] 2017-06-07T15:34:22.003964016Z: + . /tmp/build/test/cases/_tmp/env.sh
[STDERR  ] 2017-06-07T15:34:22.004003697Z: + export LINUXKIT_EXAMPLES_DIR=/tmp/build/test/cases/../../examples
[STDERR  ] 2017-06-07T15:34:22.004035252Z: + RT_CANCEL=253
[STDERR  ] 2017-06-07T15:34:22.004054103Z: + IMAGE_NAME=kmod-test
[STDERR  ] 2017-06-07T15:34:22.004091946Z: + trap clean_up EXIT
[STDERR  ] 2017-06-07T15:34:22.004110965Z: + docker pull linuxkit/kernel:4.9.x
[STDOUT  ] 2017-06-07T15:34:23.232422617Z: 4.9.x: Pulling from linuxkit/kernel
[STDOUT  ] 2017-06-07T15:34:23.232514912Z: Digest: sha256:196efb2483596900e48cfe45f9fc94f5d8a08419c3581c866a22a090dc3cc53d
[STDOUT  ] 2017-06-07T15:34:23.232562532Z: Status: Image is up to date for linuxkit/kernel:4.9.x
[STDERR  ] 2017-06-07T15:34:23.233360814Z: + docker build -t kmod-test .
[STDOUT  ] 2017-06-07T15:34:23.304803431Z: Sending build context to Docker daemon  9.216kB
[STDOUT  ] 2017-06-07T15:34:23.327732708Z: Step 1/11 : FROM linuxkit/kernel:4.9.x AS ksrc
[STDOUT  ] 2017-06-07T15:34:23.36521198Z:  ---> 8bb08ba0cf2f
[STDOUT  ] 2017-06-07T15:34:23.365279358Z: Step 2/11 : FROM linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b AS build
[STDOUT  ] 2017-06-07T15:34:24.511993137Z: 1b396c221af673757703258159ddc8539843b02b: Pulling from linuxkit/kernel-compile
[STDOUT  ] 2017-06-07T15:34:24.52074668Z: 627beaf3eaaf: Already exists
[STDOUT  ] 2017-06-07T15:34:24.580200057Z: 26dc4067def6: Pulling fs layer
[STDOUT  ] 2017-06-07T15:34:29.018637235Z: 26dc4067def6: Verifying Checksum
[STDOUT  ] 2017-06-07T15:34:29.018720014Z: 26dc4067def6: Download complete
[STDOUT  ] 2017-06-07T15:34:35.76405399Z: 26dc4067def6: Pull complete
[STDOUT  ] 2017-06-07T15:34:35.788235095Z: Digest: sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-06-07T15:34:35.803076978Z: Status: Downloaded newer image for linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-06-07T15:34:35.803617391Z:  ---> 261c60c4eb02
[STDOUT  ] 2017-06-07T15:34:35.803719448Z: Step 3/11 : COPY --from=ksrc /kernel-dev.tar /
[STDOUT  ] 2017-06-07T15:34:37.832379173Z:  ---> 23a26d66bd3d
[STDOUT  ] 2017-06-07T15:34:38.077242617Z: Removing intermediate container 96ca0bb6010b
[STDOUT  ] 2017-06-07T15:34:38.077414171Z: Step 4/11 : RUN tar xf kernel-dev.tar
[STDOUT  ] 2017-06-07T15:34:38.442628419Z:  ---> Running in cd5ced58849b
[STDOUT  ] 2017-06-07T15:34:46.645251106Z:  ---> aed7ce3b1b29
[STDOUT  ] 2017-06-07T15:34:47.024256236Z: Removing intermediate container cd5ced58849b
[STDOUT  ] 2017-06-07T15:34:47.02442371Z: Step 5/11 : WORKDIR /kmod
[STDOUT  ] 2017-06-07T15:34:47.231456759Z:  ---> e9db0050ea40
[STDOUT  ] 2017-06-07T15:34:47.239548065Z: Removing intermediate container 9b83c157b8c0
[STDOUT  ] 2017-06-07T15:34:47.239750571Z: Step 6/11 : COPY ./src/* ./
[STDOUT  ] 2017-06-07T15:34:47.463972293Z:  ---> 2828aa0d3293
[STDOUT  ] 2017-06-07T15:34:47.471406398Z: Removing intermediate container 0ddf1390a15e
[STDOUT  ] 2017-06-07T15:34:47.471518688Z: Step 7/11 : RUN make all
[STDOUT  ] 2017-06-07T15:34:47.548781766Z:  ---> Running in 8e240f727731
[STDOUT  ] 2017-06-07T15:34:47.717499608Z: make -C /usr/src/linux-headers-4.9.30-linuxkit M=/kmod modules
[STDOUT  ] 2017-06-07T15:34:47.718821804Z: make[1]: Entering directory '/usr/src/linux-headers-4.9.30-linuxkit'
[STDOUT  ] 2017-06-07T15:34:48.815558015Z:   CC [M]  /kmod/hello_world.o
[STDOUT  ] 2017-06-07T15:34:49.093463293Z:   Building modules, stage 2.
[STDOUT  ] 2017-06-07T15:34:49.102587588Z:   MODPOST 1 modules
[STDOUT  ] 2017-06-07T15:34:49.113974426Z:   CC      /kmod/hello_world.mod.o
[STDOUT  ] 2017-06-07T15:34:49.34357897Z:   LD [M]  /kmod/hello_world.ko
[STDOUT  ] 2017-06-07T15:34:49.347039449Z: make[1]: Leaving directory '/usr/src/linux-headers-4.9.30-linuxkit'
[STDOUT  ] 2017-06-07T15:34:49.530736881Z:  ---> 5ffaa10637e9
[STDOUT  ] 2017-06-07T15:34:49.53981861Z: Removing intermediate container 8e240f727731
[STDOUT  ] 2017-06-07T15:34:49.539912719Z: Step 8/11 : FROM alpine:3.5
[STDOUT  ] 2017-06-07T15:34:50.721498028Z: 3.5: Pulling from library/alpine
[STDOUT  ] 2017-06-07T15:34:50.740703858Z: 6f821164d5b7: Already exists
[STDOUT  ] 2017-06-07T15:34:51.246770367Z: Digest: sha256:f02537b30c729bb1ee0c67c8bff3a28972bed0abbee8f5520421994c5247b896
[STDOUT  ] 2017-06-07T15:34:51.254008363Z: Status: Downloaded newer image for alpine:3.5
[STDOUT  ] 2017-06-07T15:34:51.254602238Z:  ---> 75b63e430bd1
[STDOUT  ] 2017-06-07T15:34:51.254714222Z: Step 9/11 : COPY --from=build /kmod/hello_world.ko /
[STDOUT  ] 2017-06-07T15:34:52.53161661Z:  ---> cef7cb8f58c4
[STDOUT  ] 2017-06-07T15:34:52.631311446Z: Removing intermediate container 90e46925413c
[STDOUT  ] 2017-06-07T15:34:52.631325661Z: Step 10/11 : COPY check.sh /check.sh
[STDOUT  ] 2017-06-07T15:34:53.597358333Z:  ---> a8db8016e639
[STDOUT  ] 2017-06-07T15:34:53.603717593Z: Removing intermediate container 347d7a8fbfd1
[STDOUT  ] 2017-06-07T15:34:53.603814789Z: Step 11/11 : ENTRYPOINT /bin/sh /check.sh
[STDOUT  ] 2017-06-07T15:34:53.677448286Z:  ---> Running in fcd6ddc9d54c
[STDOUT  ] 2017-06-07T15:34:53.737845577Z:  ---> d6d921d25dda
[STDOUT  ] 2017-06-07T15:34:53.744513328Z: Removing intermediate container fcd6ddc9d54c
[STDOUT  ] 2017-06-07T15:34:53.744623249Z: Successfully built d6d921d25dda
[STDOUT  ] 2017-06-07T15:34:53.749227113Z: Successfully tagged kmod-test:latest
[STDERR  ] 2017-06-07T15:34:53.76224205Z: + moby build -output kernel+initrd kmod
[STDERR  ] 2017-06-07T15:34:53.771834949Z: Extract kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-06-07T15:34:55.47803845Z: Add init containers:
[STDERR  ] 2017-06-07T15:34:55.478136274Z: Process init image: linuxkit/init:1b8a7e394d2ec2f1fdb4d67645829d1b5bdca037
[STDERR  ] 2017-06-07T15:34:56.702672941Z: Process init image: linuxkit/runc:3a4e6cbf15470f62501b019b55e1caac5ee7689f
[STDERR  ] 2017-06-07T15:34:57.942086863Z: Process init image: linuxkit/containerd:deaf5bf838bf7f131c2287ecff3ed9835b0497e2
[STDERR  ] 2017-06-07T15:34:59.666953912Z: Add onboot containers:
[STDERR  ] 2017-06-07T15:34:59.666996251Z:   Create OCI config for kmod-test
[STDERR  ] 2017-06-07T15:35:00.205431449Z:   Create OCI config for linuxkit/poweroff:7404cf2295df89ccfa2dda41997a28307a90cf28
[STDERR  ] 2017-06-07T15:35:01.415500341Z: Create outputs:
[STDERR  ] 2017-06-07T15:35:07.190565942Z:   kmod-kernel kmod-initrd.img kmod-cmdline
[STDERR  ] 2017-06-07T15:35:07.24489274Z: + grep -q Hello LinuxKit
[STDERR  ] 2017-06-07T15:35:07.245881328Z: + linuxkit run qemu kmod
[STDERR  ] 2017-06-07T15:35:07.266276794Z: Unable to find qemu-system-x86_64 within the $PATH. Using a container
[STDERR  ] 2017-06-07T15:35:24.021997968Z: write /dev/stdout: broken pipe
[STDERR  ] 2017-06-07T15:35:24.024554801Z: time="2017-06-07T15:35:24Z" level=fatal msg="exit status 1" 
[STDERR  ] 2017-06-07T15:35:24.024572382Z: + clean_up
[STDERR  ] 2017-06-07T15:35:24.02457967Z: + docker rmi kmod-test
[STDOUT  ] 2017-06-07T15:35:24.085714749Z: Untagged: kmod-test:latest
[STDOUT  ] 2017-06-07T15:35:24.085767858Z: Deleted: sha256:d6d921d25dda8755696bbd0bb57925948f9777fc2b9d9aa3b4b8d7467dc77cce
[STDOUT  ] 2017-06-07T15:35:24.085775019Z: Deleted: sha256:a8db8016e6396ab2fcc3692f46d188278de7b49d59f71f00fa10324b24d28df6
[STDOUT  ] 2017-06-07T15:35:24.085788451Z: Deleted: sha256:bb269336908f6c5656192758f67829fad0fe137f8ab586c14d0d76a7dfb4f8bf
[STDOUT  ] 2017-06-07T15:35:24.085800833Z: Deleted: sha256:cef7cb8f58c49b1056449153ab4c955e32dfadd0e67b5644b7c6d54dd0ad4880
[STDOUT  ] 2017-06-07T15:35:24.085810824Z: Deleted: sha256:3eb148452a5cb2e35381636c48c2be8e8ce16fdbc2b7b50e97ee16c843d62ed4
[STDERR  ] 2017-06-07T15:35:24.086540058Z: + find . -iname kmod* -not -iname *.yml -exec rm -rf {} ;
[PASS    ] linuxkit.kernel.kmod_4.9.x 62.12s
