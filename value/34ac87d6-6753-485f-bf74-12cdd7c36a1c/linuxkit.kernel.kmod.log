[INFO    ] 2017-05-16T14:56:27.252070281Z: Running Test linuxkit.kernel.kmod in /tmp/build/test/cases/020_kernel/010_kmod
[INFO    ] 2017-05-16T14:56:27.252178196Z: Running command: [/bin/sh -x /tmp/build/test/cases/020_kernel/010_kmod/test.sh]
[STDERR  ] 2017-05-16T14:56:27.273778846Z: + set -e
[STDERR  ] 2017-05-16T14:56:27.273827387Z: + . /tmp/build/test/cases/_lib/lib.sh
[STDERR  ] 2017-05-16T14:56:27.273893184Z: + [ -f src/github.com/linuxkit/rtf/lib/lib.sh ]
[STDERR  ] 2017-05-16T14:56:27.273935131Z: + LINUXKIT_TMPDIR=/tmp/build/test/cases/_tmp
[STDERR  ] 2017-05-16T14:56:27.273971067Z: + [ -f /tmp/build/test/cases/_tmp/env.sh ]
[STDERR  ] 2017-05-16T14:56:27.273992183Z: + . /tmp/build/test/cases/_tmp/env.sh
[STDERR  ] 2017-05-16T14:56:27.274035786Z: + export LINUXKIT_EXAMPLES_DIR=/tmp/build/test/cases/../../examples
[STDERR  ] 2017-05-16T14:56:27.27405957Z: + RT_CANCEL=253
[STDERR  ] 2017-05-16T14:56:27.274078233Z: + IMAGE_NAME=kmod-test
[STDERR  ] 2017-05-16T14:56:27.274120334Z: + trap clean_up EXIT
[STDERR  ] 2017-05-16T14:56:27.274151276Z: + docker pull linuxkit/kernel:4.9.x
[STDOUT  ] 2017-05-16T14:56:28.444791137Z: 4.9.x: Pulling from linuxkit/kernel
[STDOUT  ] 2017-05-16T14:56:28.4448908Z: Digest: sha256:dd706d391fddc3d2efc254a6c03223d6cb82b86a3dc059a9264063be2fd8911f
[STDOUT  ] 2017-05-16T14:56:28.444940283Z: Status: Image is up to date for linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-16T14:56:28.446009824Z: + docker build -t kmod-test .
[STDOUT  ] 2017-05-16T14:56:28.536064129Z: Sending build context to Docker daemon  9.216kB
[STDOUT  ] 2017-05-16T14:56:28.563218553Z: Step 1/11 : FROM linuxkit/kernel:4.9.x AS ksrc
[STDOUT  ] 2017-05-16T14:56:28.563753424Z:  ---> cc9f6cd19506
[STDOUT  ] 2017-05-16T14:56:28.563792009Z: Step 2/11 : FROM linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b AS build
[STDOUT  ] 2017-05-16T14:56:29.668277414Z: 1b396c221af673757703258159ddc8539843b02b: Pulling from linuxkit/kernel-compile
[STDOUT  ] 2017-05-16T14:56:29.668290316Z: 627beaf3eaaf: Already exists
[STDOUT  ] 2017-05-16T14:56:29.674868252Z: 26dc4067def6: Pulling fs layer
[STDOUT  ] 2017-05-16T14:56:35.895664295Z: 26dc4067def6: Verifying Checksum
[STDOUT  ] 2017-05-16T14:56:35.897295428Z: 26dc4067def6: Download complete
[STDOUT  ] 2017-05-16T14:56:42.647429032Z: 26dc4067def6: Pull complete
[STDOUT  ] 2017-05-16T14:56:42.654808528Z: Digest: sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-16T14:56:42.657337624Z: Status: Downloaded newer image for linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-16T14:56:42.65766282Z:  ---> 261c60c4eb02
[STDOUT  ] 2017-05-16T14:56:42.657776161Z: Step 3/11 : COPY --from=ksrc /kernel-dev.tar /
[STDOUT  ] 2017-05-16T14:56:44.715331131Z:  ---> 8ef35cceab0e
[STDOUT  ] 2017-05-16T14:56:44.734844828Z: Removing intermediate container 80a2fb0ee3e4
[STDOUT  ] 2017-05-16T14:56:44.734971657Z: Step 4/11 : RUN tar xf kernel-dev.tar
[STDOUT  ] 2017-05-16T14:56:44.802616222Z:  ---> Running in 68df063cdadf
[STDOUT  ] 2017-05-16T14:56:51.678664956Z:  ---> e4ef30ee7a60
[STDOUT  ] 2017-05-16T14:56:52.076651775Z: Removing intermediate container 68df063cdadf
[STDOUT  ] 2017-05-16T14:56:52.076784364Z: Step 5/11 : WORKDIR /kmod
[STDOUT  ] 2017-05-16T14:56:52.273949373Z:  ---> 86fbca60ab3c
[STDOUT  ] 2017-05-16T14:56:52.281974205Z: Removing intermediate container 4816dc37ec5d
[STDOUT  ] 2017-05-16T14:56:52.282223476Z: Step 6/11 : COPY ./src/* ./
[STDOUT  ] 2017-05-16T14:56:52.498595156Z:  ---> 6f14a2a21dfe
[STDOUT  ] 2017-05-16T14:56:52.505137508Z: Removing intermediate container 2504765246a1
[STDOUT  ] 2017-05-16T14:56:52.505300267Z: Step 7/11 : RUN make all
[STDOUT  ] 2017-05-16T14:56:52.565197525Z:  ---> Running in c7a512da4076
[STDOUT  ] 2017-05-16T14:56:52.745612467Z: make -C /usr/src/linux-headers-4.9.28-linuxkit M=/kmod modules
[STDOUT  ] 2017-05-16T14:56:52.747271135Z: make[1]: Entering directory '/usr/src/linux-headers-4.9.28-linuxkit'
[STDOUT  ] 2017-05-16T14:56:53.857272908Z:   CC [M]  /kmod/hello_world.o
[STDOUT  ] 2017-05-16T14:56:54.085644556Z:   Building modules, stage 2.
[STDOUT  ] 2017-05-16T14:56:54.093653773Z:   MODPOST 1 modules
[STDOUT  ] 2017-05-16T14:56:54.106421595Z:   CC      /kmod/hello_world.mod.o
[STDOUT  ] 2017-05-16T14:56:54.31306673Z:   LD [M]  /kmod/hello_world.ko
[STDOUT  ] 2017-05-16T14:56:54.316072696Z: make[1]: Leaving directory '/usr/src/linux-headers-4.9.28-linuxkit'
[STDOUT  ] 2017-05-16T14:56:54.499828404Z:  ---> a934d288969c
[STDOUT  ] 2017-05-16T14:56:54.509982609Z: Removing intermediate container c7a512da4076
[STDOUT  ] 2017-05-16T14:56:54.510142539Z: Step 8/11 : FROM alpine:3.5
[STDOUT  ] 2017-05-16T14:56:55.712051115Z: 3.5: Pulling from library/alpine
[STDOUT  ] 2017-05-16T14:56:55.728832143Z: cfc728c1c558: Already exists
[STDOUT  ] 2017-05-16T14:56:56.21237414Z: Digest: sha256:c0537ff6a5218ef531ece93d4984efc99bbf3f7497c0a7726c88e2bb7584dc96
[STDOUT  ] 2017-05-16T14:56:56.22021227Z: Status: Downloaded newer image for alpine:3.5
[STDOUT  ] 2017-05-16T14:56:56.221112817Z:  ---> 02674b9cb179
[STDOUT  ] 2017-05-16T14:56:56.221253085Z: Step 9/11 : COPY --from=build /kmod/hello_world.ko /
[STDOUT  ] 2017-05-16T14:56:56.446118012Z:  ---> d9fb0fb7a028
[STDOUT  ] 2017-05-16T14:56:56.453700946Z: Removing intermediate container f617da48186e
[STDOUT  ] 2017-05-16T14:56:56.453855011Z: Step 10/11 : COPY check.sh /check.sh
[STDOUT  ] 2017-05-16T14:56:56.631056988Z:  ---> 25e07a047315
[STDOUT  ] 2017-05-16T14:56:56.639635763Z: Removing intermediate container 3515c4197544
[STDOUT  ] 2017-05-16T14:56:56.639871675Z: Step 11/11 : ENTRYPOINT /bin/sh /check.sh
[STDOUT  ] 2017-05-16T14:56:56.709572111Z:  ---> Running in 95606ba78f38
[STDOUT  ] 2017-05-16T14:56:56.78748868Z:  ---> cfeb4d4db32e
[STDOUT  ] 2017-05-16T14:56:56.795310737Z: Removing intermediate container 95606ba78f38
[STDOUT  ] 2017-05-16T14:56:56.795585722Z: Successfully built cfeb4d4db32e
[STDOUT  ] 2017-05-16T14:56:56.82289975Z: Successfully tagged kmod-test:latest
[STDERR  ] 2017-05-16T14:56:56.835971701Z: + moby build kmod
[STDERR  ] 2017-05-16T14:56:56.846032722Z: Extract kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-16T14:56:57.361503007Z: Add init containers:
[STDERR  ] 2017-05-16T14:56:57.361609977Z: Process init image: linuxkit/init:b3740303f3d1e5689a84c87b7dfb48fd2a40a192
[STDERR  ] 2017-05-16T14:56:57.51413812Z: Process init image: linuxkit/runc:47b1c38d63468c0f3078f8b1b055d07965a1895d
[STDERR  ] 2017-05-16T14:56:57.664478376Z: Process init image: linuxkit/containerd:cf2614f5a96c569a0bd4bd54e054a65ba17d167f
[STDERR  ] 2017-05-16T14:56:58.071010925Z: Add onboot containers:
[STDERR  ] 2017-05-16T14:56:58.071074902Z:   Create OCI config for kmod-test
[STDERR  ] 2017-05-16T14:56:58.291427205Z:   Create OCI config for linuxkit/poweroff:961412b8ef5c5285de0d40ec076701d955eaa084
[STDERR  ] 2017-05-16T14:56:58.437921769Z: Create outputs:
[STDERR  ] 2017-05-16T14:57:03.13810001Z:   kmod-kernel kmod-initrd.img kmod-cmdline
[STDERR  ] 2017-05-16T14:57:03.186482031Z: + grep -q Hello LinuxKit
[STDERR  ] 2017-05-16T14:57:03.187396175Z: + linuxkit run qemu kmod
[STDERR  ] 2017-05-16T14:57:03.193786085Z: Unable to find qemu-system-x86_64 within the $PATH. Using a container
[STDERR  ] 2017-05-16T14:57:18.784349591Z: write /dev/stdout: broken pipe
[STDERR  ] 2017-05-16T14:57:18.786252845Z: time="2017-05-16T14:57:18Z" level=fatal msg="exit status 1" 
[STDERR  ] 2017-05-16T14:57:18.786278869Z: + clean_up
[STDERR  ] 2017-05-16T14:57:18.786286136Z: + docker rmi kmod-test
[STDOUT  ] 2017-05-16T14:57:18.81922686Z: Untagged: kmod-test:latest
[STDOUT  ] 2017-05-16T14:57:18.819239995Z: Deleted: sha256:cfeb4d4db32ef43909c81eaf2b8abf21e27e842c87c0bffbfb3c2fb16aea664a
[STDOUT  ] 2017-05-16T14:57:18.819246492Z: Deleted: sha256:25e07a04731506d9d67e577af0361f7e495037b32eb0b66552676f8f2086d46c
[STDOUT  ] 2017-05-16T14:57:18.81925336Z: Deleted: sha256:5aa7402fd30bab73dacbb86a27c4f57b93da30bd6e456b39012dd0c50a4054d7
[STDOUT  ] 2017-05-16T14:57:18.81925983Z: Deleted: sha256:d9fb0fb7a02852574374b9a748d24cf50cb5d3e70f5ee5466fc8b53b006951f6
[STDOUT  ] 2017-05-16T14:57:18.81927389Z: Deleted: sha256:1ab362a7ebc003995fb667c05a74762aa874fd86f93732ae298d50700a78ff03
[STDERR  ] 2017-05-16T14:57:18.820438888Z: + find . -iname kmod* -not -iname *.yml -exec rm -rf {} ;
[PASS    ] linuxkit.kernel.kmod 51.59s
