[INFO    ] 2017-05-24T15:22:33.576554861Z: Running Test linuxkit.kernel.kmod_4.9.x in /tmp/build/test/cases/020_kernel/010_kmod_4.9.x
[INFO    ] 2017-05-24T15:22:33.576624231Z: Running command: [/bin/sh -x /tmp/build/test/cases/020_kernel/010_kmod_4.9.x/test.sh]
[STDERR  ] 2017-05-24T15:22:33.617574609Z: + set -e
[STDERR  ] 2017-05-24T15:22:33.617610023Z: + . /tmp/build/test/cases/_lib/lib.sh
[STDERR  ] 2017-05-24T15:22:33.617675188Z: + [ -f src/github.com/linuxkit/rtf/lib/lib.sh ]
[STDERR  ] 2017-05-24T15:22:33.617713856Z: + LINUXKIT_TMPDIR=/tmp/build/test/cases/_tmp
[STDERR  ] 2017-05-24T15:22:33.617753368Z: + [ -f /tmp/build/test/cases/_tmp/env.sh ]
[STDERR  ] 2017-05-24T15:22:33.617794136Z: + . /tmp/build/test/cases/_tmp/env.sh
[STDERR  ] 2017-05-24T15:22:33.617831612Z: + export LINUXKIT_EXAMPLES_DIR=/tmp/build/test/cases/../../examples
[STDERR  ] 2017-05-24T15:22:33.61785378Z: + RT_CANCEL=253
[STDERR  ] 2017-05-24T15:22:33.617868074Z: + IMAGE_NAME=kmod-test
[STDERR  ] 2017-05-24T15:22:33.617909297Z: + trap clean_up EXIT
[STDERR  ] 2017-05-24T15:22:33.617934977Z: + docker pull linuxkit/kernel:4.9.x
[STDOUT  ] 2017-05-24T15:22:34.855708302Z: 4.9.x: Pulling from linuxkit/kernel
[STDOUT  ] 2017-05-24T15:22:34.855802061Z: Digest: sha256:41235c0c1093801dea6bf8acfb31091fcddd4848a752a77b89729f1e6320bbc7
[STDOUT  ] 2017-05-24T15:22:34.855848799Z: Status: Image is up to date for linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-24T15:22:34.856565419Z: + docker build -t kmod-test .
[STDOUT  ] 2017-05-24T15:22:34.91558842Z: Sending build context to Docker daemon  9.216kB
[STDOUT  ] 2017-05-24T15:22:34.966866804Z: Step 1/11 : FROM linuxkit/kernel:4.9.x AS ksrc
[STDOUT  ] 2017-05-24T15:22:34.995424865Z:  ---> 3173edc4f8bb
[STDOUT  ] 2017-05-24T15:22:34.995518024Z: Step 2/11 : FROM linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b AS build
[STDOUT  ] 2017-05-24T15:22:36.274608552Z: 1b396c221af673757703258159ddc8539843b02b: Pulling from linuxkit/kernel-compile
[STDOUT  ] 2017-05-24T15:22:36.285154066Z: 627beaf3eaaf: Already exists
[STDOUT  ] 2017-05-24T15:22:36.299108513Z: 26dc4067def6: Pulling fs layer
[STDOUT  ] 2017-05-24T15:22:40.185816995Z: 26dc4067def6: Verifying Checksum
[STDOUT  ] 2017-05-24T15:22:40.187130727Z: 26dc4067def6: Download complete
[STDOUT  ] 2017-05-24T15:22:46.243773871Z: 26dc4067def6: Pull complete
[STDOUT  ] 2017-05-24T15:22:46.257209878Z: Digest: sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-24T15:22:46.262365837Z: Status: Downloaded newer image for linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-24T15:22:46.262710464Z:  ---> 261c60c4eb02
[STDOUT  ] 2017-05-24T15:22:46.262811442Z: Step 3/11 : COPY --from=ksrc /kernel-dev.tar /
[STDOUT  ] 2017-05-24T15:22:48.301881718Z:  ---> d1ac27092174
[STDOUT  ] 2017-05-24T15:22:48.32628109Z: Removing intermediate container a31f90714de2
[STDOUT  ] 2017-05-24T15:22:48.32644404Z: Step 4/11 : RUN tar xf kernel-dev.tar
[STDOUT  ] 2017-05-24T15:22:48.422993985Z:  ---> Running in babcdca850fb
[STDOUT  ] 2017-05-24T15:22:54.276737284Z:  ---> 55bd80e8b4a0
[STDOUT  ] 2017-05-24T15:22:54.619010854Z: Removing intermediate container babcdca850fb
[STDOUT  ] 2017-05-24T15:22:54.619130955Z: Step 5/11 : WORKDIR /kmod
[STDOUT  ] 2017-05-24T15:22:54.788417917Z:  ---> b1e0ee9b6e10
[STDOUT  ] 2017-05-24T15:22:54.794244327Z: Removing intermediate container 96ba7fc76ce6
[STDOUT  ] 2017-05-24T15:22:54.794380757Z: Step 6/11 : COPY ./src/* ./
[STDOUT  ] 2017-05-24T15:22:54.988885347Z:  ---> 0e088dcd8ea8
[STDOUT  ] 2017-05-24T15:22:54.994713169Z: Removing intermediate container 1c79d182d9cb
[STDOUT  ] 2017-05-24T15:22:54.994834637Z: Step 7/11 : RUN make all
[STDOUT  ] 2017-05-24T15:22:55.077460883Z:  ---> Running in 7ff42f007405
[STDOUT  ] 2017-05-24T15:22:55.231717746Z: make -C /usr/src/linux-headers-4.9.29-linuxkit M=/kmod modules
[STDOUT  ] 2017-05-24T15:22:55.232993236Z: make[1]: Entering directory '/usr/src/linux-headers-4.9.29-linuxkit'
[STDOUT  ] 2017-05-24T15:22:56.186454286Z:   CC [M]  /kmod/hello_world.o
[STDOUT  ] 2017-05-24T15:22:56.38188339Z:   Building modules, stage 2.
[STDOUT  ] 2017-05-24T15:22:56.389124126Z:   MODPOST 1 modules
[STDOUT  ] 2017-05-24T15:22:56.399984108Z:   CC      /kmod/hello_world.mod.o
[STDOUT  ] 2017-05-24T15:22:56.577076655Z:   LD [M]  /kmod/hello_world.ko
[STDOUT  ] 2017-05-24T15:22:56.579732106Z: make[1]: Leaving directory '/usr/src/linux-headers-4.9.29-linuxkit'
[STDOUT  ] 2017-05-24T15:22:56.764468513Z:  ---> 0d9449aac9a1
[STDOUT  ] 2017-05-24T15:22:56.775933064Z: Removing intermediate container 7ff42f007405
[STDOUT  ] 2017-05-24T15:22:56.776057996Z: Step 8/11 : FROM alpine:3.5
[STDOUT  ] 2017-05-24T15:22:57.925595141Z: 3.5: Pulling from library/alpine
[STDOUT  ] 2017-05-24T15:22:57.939592514Z: cfc728c1c558: Already exists
[STDOUT  ] 2017-05-24T15:22:58.445117249Z: Digest: sha256:c0537ff6a5218ef531ece93d4984efc99bbf3f7497c0a7726c88e2bb7584dc96
[STDOUT  ] 2017-05-24T15:22:58.456090369Z: Status: Downloaded newer image for alpine:3.5
[STDOUT  ] 2017-05-24T15:22:58.456465161Z:  ---> 02674b9cb179
[STDOUT  ] 2017-05-24T15:22:58.456584114Z: Step 9/11 : COPY --from=build /kmod/hello_world.ko /
[STDOUT  ] 2017-05-24T15:22:58.653262808Z:  ---> 7e263cb2dc96
[STDOUT  ] 2017-05-24T15:22:58.659774664Z: Removing intermediate container db1a4a58b4a2
[STDOUT  ] 2017-05-24T15:22:58.659979798Z: Step 10/11 : COPY check.sh /check.sh
[STDOUT  ] 2017-05-24T15:22:58.840718196Z:  ---> 0ae464697c47
[STDOUT  ] 2017-05-24T15:22:58.853199606Z: Removing intermediate container 835f5fa06040
[STDOUT  ] 2017-05-24T15:22:58.85333836Z: Step 11/11 : ENTRYPOINT /bin/sh /check.sh
[STDOUT  ] 2017-05-24T15:22:58.945625049Z:  ---> Running in 836c15487b1d
[STDOUT  ] 2017-05-24T15:22:59.041391531Z:  ---> 594b204ae55f
[STDOUT  ] 2017-05-24T15:22:59.062181077Z: Removing intermediate container 836c15487b1d
[STDOUT  ] 2017-05-24T15:22:59.062260329Z: Successfully built 594b204ae55f
[STDOUT  ] 2017-05-24T15:22:59.075736839Z: Successfully tagged kmod-test:latest
[STDERR  ] 2017-05-24T15:22:59.091610643Z: + moby build kmod
[STDERR  ] 2017-05-24T15:22:59.100801592Z: Extract kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-24T15:22:59.584502482Z: Add init containers:
[STDERR  ] 2017-05-24T15:22:59.584543989Z: Process init image: linuxkit/init:cbd7ae748f0a082516501a3e914fa0c924ee941e
[STDERR  ] 2017-05-24T15:22:59.697705497Z: Process init image: linuxkit/runc:24dfe632ed3ff53a026ee3fac046fd544434e2d6
[STDERR  ] 2017-05-24T15:22:59.832675719Z: Process init image: linuxkit/containerd:f1130450206d4f64f0ddc13d15bb68435aa1ff61
[STDERR  ] 2017-05-24T15:23:00.303267611Z: Add onboot containers:
[STDERR  ] 2017-05-24T15:23:00.303375539Z:   Create OCI config for kmod-test
[STDERR  ] 2017-05-24T15:23:00.429401623Z:   Create OCI config for linuxkit/poweroff:a8f1e4ad8d459f1fdaad9e4b007512cb3b504ae8
[STDERR  ] 2017-05-24T15:23:00.550737254Z: Create outputs:
[STDERR  ] 2017-05-24T15:23:06.275329724Z:   kmod-kernel kmod-initrd.img kmod-cmdline
[STDERR  ] 2017-05-24T15:23:06.323637569Z: + grep -q Hello LinuxKit
[STDERR  ] 2017-05-24T15:23:06.324567758Z: + linuxkit run qemu kmod
[STDERR  ] 2017-05-24T15:23:06.331192482Z: Unable to find qemu-system-x86_64 within the $PATH. Using a container
[STDERR  ] 2017-05-24T15:23:23.381771859Z: write /dev/stdout: broken pipe
[STDERR  ] 2017-05-24T15:23:23.383730192Z: time="2017-05-24T15:23:23Z" level=fatal msg="exit status 1" 
[STDERR  ] 2017-05-24T15:23:23.383739035Z: + clean_up
[STDERR  ] 2017-05-24T15:23:23.383750534Z: + docker rmi kmod-test
[STDOUT  ] 2017-05-24T15:23:23.508569368Z: Untagged: kmod-test:latest
[STDOUT  ] 2017-05-24T15:23:23.50857788Z: Deleted: sha256:594b204ae55f63f44cf5c75207fe2585ffa044cd306c364dbc9bf10c4ea5644c
[STDOUT  ] 2017-05-24T15:23:23.508585275Z: Deleted: sha256:0ae464697c471a689a86563f0a596f4b0ee09a5db792f5d4dcf62fe424d46e30
[STDOUT  ] 2017-05-24T15:23:23.508595589Z: Deleted: sha256:e025ff5c2141cb5d2272fde85a4f16e72f0526da477318ac42a7e00c6657414e
[STDOUT  ] 2017-05-24T15:23:23.508608633Z: Deleted: sha256:7e263cb2dc965220735f389e49d0bc713c3136ddd3fa25c8b129f775a42ef425
[STDOUT  ] 2017-05-24T15:23:23.508612871Z: Deleted: sha256:e43853395346d1f9f69a4fbdd6ad16d472101d9eb469d1f15893fde891515d6a
[STDERR  ] 2017-05-24T15:23:23.509453929Z: + find . -iname kmod* -not -iname *.yml -exec rm -rf {} ;
[PASS    ] linuxkit.kernel.kmod_4.9.x 49.96s
