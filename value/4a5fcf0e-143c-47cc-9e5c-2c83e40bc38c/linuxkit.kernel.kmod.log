[INFO    ] 2017-05-17T16:35:01.063686835Z: Running Test linuxkit.kernel.kmod in /tmp/build/test/cases/020_kernel/010_kmod
[INFO    ] 2017-05-17T16:35:01.063798039Z: Running command: [/bin/sh -x /tmp/build/test/cases/020_kernel/010_kmod/test.sh]
[STDERR  ] 2017-05-17T16:35:01.075646775Z: + set -e
[STDERR  ] 2017-05-17T16:35:01.075699973Z: + . /tmp/build/test/cases/_lib/lib.sh
[STDERR  ] 2017-05-17T16:35:01.075771923Z: + [ -f src/github.com/linuxkit/rtf/lib/lib.sh ]
[STDERR  ] 2017-05-17T16:35:01.088084264Z: + LINUXKIT_TMPDIR=/tmp/build/test/cases/_tmp
[STDERR  ] 2017-05-17T16:35:01.088138142Z: + [ -f /tmp/build/test/cases/_tmp/env.sh ]
[STDERR  ] 2017-05-17T16:35:01.088183595Z: + . /tmp/build/test/cases/_tmp/env.sh
[STDERR  ] 2017-05-17T16:35:01.088253227Z: + export LINUXKIT_EXAMPLES_DIR=/tmp/build/test/cases/../../examples
[STDERR  ] 2017-05-17T16:35:01.08829199Z: + RT_CANCEL=253
[STDERR  ] 2017-05-17T16:35:01.088330848Z: + IMAGE_NAME=kmod-test
[STDERR  ] 2017-05-17T16:35:01.088379065Z: + trap clean_up EXIT
[STDERR  ] 2017-05-17T16:35:01.088405453Z: + docker pull linuxkit/kernel:4.9.x
[STDOUT  ] 2017-05-17T16:35:02.572765895Z: 4.9.x: Pulling from linuxkit/kernel
[STDOUT  ] 2017-05-17T16:35:02.572886537Z: Digest: sha256:dd706d391fddc3d2efc254a6c03223d6cb82b86a3dc059a9264063be2fd8911f
[STDOUT  ] 2017-05-17T16:35:02.572953361Z: Status: Image is up to date for linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-17T16:35:02.573734953Z: + docker build -t kmod-test .
[STDOUT  ] 2017-05-17T16:35:02.625500244Z: Sending build context to Docker daemon  9.216kB
[STDOUT  ] 2017-05-17T16:35:02.679904236Z: Step 1/11 : FROM linuxkit/kernel:4.9.x AS ksrc
[STDOUT  ] 2017-05-17T16:35:02.757279875Z:  ---> cc9f6cd19506
[STDOUT  ] 2017-05-17T16:35:02.757296676Z: Step 2/11 : FROM linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b AS build
[STDOUT  ] 2017-05-17T16:35:03.859479044Z: 1b396c221af673757703258159ddc8539843b02b: Pulling from linuxkit/kernel-compile
[STDOUT  ] 2017-05-17T16:35:03.859490428Z: 627beaf3eaaf: Already exists
[STDOUT  ] 2017-05-17T16:35:03.867283679Z: 26dc4067def6: Pulling fs layer
[STDOUT  ] 2017-05-17T16:35:07.235332004Z: 26dc4067def6: Verifying Checksum
[STDOUT  ] 2017-05-17T16:35:07.235433128Z: 26dc4067def6: Download complete
[STDOUT  ] 2017-05-17T16:35:14.575395032Z: 26dc4067def6: Pull complete
[STDOUT  ] 2017-05-17T16:35:14.593264837Z: Digest: sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-17T16:35:14.603353023Z: Status: Downloaded newer image for linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-17T16:35:14.603753105Z:  ---> 261c60c4eb02
[STDOUT  ] 2017-05-17T16:35:14.603872105Z: Step 3/11 : COPY --from=ksrc /kernel-dev.tar /
[STDOUT  ] 2017-05-17T16:35:17.896784128Z:  ---> 043b67cea7de
[STDOUT  ] 2017-05-17T16:35:17.914604799Z: Removing intermediate container 3846c9b29e8c
[STDOUT  ] 2017-05-17T16:35:17.914726349Z: Step 4/11 : RUN tar xf kernel-dev.tar
[STDOUT  ] 2017-05-17T16:35:18.007472278Z:  ---> Running in 9f81b7f08fa6
[STDOUT  ] 2017-05-17T16:35:25.815395778Z:  ---> c2b96eca93e8
[STDOUT  ] 2017-05-17T16:35:26.489506035Z: Removing intermediate container 9f81b7f08fa6
[STDOUT  ] 2017-05-17T16:35:26.4896218Z: Step 5/11 : WORKDIR /kmod
[STDOUT  ] 2017-05-17T16:35:27.406290307Z:  ---> 3c2ab619ef96
[STDOUT  ] 2017-05-17T16:35:27.421012998Z: Removing intermediate container e08d3288f503
[STDOUT  ] 2017-05-17T16:35:27.421267526Z: Step 6/11 : COPY ./src/* ./
[STDOUT  ] 2017-05-17T16:35:27.697898057Z:  ---> ac29beab0686
[STDOUT  ] 2017-05-17T16:35:27.71664719Z: Removing intermediate container 4f0067a8cdd4
[STDOUT  ] 2017-05-17T16:35:27.716883359Z: Step 7/11 : RUN make all
[STDOUT  ] 2017-05-17T16:35:27.799054463Z:  ---> Running in 10f04f8f9f0b
[STDOUT  ] 2017-05-17T16:35:27.948607841Z: make -C /usr/src/linux-headers-4.9.28-linuxkit M=/kmod modules
[STDOUT  ] 2017-05-17T16:35:27.949988095Z: make[1]: Entering directory '/usr/src/linux-headers-4.9.28-linuxkit'
[STDOUT  ] 2017-05-17T16:35:28.865784991Z:   CC [M]  /kmod/hello_world.o
[STDOUT  ] 2017-05-17T16:35:29.058682252Z:   Building modules, stage 2.
[STDOUT  ] 2017-05-17T16:35:29.065853964Z:   MODPOST 1 modules
[STDOUT  ] 2017-05-17T16:35:29.076518393Z:   CC      /kmod/hello_world.mod.o
[STDOUT  ] 2017-05-17T16:35:29.251675122Z:   LD [M]  /kmod/hello_world.ko
[STDOUT  ] 2017-05-17T16:35:29.254308329Z: make[1]: Leaving directory '/usr/src/linux-headers-4.9.28-linuxkit'
[STDOUT  ] 2017-05-17T16:35:29.473502391Z:  ---> 0564fbdd4230
[STDOUT  ] 2017-05-17T16:35:29.485216814Z: Removing intermediate container 10f04f8f9f0b
[STDOUT  ] 2017-05-17T16:35:29.485335784Z: Step 8/11 : FROM alpine:3.5
[STDOUT  ] 2017-05-17T16:35:30.651372585Z: 3.5: Pulling from library/alpine
[STDOUT  ] 2017-05-17T16:35:30.662331973Z: cfc728c1c558: Already exists
[STDOUT  ] 2017-05-17T16:35:31.117254917Z: Digest: sha256:c0537ff6a5218ef531ece93d4984efc99bbf3f7497c0a7726c88e2bb7584dc96
[STDOUT  ] 2017-05-17T16:35:31.126349553Z: Status: Downloaded newer image for alpine:3.5
[STDOUT  ] 2017-05-17T16:35:31.126668133Z:  ---> 02674b9cb179
[STDOUT  ] 2017-05-17T16:35:31.126770146Z: Step 9/11 : COPY --from=build /kmod/hello_world.ko /
[STDOUT  ] 2017-05-17T16:35:31.328574074Z:  ---> 1daed4c0376f
[STDOUT  ] 2017-05-17T16:35:31.334537134Z: Removing intermediate container d0efedefb973
[STDOUT  ] 2017-05-17T16:35:31.334670026Z: Step 10/11 : COPY check.sh /check.sh
[STDOUT  ] 2017-05-17T16:35:31.491250825Z:  ---> 8fc7b075fd7d
[STDOUT  ] 2017-05-17T16:35:31.497171328Z: Removing intermediate container 073eed11a59a
[STDOUT  ] 2017-05-17T16:35:31.497343293Z: Step 11/11 : ENTRYPOINT /bin/sh /check.sh
[STDOUT  ] 2017-05-17T16:35:31.570371191Z:  ---> Running in 9546253bed20
[STDOUT  ] 2017-05-17T16:35:31.623192253Z:  ---> cfbc9e3bc904
[STDOUT  ] 2017-05-17T16:35:31.630485704Z: Removing intermediate container 9546253bed20
[STDOUT  ] 2017-05-17T16:35:31.630570859Z: Successfully built cfbc9e3bc904
[STDOUT  ] 2017-05-17T16:35:31.635687816Z: Successfully tagged kmod-test:latest
[STDERR  ] 2017-05-17T16:35:31.647980069Z: + moby build kmod
[STDERR  ] 2017-05-17T16:35:31.65788204Z: Extract kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-17T16:35:32.162741012Z: Add init containers:
[STDERR  ] 2017-05-17T16:35:32.162783841Z: Process init image: linuxkit/init:b3740303f3d1e5689a84c87b7dfb48fd2a40a192
[STDERR  ] 2017-05-17T16:35:32.289998931Z: Process init image: linuxkit/runc:47b1c38d63468c0f3078f8b1b055d07965a1895d
[STDERR  ] 2017-05-17T16:35:32.422062821Z: Process init image: linuxkit/containerd:cf2614f5a96c569a0bd4bd54e054a65ba17d167f
[STDERR  ] 2017-05-17T16:35:32.837302318Z: Add onboot containers:
[STDERR  ] 2017-05-17T16:35:32.837351981Z:   Create OCI config for kmod-test
[STDERR  ] 2017-05-17T16:35:33.011413684Z:   Create OCI config for linuxkit/poweroff:961412b8ef5c5285de0d40ec076701d955eaa084
[STDERR  ] 2017-05-17T16:35:33.164254371Z: Create outputs:
[STDERR  ] 2017-05-17T16:35:37.694536983Z:   kmod-kernel kmod-initrd.img kmod-cmdline
[STDERR  ] 2017-05-17T16:35:37.744073031Z: + grep -q Hello LinuxKit
[STDERR  ] 2017-05-17T16:35:37.744983393Z: + linuxkit run qemu kmod
[STDERR  ] 2017-05-17T16:35:37.751421781Z: Unable to find qemu-system-x86_64 within the $PATH. Using a container
[STDERR  ] 2017-05-17T16:35:56.310546101Z: write /dev/stdout: broken pipe
[STDERR  ] 2017-05-17T16:35:56.312125778Z: time="2017-05-17T16:35:56Z" level=fatal msg="exit status 1" 
[STDERR  ] 2017-05-17T16:35:56.312178207Z: + clean_up
[STDERR  ] 2017-05-17T16:35:56.312181787Z: + docker rmi kmod-test
[STDOUT  ] 2017-05-17T16:35:56.363829906Z: Untagged: kmod-test:latest
[STDOUT  ] 2017-05-17T16:35:56.363883295Z: Deleted: sha256:cfbc9e3bc90488870ee077d7ae1f42b3be4537b839eb873839ca301cdc172a26
[STDOUT  ] 2017-05-17T16:35:56.363898853Z: Deleted: sha256:8fc7b075fd7da2f35df6de087832b6b472de71bcb9f69933d7a1e617dbad282f
[STDOUT  ] 2017-05-17T16:35:56.363902159Z: Deleted: sha256:2d49122f8fe38aaf940b1006595a329978d97a8f6106661a65bbab181d31e85a
[STDOUT  ] 2017-05-17T16:35:56.363908508Z: Deleted: sha256:1daed4c0376fcfdb96e214a7d35dadd56f334836df65dc44a5aceeb7fa6733b3
[STDOUT  ] 2017-05-17T16:35:56.363930346Z: Deleted: sha256:8b7026a150d10c3de892daae4fd734a972f13e38a0ce61dd9c280e856fdf402e
[STDERR  ] 2017-05-17T16:35:56.364534822Z: + find . -iname kmod* -not -iname *.yml -exec rm -rf {} ;
[PASS    ] linuxkit.kernel.kmod 55.32s
