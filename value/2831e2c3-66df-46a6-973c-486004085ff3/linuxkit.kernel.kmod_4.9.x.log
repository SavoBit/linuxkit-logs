[INFO    ] 2017-06-07T14:27:26.528353116Z: Running Test linuxkit.kernel.kmod_4.9.x in /tmp/with_clone3ad521b4/test/cases/020_kernel/010_kmod_4.9.x
[INFO    ] 2017-06-07T14:27:26.528458815Z: Running command: [/bin/sh -x /tmp/with_clone3ad521b4/test/cases/020_kernel/010_kmod_4.9.x/test.sh]
[STDERR  ] 2017-06-07T14:27:26.529603254Z: + set -e
[STDERR  ] 2017-06-07T14:27:26.529677074Z: + . /tmp/with_clone3ad521b4/test/cases/_lib/lib.sh
[STDERR  ] 2017-06-07T14:27:26.529761071Z: + [ -f src/github.com/linuxkit/rtf/lib/lib.sh ]
[STDERR  ] 2017-06-07T14:27:26.52980341Z: + LINUXKIT_TMPDIR=/tmp/with_clone3ad521b4/test/cases/_tmp
[STDERR  ] 2017-06-07T14:27:26.529853607Z: + [ -f /tmp/with_clone3ad521b4/test/cases/_tmp/env.sh ]
[STDERR  ] 2017-06-07T14:27:26.529894452Z: + . /tmp/with_clone3ad521b4/test/cases/_tmp/env.sh
[STDERR  ] 2017-06-07T14:27:26.529949844Z: + export LINUXKIT_EXAMPLES_DIR=/tmp/with_clone3ad521b4/test/cases/../../examples
[STDERR  ] 2017-06-07T14:27:26.529989976Z: + RT_CANCEL=253
[STDERR  ] 2017-06-07T14:27:26.530021936Z: + IMAGE_NAME=kmod-test
[STDERR  ] 2017-06-07T14:27:26.530072337Z: + trap clean_up EXIT
[STDERR  ] 2017-06-07T14:27:26.530116573Z: + docker pull linuxkit/kernel:4.9.x
[STDOUT  ] 2017-06-07T14:27:27.962610784Z: 4.9.x: Pulling from linuxkit/kernel
[STDOUT  ] 2017-06-07T14:27:28.024670554Z: Digest: sha256:196efb2483596900e48cfe45f9fc94f5d8a08419c3581c866a22a090dc3cc53d
[STDOUT  ] 2017-06-07T14:27:28.024678697Z: Status: Image is up to date for linuxkit/kernel:4.9.x
[STDERR  ] 2017-06-07T14:27:28.027902252Z: + docker build -t kmod-test .
[STDOUT  ] 2017-06-07T14:27:28.040657682Z: Sending build context to Docker daemon 9.216 kB
[STDOUT  ] 2017-06-07T14:27:28.201383731Z: Step 1/11 : FROM linuxkit/kernel:4.9.x AS ksrc
[STDOUT  ] 2017-06-07T14:27:28.264473917Z:  ---> 8bb08ba0cf2f
[STDOUT  ] 2017-06-07T14:27:28.264507193Z: Step 2/11 : FROM linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b AS build
[STDOUT  ] 2017-06-07T14:27:28.264526212Z:  ---> 261c60c4eb02
[STDOUT  ] 2017-06-07T14:27:28.264530533Z: Step 3/11 : COPY --from=ksrc /kernel-dev.tar /
[STDOUT  ] 2017-06-07T14:27:29.830438715Z:  ---> 1e22cd24b4da
[STDOUT  ] 2017-06-07T14:27:29.84981612Z: Removing intermediate container 6b756c88c7ac
[STDOUT  ] 2017-06-07T14:27:29.849839158Z: Step 4/11 : RUN tar xf kernel-dev.tar
[STDOUT  ] 2017-06-07T14:27:29.988093509Z:  ---> Running in edda3498bd5d
[STDOUT  ] 2017-06-07T14:27:35.103487085Z:  ---> e061d71363db
[STDOUT  ] 2017-06-07T14:27:35.549535198Z: Removing intermediate container edda3498bd5d
[STDOUT  ] 2017-06-07T14:27:35.549545733Z: Step 5/11 : WORKDIR /kmod
[STDOUT  ] 2017-06-07T14:27:35.959604948Z:  ---> e3095c213f5e
[STDOUT  ] 2017-06-07T14:27:35.976355202Z: Removing intermediate container 647a40834520
[STDOUT  ] 2017-06-07T14:27:35.976399001Z: Step 6/11 : COPY ./src/* ./
[STDOUT  ] 2017-06-07T14:27:36.695329472Z:  ---> f70f1c3008f7
[STDOUT  ] 2017-06-07T14:27:36.712860429Z: Removing intermediate container 818fb92de4c3
[STDOUT  ] 2017-06-07T14:27:36.712868531Z: Step 7/11 : RUN make all
[STDOUT  ] 2017-06-07T14:27:36.837054206Z:  ---> Running in cbe6424104a5
[STDOUT  ] 2017-06-07T14:27:37.318880598Z: make -C /usr/src/linux-headers-4.9.30-linuxkit M=/kmod modules
[STDOUT  ] 2017-06-07T14:27:37.335546099Z: make[1]: Entering directory '/usr/src/linux-headers-4.9.30-linuxkit'
[STDOUT  ] 2017-06-07T14:27:38.044781568Z:   CC [M]  /kmod/hello_world.o
[STDOUT  ] 2017-06-07T14:27:38.230898883Z:   Building modules, stage 2.
[STDOUT  ] 2017-06-07T14:27:38.247579349Z:   MODPOST 1 modules
[STDOUT  ] 2017-06-07T14:27:38.247601315Z:   CC      /kmod/hello_world.mod.o
[STDOUT  ] 2017-06-07T14:27:38.412182557Z:   LD [M]  /kmod/hello_world.ko
[STDOUT  ] 2017-06-07T14:27:38.428976145Z: make[1]: Leaving directory '/usr/src/linux-headers-4.9.30-linuxkit'
[STDOUT  ] 2017-06-07T14:27:39.015390771Z:  ---> 1ace819a710e
[STDOUT  ] 2017-06-07T14:27:39.0321859Z: Removing intermediate container cbe6424104a5
[STDOUT  ] 2017-06-07T14:27:39.032205372Z: Step 8/11 : FROM alpine:3.5
[STDOUT  ] 2017-06-07T14:27:39.032226831Z:  ---> 75b63e430bd1
[STDOUT  ] 2017-06-07T14:27:39.032234431Z: Step 9/11 : COPY --from=build /kmod/hello_world.ko /
[STDOUT  ] 2017-06-07T14:27:39.52684868Z:  ---> 38648796de61
[STDOUT  ] 2017-06-07T14:27:39.543567473Z: Removing intermediate container 2266af30223b
[STDOUT  ] 2017-06-07T14:27:39.543605192Z: Step 10/11 : COPY check.sh /check.sh
[STDOUT  ] 2017-06-07T14:27:40.023542924Z:  ---> 3f85049dbec5
[STDOUT  ] 2017-06-07T14:27:40.040917299Z: Removing intermediate container d527bdf06700
[STDOUT  ] 2017-06-07T14:27:40.040930636Z: Step 11/11 : ENTRYPOINT /bin/sh /check.sh
[STDOUT  ] 2017-06-07T14:27:40.164644612Z:  ---> Running in 91586d75702b
[STDOUT  ] 2017-06-07T14:27:40.368381002Z:  ---> 8e7b780947a1
[STDOUT  ] 2017-06-07T14:27:40.385839613Z: Removing intermediate container 91586d75702b
[STDOUT  ] 2017-06-07T14:27:40.385883824Z: Successfully built 8e7b780947a1
[STDOUT  ] 2017-06-07T14:27:40.385889746Z: Successfully tagged kmod-test:latest
[STDERR  ] 2017-06-07T14:27:40.483648921Z: + moby build -output kernel+initrd kmod
[STDERR  ] 2017-06-07T14:27:40.493491324Z: Extract kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-06-07T14:27:57.923804076Z: Add init containers:
[STDERR  ] 2017-06-07T14:27:57.923825193Z: Process init image: linuxkit/init:1b8a7e394d2ec2f1fdb4d67645829d1b5bdca037
[STDERR  ] 2017-06-07T14:27:59.690128795Z: Process init image: linuxkit/runc:3a4e6cbf15470f62501b019b55e1caac5ee7689f
[STDERR  ] 2017-06-07T14:28:02.573062673Z: Process init image: linuxkit/containerd:5749f2e9e65395cc6635229e8da0e0d484320ddf
[STDERR  ] 2017-06-07T14:28:14.151433699Z: Add onboot containers:
[STDERR  ] 2017-06-07T14:28:14.151507914Z:   Create OCI config for kmod-test
[STDERR  ] 2017-06-07T14:28:15.276724066Z:   Create OCI config for linuxkit/poweroff:7404cf2295df89ccfa2dda41997a28307a90cf28
[STDERR  ] 2017-06-07T14:28:16.996966691Z: Create outputs:
[STDERR  ] 2017-06-07T14:28:23.453469788Z:   kmod-kernel kmod-initrd.img kmod-cmdline
[STDERR  ] 2017-06-07T14:28:23.718632332Z: + grep -q Hello LinuxKit
[STDERR  ] 2017-06-07T14:28:23.719040963Z: + linuxkit run qemu kmod
[STDERR  ] 2017-06-07T14:28:47.846825257Z: + clean_up
[STDERR  ] 2017-06-07T14:28:47.846849488Z: + docker rmi kmod-test
[STDOUT  ] 2017-06-07T14:28:47.924799354Z: Untagged: kmod-test:latest
[STDOUT  ] 2017-06-07T14:28:47.924823067Z: Deleted: sha256:8e7b780947a189b0009d4deccbc49a2903b070cfd234384171c8a4a8e784bf90
[STDOUT  ] 2017-06-07T14:28:47.92483384Z: Deleted: sha256:3f85049dbec5e627becefdce8e6a76ad17b95d2d6c646d4b8b2c7f8646445154
[STDOUT  ] 2017-06-07T14:28:47.92486056Z: Deleted: sha256:68712540329fd3437b76d9205f0c9a5f1621d30d9676f73c0101fb73531c2f97
[STDOUT  ] 2017-06-07T14:28:47.924877789Z: Deleted: sha256:38648796de61e7bded439e61d2bf836bb59820d9dc300731a019babbe5bacb40
[STDOUT  ] 2017-06-07T14:28:47.924892371Z: Deleted: sha256:227177a4135bae4e7abff7088c960be51bfa486988d0de1a66082e595a74b996
[STDERR  ] 2017-06-07T14:28:47.928596872Z: + find . -iname kmod* -not -iname *.yml -exec rm -rf {} ;
[PASS    ] linuxkit.kernel.kmod_4.9.x 81.42s
