[INFO    ] 2017-05-16T14:42:52.920867196Z: Running Test linuxkit.config.kmod in /tmp/build/test/cases/000_config/010_kmod
[INFO    ] 2017-05-16T14:42:52.920931903Z: Running command: [/bin/sh -x /tmp/build/test/cases/000_config/010_kmod/test.sh]
[STDERR  ] 2017-05-16T14:42:52.921655502Z: + set -e
[STDERR  ] 2017-05-16T14:42:52.921716107Z: + . /tmp/build/test/cases/_lib/lib.sh
[STDERR  ] 2017-05-16T14:42:52.921782918Z: + [ -f src/github.com/linuxkit/rtf/lib/lib.sh ]
[STDERR  ] 2017-05-16T14:42:52.921838808Z: + LINUXKIT_TMPDIR=/tmp/build/test/cases/_tmp
[STDERR  ] 2017-05-16T14:42:52.921875544Z: + LINUXKIT_ARTIFACTS_DIR=/tmp/build/test/cases/../../artifacts
[STDERR  ] 2017-05-16T14:42:52.921932208Z: + [ -f /tmp/build/test/cases/_tmp/env.sh ]
[STDERR  ] 2017-05-16T14:42:52.921974812Z: + . /tmp/build/test/cases/_tmp/env.sh
[STDERR  ] 2017-05-16T14:42:52.922024322Z: + export LINUXKIT_EXAMPLES_DIR=/tmp/build/test/cases/../../examples
[STDERR  ] 2017-05-16T14:42:52.922069093Z: + RT_CANCEL=253
[STDERR  ] 2017-05-16T14:42:52.922108772Z: + IMAGE_NAME=kmod-test
[STDERR  ] 2017-05-16T14:42:52.922153802Z: + trap clean_up EXIT
[STDERR  ] 2017-05-16T14:42:52.922192251Z: + docker pull linuxkit/kernel:4.9.x
[STDOUT  ] 2017-05-16T14:42:54.141718077Z: 4.9.x: Pulling from linuxkit/kernel
[STDOUT  ] 2017-05-16T14:42:54.141903346Z: Digest: sha256:dd706d391fddc3d2efc254a6c03223d6cb82b86a3dc059a9264063be2fd8911f
[STDOUT  ] 2017-05-16T14:42:54.142014912Z: Status: Image is up to date for linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-16T14:42:54.142733146Z: + docker build -t kmod-test .
[STDOUT  ] 2017-05-16T14:42:54.154370549Z: Sending build context to Docker daemon  9.216kB
[STDOUT  ] 2017-05-16T14:42:54.175390092Z: Step 1/11 : FROM linuxkit/kernel:4.9.x AS ksrc
[STDOUT  ] 2017-05-16T14:42:54.175515478Z:  ---> cc9f6cd19506
[STDOUT  ] 2017-05-16T14:42:54.175579591Z: Step 2/11 : FROM linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b AS build
[STDOUT  ] 2017-05-16T14:42:55.255892015Z: 1b396c221af673757703258159ddc8539843b02b: Pulling from linuxkit/kernel-compile
[STDOUT  ] 2017-05-16T14:42:55.255913293Z: 627beaf3eaaf: Already exists
[STDOUT  ] 2017-05-16T14:42:55.262382093Z: 26dc4067def6: Pulling fs layer
[STDOUT  ] 2017-05-16T14:42:59.317048787Z: 26dc4067def6: Verifying Checksum
[STDOUT  ] 2017-05-16T14:42:59.317429237Z: 26dc4067def6: Download complete
[STDOUT  ] 2017-05-16T14:43:05.958076133Z: 26dc4067def6: Pull complete
[STDOUT  ] 2017-05-16T14:43:05.966799304Z: Digest: sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-16T14:43:05.970690057Z: Status: Downloaded newer image for linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-16T14:43:05.971116499Z:  ---> 261c60c4eb02
[STDOUT  ] 2017-05-16T14:43:05.97126667Z: Step 3/11 : COPY --from=ksrc /kernel-dev.tar /
[STDOUT  ] 2017-05-16T14:43:08.002372488Z:  ---> 846ac837f5bd
[STDOUT  ] 2017-05-16T14:43:08.018603062Z: Removing intermediate container 5b16e232ea73
[STDOUT  ] 2017-05-16T14:43:08.0188113Z: Step 4/11 : RUN tar xf kernel-dev.tar
[STDOUT  ] 2017-05-16T14:43:08.082362642Z:  ---> Running in 10bf236293a1
[STDOUT  ] 2017-05-16T14:43:14.846267634Z:  ---> ea98d1904b0e
[STDOUT  ] 2017-05-16T14:43:15.409350919Z: Removing intermediate container 10bf236293a1
[STDOUT  ] 2017-05-16T14:43:15.409664925Z: Step 5/11 : WORKDIR /kmod
[STDOUT  ] 2017-05-16T14:43:15.589342764Z:  ---> 5c1a8abc9277
[STDOUT  ] 2017-05-16T14:43:15.596263269Z: Removing intermediate container 1840e424e775
[STDOUT  ] 2017-05-16T14:43:15.596472119Z: Step 6/11 : COPY ./src/* ./
[STDOUT  ] 2017-05-16T14:43:15.793864239Z:  ---> ff6b0d095058
[STDOUT  ] 2017-05-16T14:43:15.800938858Z: Removing intermediate container 1f9e7f315213
[STDOUT  ] 2017-05-16T14:43:15.801157358Z: Step 7/11 : RUN make all
[STDOUT  ] 2017-05-16T14:43:15.868932405Z:  ---> Running in 4143816fad2b
[STDOUT  ] 2017-05-16T14:43:16.029931285Z: make -C /usr/src/linux-headers-4.9.28-linuxkit M=/kmod modules
[STDOUT  ] 2017-05-16T14:43:16.03113399Z: make[1]: Entering directory '/usr/src/linux-headers-4.9.28-linuxkit'
[STDOUT  ] 2017-05-16T14:43:16.832837085Z:   CC [M]  /kmod/hello_world.o
[STDOUT  ] 2017-05-16T14:43:17.0152643Z:   Building modules, stage 2.
[STDOUT  ] 2017-05-16T14:43:17.021174727Z:   MODPOST 1 modules
[STDOUT  ] 2017-05-16T14:43:17.031365Z:   CC      /kmod/hello_world.mod.o
[STDOUT  ] 2017-05-16T14:43:17.20130717Z:   LD [M]  /kmod/hello_world.ko
[STDOUT  ] 2017-05-16T14:43:17.20355128Z: make[1]: Leaving directory '/usr/src/linux-headers-4.9.28-linuxkit'
[STDOUT  ] 2017-05-16T14:43:17.372887625Z:  ---> 2adfa231eda8
[STDOUT  ] 2017-05-16T14:43:17.378789959Z: Removing intermediate container 4143816fad2b
[STDOUT  ] 2017-05-16T14:43:17.378960202Z: Step 8/11 : FROM alpine:3.5
[STDOUT  ] 2017-05-16T14:43:19.844473453Z: 3.5: Pulling from library/alpine
[STDOUT  ] 2017-05-16T14:43:19.845174448Z: cfc728c1c558: Pulling fs layer
[STDOUT  ] 2017-05-16T14:43:20.462176921Z: cfc728c1c558: Verifying Checksum
[STDOUT  ] 2017-05-16T14:43:20.463465262Z: cfc728c1c558: Download complete
[STDOUT  ] 2017-05-16T14:43:20.644733679Z: cfc728c1c558: Pull complete
[STDOUT  ] 2017-05-16T14:43:20.644932654Z: Digest: sha256:c0537ff6a5218ef531ece93d4984efc99bbf3f7497c0a7726c88e2bb7584dc96
[STDOUT  ] 2017-05-16T14:43:20.6450437Z: Status: Downloaded newer image for alpine:3.5
[STDOUT  ] 2017-05-16T14:43:20.645382128Z:  ---> 02674b9cb179
[STDOUT  ] 2017-05-16T14:43:20.645542886Z: Step 9/11 : COPY --from=build /kmod/hello_world.ko /
[STDOUT  ] 2017-05-16T14:43:20.810473912Z:  ---> c79aebf891c0
[STDOUT  ] 2017-05-16T14:43:20.816555553Z: Removing intermediate container 77a59030dcc5
[STDOUT  ] 2017-05-16T14:43:20.816765347Z: Step 10/11 : COPY check.sh /check.sh
[STDOUT  ] 2017-05-16T14:43:20.99678369Z:  ---> 1172b7c6e82f
[STDOUT  ] 2017-05-16T14:43:21.004329854Z: Removing intermediate container ba8dd682625a
[STDOUT  ] 2017-05-16T14:43:21.004601824Z: Step 11/11 : ENTRYPOINT /bin/sh /check.sh
[STDOUT  ] 2017-05-16T14:43:21.073959616Z:  ---> Running in 5a7bce113ac7
[STDOUT  ] 2017-05-16T14:43:21.142047113Z:  ---> 3aea1117454f
[STDOUT  ] 2017-05-16T14:43:21.148979537Z: Removing intermediate container 5a7bce113ac7
[STDOUT  ] 2017-05-16T14:43:21.149166484Z: Successfully built 3aea1117454f
[STDOUT  ] 2017-05-16T14:43:21.156804645Z: Successfully tagged kmod-test:latest
[STDERR  ] 2017-05-16T14:43:21.170145062Z: + moby build kmod
[STDERR  ] 2017-05-16T14:43:21.178456123Z: Extract kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-16T14:43:21.670032431Z: Add init containers:
[STDERR  ] 2017-05-16T14:43:21.670203951Z: Process init image: linuxkit/init:b3740303f3d1e5689a84c87b7dfb48fd2a40a192
[STDERR  ] 2017-05-16T14:43:21.795044766Z: Process init image: linuxkit/runc:47b1c38d63468c0f3078f8b1b055d07965a1895d
[STDERR  ] 2017-05-16T14:43:21.908892578Z: Process init image: linuxkit/containerd:cf2614f5a96c569a0bd4bd54e054a65ba17d167f
[STDERR  ] 2017-05-16T14:43:22.2983652Z: Add onboot containers:
[STDERR  ] 2017-05-16T14:43:22.298520244Z:   Create OCI config for kmod-test
[STDERR  ] 2017-05-16T14:43:22.417384747Z:   Create OCI config for linuxkit/poweroff:961412b8ef5c5285de0d40ec076701d955eaa084
[STDERR  ] 2017-05-16T14:43:22.552507861Z: Create outputs:
[STDERR  ] 2017-05-16T14:43:27.190207819Z:   kmod-kernel kmod-initrd.img kmod-cmdline
[STDERR  ] 2017-05-16T14:43:27.237174523Z: + grep -q Hello LinuxKit
[STDERR  ] 2017-05-16T14:43:27.238052859Z: + linuxkit run qemu kmod
[STDERR  ] 2017-05-16T14:43:27.243692639Z: Unable to find qemu-system-x86_64 within the $PATH. Using a container
[STDERR  ] 2017-05-16T14:43:43.041803432Z: write /dev/stdout: broken pipe
[STDERR  ] 2017-05-16T14:43:43.043121702Z: time="2017-05-16T14:43:43Z" level=fatal msg="exit status 1" 
[STDERR  ] 2017-05-16T14:43:43.043135075Z: + clean_up
[STDERR  ] 2017-05-16T14:43:43.043173798Z: + docker rmi kmod-test
[STDOUT  ] 2017-05-16T14:43:43.072160807Z: Untagged: kmod-test:latest
[STDOUT  ] 2017-05-16T14:43:43.07218201Z: Deleted: sha256:3aea1117454fbab123108f3d9b703c92bbc524ce10291ceb25374bf9622bbaa3
[STDOUT  ] 2017-05-16T14:43:43.072196817Z: Deleted: sha256:1172b7c6e82fcb5c06bcaf560198a49d7b1d1610d39faf2471ffa6e7c3f00bd7
[STDOUT  ] 2017-05-16T14:43:43.072202329Z: Deleted: sha256:dc8465d47ea846789312a59ac8376eb281a0e20c2d4bb884e72ccbc2a2e95061
[STDOUT  ] 2017-05-16T14:43:43.072212575Z: Deleted: sha256:c79aebf891c014b18c9291595f89b6a139aa7c8235b0709eb43f43f5b0c6c8c7
[STDOUT  ] 2017-05-16T14:43:43.072215264Z: Deleted: sha256:69258c9f6fd9b545e98dc2f841ace53d41f4d852d440a9f7151d3a358a85f72a
[STDERR  ] 2017-05-16T14:43:43.072975977Z: + find . -iname kmod* -not -iname *.yml -exec rm -rf {} ;
[PASS    ] linuxkit.config.kmod 50.17s
