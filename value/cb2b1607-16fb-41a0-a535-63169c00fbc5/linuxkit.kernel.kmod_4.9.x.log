[INFO    ] 2017-06-01T15:04:24.278879195Z: Running Test linuxkit.kernel.kmod_4.9.x in /tmp/with_clone2f2aad64/test/cases/020_kernel/010_kmod_4.9.x
[INFO    ] 2017-06-01T15:04:24.278984767Z: Running command: [/bin/sh -x /tmp/with_clone2f2aad64/test/cases/020_kernel/010_kmod_4.9.x/test.sh]
[STDERR  ] 2017-06-01T15:04:24.294471487Z: + set -e
[STDERR  ] 2017-06-01T15:04:24.294478169Z: + . /tmp/with_clone2f2aad64/test/cases/_lib/lib.sh
[STDERR  ] 2017-06-01T15:04:24.294489896Z: + [ -f src/github.com/linuxkit/rtf/lib/lib.sh ]
[STDERR  ] 2017-06-01T15:04:24.294496913Z: + LINUXKIT_TMPDIR=/tmp/with_clone2f2aad64/test/cases/_tmp
[STDERR  ] 2017-06-01T15:04:24.29450987Z: + [ -f /tmp/with_clone2f2aad64/test/cases/_tmp/env.sh ]
[STDERR  ] 2017-06-01T15:04:24.294513965Z: + . /tmp/with_clone2f2aad64/test/cases/_tmp/env.sh
[STDERR  ] 2017-06-01T15:04:24.294527983Z: + export LINUXKIT_EXAMPLES_DIR=/tmp/with_clone2f2aad64/test/cases/../../examples
[STDERR  ] 2017-06-01T15:04:24.294535547Z: + RT_CANCEL=253
[STDERR  ] 2017-06-01T15:04:24.294539167Z: + IMAGE_NAME=kmod-test
[STDERR  ] 2017-06-01T15:04:24.294551148Z: + trap clean_up EXIT
[STDERR  ] 2017-06-01T15:04:24.294558797Z: + docker pull linuxkit/kernel:4.9.x
[STDOUT  ] 2017-06-01T15:04:25.664069449Z: 4.9.x: Pulling from linuxkit/kernel
[STDOUT  ] 2017-06-01T15:04:25.681139082Z: Digest: sha256:a0bc40648edf7e73b9801f2887b0aefab9ec1878dcbe3bcff8ea48ebfffdb4d7
[STDOUT  ] 2017-06-01T15:04:25.681180223Z: Status: Image is up to date for linuxkit/kernel:4.9.x
[STDERR  ] 2017-06-01T15:04:25.684218551Z: + docker build -t kmod-test .
[STDOUT  ] 2017-06-01T15:04:25.696560667Z: Sending build context to Docker daemon 9.216 kB
[STDOUT  ] 2017-06-01T15:04:25.928087536Z: Step 1/11 : FROM linuxkit/kernel:4.9.x AS ksrc
[STDOUT  ] 2017-06-01T15:04:25.928102756Z:  ---> 15f175ba5ede
[STDOUT  ] 2017-06-01T15:04:25.928112333Z: Step 2/11 : FROM linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b AS build
[STDOUT  ] 2017-06-01T15:04:27.086955027Z: 1b396c221af673757703258159ddc8539843b02b: Pulling from linuxkit/kernel-compile
[STDOUT  ] 2017-06-01T15:04:27.086966519Z: 627beaf3eaaf: Already exists
[STDOUT  ] 2017-06-01T15:04:27.121073417Z: 26dc4067def6: Already exists
[STDOUT  ] 2017-06-01T15:04:27.598165353Z: Digest: sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-06-01T15:04:27.615067027Z: Status: Downloaded newer image for linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-06-01T15:04:27.615119176Z:  ---> 261c60c4eb02
[STDOUT  ] 2017-06-01T15:04:27.61513379Z: Step 3/11 : COPY --from=ksrc /kernel-dev.tar /
[STDOUT  ] 2017-06-01T15:04:29.73139751Z:  ---> 60a84ce86bce
[STDOUT  ] 2017-06-01T15:04:29.754536559Z: Removing intermediate container b17f00c05bda
[STDOUT  ] 2017-06-01T15:04:29.754575387Z: Step 4/11 : RUN tar xf kernel-dev.tar
[STDOUT  ] 2017-06-01T15:04:29.903112497Z:  ---> Running in d8a76e63a335
[STDOUT  ] 2017-06-01T15:04:36.205261742Z:  ---> dda20f4b7bd0
[STDOUT  ] 2017-06-01T15:04:36.726218705Z: Removing intermediate container d8a76e63a335
[STDOUT  ] 2017-06-01T15:04:36.726233915Z: Step 5/11 : WORKDIR /kmod
[STDOUT  ] 2017-06-01T15:04:37.309617936Z:  ---> 6554433ac9bc
[STDOUT  ] 2017-06-01T15:04:37.326646387Z: Removing intermediate container 00200493b5df
[STDOUT  ] 2017-06-01T15:04:37.326684218Z: Step 6/11 : COPY ./src/* ./
[STDOUT  ] 2017-06-01T15:04:38.203631938Z:  ---> ec8593efcf4d
[STDOUT  ] 2017-06-01T15:04:38.220654379Z: Removing intermediate container 2f53112dcd71
[STDOUT  ] 2017-06-01T15:04:38.220683758Z: Step 7/11 : RUN make all
[STDOUT  ] 2017-06-01T15:04:38.379410537Z:  ---> Running in 109de7886090
[STDOUT  ] 2017-06-01T15:04:38.980331205Z: make -C /usr/src/linux-headers-4.9.30-linuxkit M=/kmod modules
[STDOUT  ] 2017-06-01T15:04:38.997526704Z: make[1]: Entering directory '/usr/src/linux-headers-4.9.30-linuxkit'
[STDOUT  ] 2017-06-01T15:04:40.054978979Z:   CC [M]  /kmod/hello_world.o
[STDOUT  ] 2017-06-01T15:04:40.312639687Z:   Building modules, stage 2.
[STDOUT  ] 2017-06-01T15:04:40.329652574Z:   MODPOST 1 modules
[STDOUT  ] 2017-06-01T15:04:40.346753149Z:   CC      /kmod/hello_world.mod.o
[STDOUT  ] 2017-06-01T15:04:40.549393174Z:   LD [M]  /kmod/hello_world.ko
[STDOUT  ] 2017-06-01T15:04:40.566497592Z: make[1]: Leaving directory '/usr/src/linux-headers-4.9.30-linuxkit'
[STDOUT  ] 2017-06-01T15:04:41.587856249Z:  ---> 7a8a9087ffbb
[STDOUT  ] 2017-06-01T15:04:41.60481689Z: Removing intermediate container 109de7886090
[STDOUT  ] 2017-06-01T15:04:41.604856209Z: Step 8/11 : FROM alpine:3.5
[STDOUT  ] 2017-06-01T15:04:42.746032983Z: 3.5: Pulling from library/alpine
[STDOUT  ] 2017-06-01T15:04:42.746043742Z: 6f821164d5b7: Already exists
[STDOUT  ] 2017-06-01T15:04:43.242692555Z: Digest: sha256:f02537b30c729bb1ee0c67c8bff3a28972bed0abbee8f5520421994c5247b896
[STDOUT  ] 2017-06-01T15:04:43.25974829Z: Status: Downloaded newer image for alpine:3.5
[STDOUT  ] 2017-06-01T15:04:43.259755699Z:  ---> 75b63e430bd1
[STDOUT  ] 2017-06-01T15:04:43.259763624Z: Step 9/11 : COPY --from=build /kmod/hello_world.ko /
[STDOUT  ] 2017-06-01T15:04:43.916475284Z:  ---> 883b43b96964
[STDOUT  ] 2017-06-01T15:04:43.933521388Z: Removing intermediate container 4441c446d958
[STDOUT  ] 2017-06-01T15:04:43.93354626Z: Step 10/11 : COPY check.sh /check.sh
[STDOUT  ] 2017-06-01T15:04:44.651172512Z:  ---> 2689e1d77ab7
[STDOUT  ] 2017-06-01T15:04:44.672246105Z: Removing intermediate container ba5eaf2278a7
[STDOUT  ] 2017-06-01T15:04:44.672257436Z: Step 11/11 : ENTRYPOINT /bin/sh /check.sh
[STDOUT  ] 2017-06-01T15:04:44.842485901Z:  ---> Running in 31d75d6ee5c2
[STDOUT  ] 2017-06-01T15:04:45.127247686Z:  ---> 402e1925b77c
[STDOUT  ] 2017-06-01T15:04:45.14426111Z: Removing intermediate container 31d75d6ee5c2
[STDOUT  ] 2017-06-01T15:04:45.144273397Z: Successfully built 402e1925b77c
[STDOUT  ] 2017-06-01T15:04:45.144281821Z: Successfully tagged kmod-test:latest
[STDERR  ] 2017-06-01T15:04:45.257116839Z: + moby build -output kernel+initrd kmod
[STDERR  ] 2017-06-01T15:04:45.265992219Z: Pull kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-06-01T15:04:48.154076276Z: Extract kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-06-01T15:04:48.154092098Z: Pull image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-06-01T15:04:58.616240113Z: Add init containers:
[STDERR  ] 2017-06-01T15:04:58.616273856Z: Process init image: linuxkit/init:1b8a7e394d2ec2f1fdb4d67645829d1b5bdca037
[STDERR  ] 2017-06-01T15:04:58.616319486Z: Pull image: linuxkit/init:1b8a7e394d2ec2f1fdb4d67645829d1b5bdca037
[STDERR  ] 2017-06-01T15:05:02.156371188Z: Process init image: linuxkit/runc:3a4e6cbf15470f62501b019b55e1caac5ee7689f
[STDERR  ] 2017-06-01T15:05:02.156462013Z: Pull image: linuxkit/runc:3a4e6cbf15470f62501b019b55e1caac5ee7689f
[STDERR  ] 2017-06-01T15:05:05.869333661Z: Process init image: linuxkit/containerd:deaf5bf838bf7f131c2287ecff3ed9835b0497e2
[STDERR  ] 2017-06-01T15:05:05.869425496Z: Pull image: linuxkit/containerd:deaf5bf838bf7f131c2287ecff3ed9835b0497e2
[STDERR  ] 2017-06-01T15:05:13.330016889Z: Add onboot containers:
[STDERR  ] 2017-06-01T15:05:13.330064158Z:   Create OCI config for kmod-test
[STDERR  ] 2017-06-01T15:05:13.832964061Z:   Create OCI config for linuxkit/poweroff:7404cf2295df89ccfa2dda41997a28307a90cf28
[STDERR  ] 2017-06-01T15:05:13.877428799Z: Pull image: linuxkit/poweroff:7404cf2295df89ccfa2dda41997a28307a90cf28
[STDERR  ] 2017-06-01T15:05:17.12539649Z: Create outputs:
[STDERR  ] 2017-06-01T15:05:23.129498672Z:   kmod-kernel kmod-initrd.img kmod-cmdline
[STDERR  ] 2017-06-01T15:05:23.391084279Z: + linuxkit run qemu kmod
[STDERR  ] 2017-06-01T15:05:23.391106062Z: + grep -q Hello LinuxKit
[STDERR  ] 2017-06-01T15:05:47.46837975Z: + clean_up
[STDERR  ] 2017-06-01T15:05:47.468406221Z: + docker rmi kmod-test
[STDOUT  ] 2017-06-01T15:05:47.524411256Z: Untagged: kmod-test:latest
[STDOUT  ] 2017-06-01T15:05:47.524433815Z: Deleted: sha256:402e1925b77c9aa5f5f310709667f36f3390e5e5bdb91c51511e0622a11767b1
[STDOUT  ] 2017-06-01T15:05:47.524447257Z: Deleted: sha256:2689e1d77ab71e7c776ebc4f6fc6b3286c4991673e497a87acfda7d216a7cc2a
[STDOUT  ] 2017-06-01T15:05:47.524476326Z: Deleted: sha256:93ff52f65524001d0e35feda7e4c96ec0dbd5a50234964220afb4200a3fcff44
[STDOUT  ] 2017-06-01T15:05:47.52450669Z: Deleted: sha256:883b43b96964f7cf5c10ecc8a1d85e811b993c79ae6bd1cc176b45dcb2eda9f0
[STDOUT  ] 2017-06-01T15:05:47.524515085Z: Deleted: sha256:4f1c836a6d9a56a2bdb77fb8532b9fd941257636fce2c58cc9d4f3b7f6fdb2cf
[STDERR  ] 2017-06-01T15:05:47.527019012Z: + find . -iname kmod* -not -iname *.yml -exec rm -rf {} ;
[PASS    ] linuxkit.kernel.kmod_4.9.x 83.27s
