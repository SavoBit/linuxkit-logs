[INFO    ] 2017-06-01T16:50:44.674862162Z: Running Test linuxkit.kernel.kmod_4.9.x in /tmp/build/test/cases/020_kernel/010_kmod_4.9.x
[INFO    ] 2017-06-01T16:50:44.674940738Z: Running command: [/bin/sh -x /tmp/build/test/cases/020_kernel/010_kmod_4.9.x/test.sh]
[STDERR  ] 2017-06-01T16:50:44.749535053Z: + set -e
[STDERR  ] 2017-06-01T16:50:44.749686314Z: + . /tmp/build/test/cases/_lib/lib.sh
[STDERR  ] 2017-06-01T16:50:44.749759723Z: + [ -f src/github.com/linuxkit/rtf/lib/lib.sh ]
[STDERR  ] 2017-06-01T16:50:44.749812024Z: + LINUXKIT_TMPDIR=/tmp/build/test/cases/_tmp
[STDERR  ] 2017-06-01T16:50:44.749840313Z: + [ -f /tmp/build/test/cases/_tmp/env.sh ]
[STDERR  ] 2017-06-01T16:50:44.749870807Z: + . /tmp/build/test/cases/_tmp/env.sh
[STDERR  ] 2017-06-01T16:50:44.749906833Z: + export LINUXKIT_EXAMPLES_DIR=/tmp/build/test/cases/../../examples
[STDERR  ] 2017-06-01T16:50:44.749931241Z: + RT_CANCEL=253
[STDERR  ] 2017-06-01T16:50:44.74995992Z: + IMAGE_NAME=kmod-test
[STDERR  ] 2017-06-01T16:50:44.749989734Z: + trap clean_up EXIT
[STDERR  ] 2017-06-01T16:50:44.750020606Z: + docker pull linuxkit/kernel:4.9.x
[STDOUT  ] 2017-06-01T16:50:45.923223755Z: 4.9.x: Pulling from linuxkit/kernel
[STDOUT  ] 2017-06-01T16:50:45.923420206Z: Digest: sha256:a0bc40648edf7e73b9801f2887b0aefab9ec1878dcbe3bcff8ea48ebfffdb4d7
[STDOUT  ] 2017-06-01T16:50:45.923479177Z: Status: Image is up to date for linuxkit/kernel:4.9.x
[STDERR  ] 2017-06-01T16:50:45.924972603Z: + docker build -t kmod-test .
[STDOUT  ] 2017-06-01T16:50:46.089173796Z: Sending build context to Docker daemon  9.216kB
[STDOUT  ] 2017-06-01T16:50:46.15660379Z: Step 1/11 : FROM linuxkit/kernel:4.9.x AS ksrc
[STDOUT  ] 2017-06-01T16:50:46.15676349Z:  ---> 15f175ba5ede
[STDOUT  ] 2017-06-01T16:50:46.156812408Z: Step 2/11 : FROM linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b AS build
[STDOUT  ] 2017-06-01T16:50:47.360885388Z: 1b396c221af673757703258159ddc8539843b02b: Pulling from linuxkit/kernel-compile
[STDOUT  ] 2017-06-01T16:50:47.431352695Z: 627beaf3eaaf: Already exists
[STDOUT  ] 2017-06-01T16:50:47.473035385Z: 26dc4067def6: Pulling fs layer
[STDOUT  ] 2017-06-01T16:50:53.175566135Z: 26dc4067def6: Verifying Checksum
[STDOUT  ] 2017-06-01T16:50:53.178050821Z: 26dc4067def6: Download complete
[STDOUT  ] 2017-06-01T16:51:00.023887887Z: 26dc4067def6: Pull complete
[STDOUT  ] 2017-06-01T16:51:00.033572314Z: Digest: sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-06-01T16:51:00.036404118Z: Status: Downloaded newer image for linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-06-01T16:51:00.036748667Z:  ---> 261c60c4eb02
[STDOUT  ] 2017-06-01T16:51:00.036852659Z: Step 3/11 : COPY --from=ksrc /kernel-dev.tar /
[STDOUT  ] 2017-06-01T16:51:02.661304013Z:  ---> b36f8534ceb4
[STDOUT  ] 2017-06-01T16:51:02.725611557Z: Removing intermediate container d87f6d022a1a
[STDOUT  ] 2017-06-01T16:51:02.725735134Z: Step 4/11 : RUN tar xf kernel-dev.tar
[STDOUT  ] 2017-06-01T16:51:02.91395647Z:  ---> Running in 8a553d085e2b
[STDOUT  ] 2017-06-01T16:51:09.724930108Z:  ---> 5ed47ace6140
[STDOUT  ] 2017-06-01T16:51:10.186073191Z: Removing intermediate container 8a553d085e2b
[STDOUT  ] 2017-06-01T16:51:10.186220951Z: Step 5/11 : WORKDIR /kmod
[STDOUT  ] 2017-06-01T16:51:10.576093331Z:  ---> 282c19b62859
[STDOUT  ] 2017-06-01T16:51:10.591723631Z: Removing intermediate container 903681d8b48e
[STDOUT  ] 2017-06-01T16:51:10.591937124Z: Step 6/11 : COPY ./src/* ./
[STDOUT  ] 2017-06-01T16:51:11.042468425Z:  ---> e78f22351f78
[STDOUT  ] 2017-06-01T16:51:11.081859639Z: Removing intermediate container 2b826d7023b1
[STDOUT  ] 2017-06-01T16:51:11.081988178Z: Step 7/11 : RUN make all
[STDOUT  ] 2017-06-01T16:51:11.280230598Z:  ---> Running in 5c765e429aea
[STDOUT  ] 2017-06-01T16:51:11.591045468Z: make -C /usr/src/linux-headers-4.9.30-linuxkit M=/kmod modules
[STDOUT  ] 2017-06-01T16:51:11.592666028Z: make[1]: Entering directory '/usr/src/linux-headers-4.9.30-linuxkit'
[STDOUT  ] 2017-06-01T16:51:12.90286195Z:   CC [M]  /kmod/hello_world.o
[STDOUT  ] 2017-06-01T16:51:13.120233962Z:   Building modules, stage 2.
[STDOUT  ] 2017-06-01T16:51:13.127975362Z:   MODPOST 1 modules
[STDOUT  ] 2017-06-01T16:51:13.139669366Z:   CC      /kmod/hello_world.mod.o
[STDOUT  ] 2017-06-01T16:51:13.337602164Z:   LD [M]  /kmod/hello_world.ko
[STDOUT  ] 2017-06-01T16:51:13.340627934Z: make[1]: Leaving directory '/usr/src/linux-headers-4.9.30-linuxkit'
[STDOUT  ] 2017-06-01T16:51:13.618001775Z:  ---> eba1bd40665e
[STDOUT  ] 2017-06-01T16:51:13.629502972Z: Removing intermediate container 5c765e429aea
[STDOUT  ] 2017-06-01T16:51:13.629593669Z: Step 8/11 : FROM alpine:3.5
[STDOUT  ] 2017-06-01T16:51:14.695436919Z: 3.5: Pulling from library/alpine
[STDOUT  ] 2017-06-01T16:51:14.696433838Z: 6f821164d5b7: Pulling fs layer
[STDOUT  ] 2017-06-01T16:51:15.368362538Z: 6f821164d5b7: Verifying Checksum
[STDOUT  ] 2017-06-01T16:51:15.370585903Z: 6f821164d5b7: Download complete
[STDOUT  ] 2017-06-01T16:51:15.657779006Z: 6f821164d5b7: Pull complete
[STDOUT  ] 2017-06-01T16:51:15.720706539Z: Digest: sha256:f02537b30c729bb1ee0c67c8bff3a28972bed0abbee8f5520421994c5247b896
[STDOUT  ] 2017-06-01T16:51:15.765413833Z: Status: Downloaded newer image for alpine:3.5
[STDOUT  ] 2017-06-01T16:51:15.765964486Z:  ---> 75b63e430bd1
[STDOUT  ] 2017-06-01T16:51:15.766135205Z: Step 9/11 : COPY --from=build /kmod/hello_world.ko /
[STDOUT  ] 2017-06-01T16:51:16.109994739Z:  ---> 0c73caa5d312
[STDOUT  ] 2017-06-01T16:51:16.140323728Z: Removing intermediate container 1b6df2278384
[STDOUT  ] 2017-06-01T16:51:16.140525861Z: Step 10/11 : COPY check.sh /check.sh
[STDOUT  ] 2017-06-01T16:51:16.418038042Z:  ---> 8be7bdbf23f9
[STDOUT  ] 2017-06-01T16:51:16.439199607Z: Removing intermediate container d4180ff242e6
[STDOUT  ] 2017-06-01T16:51:16.439380624Z: Step 11/11 : ENTRYPOINT /bin/sh /check.sh
[STDOUT  ] 2017-06-01T16:51:16.562325697Z:  ---> Running in 7d7ee0901b6d
[STDOUT  ] 2017-06-01T16:51:16.794523794Z:  ---> f0ded92af663
[STDOUT  ] 2017-06-01T16:51:16.811078589Z: Removing intermediate container 7d7ee0901b6d
[STDOUT  ] 2017-06-01T16:51:16.811268822Z: Successfully built f0ded92af663
[STDOUT  ] 2017-06-01T16:51:16.843628638Z: Successfully tagged kmod-test:latest
[STDERR  ] 2017-06-01T16:51:16.890919204Z: + moby build -output kernel+initrd kmod
[STDERR  ] 2017-06-01T16:51:16.902025537Z: Pull kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-06-01T16:51:19.935688452Z: Extract kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-06-01T16:51:19.935768451Z: Pull image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-06-01T16:51:23.743778976Z: Add init containers:
[STDERR  ] 2017-06-01T16:51:23.743813008Z: Process init image: linuxkit/init:1b8a7e394d2ec2f1fdb4d67645829d1b5bdca037
[STDERR  ] 2017-06-01T16:51:23.743843246Z: Pull image: linuxkit/init:1b8a7e394d2ec2f1fdb4d67645829d1b5bdca037
[STDERR  ] 2017-06-01T16:51:26.893490766Z: Process init image: linuxkit/runc:3a4e6cbf15470f62501b019b55e1caac5ee7689f
[STDERR  ] 2017-06-01T16:51:26.893537471Z: Pull image: linuxkit/runc:3a4e6cbf15470f62501b019b55e1caac5ee7689f
[STDERR  ] 2017-06-01T16:51:29.92784549Z: Process init image: linuxkit/containerd:deaf5bf838bf7f131c2287ecff3ed9835b0497e2
[STDERR  ] 2017-06-01T16:51:29.92790122Z: Pull image: linuxkit/containerd:deaf5bf838bf7f131c2287ecff3ed9835b0497e2
[STDERR  ] 2017-06-01T16:51:33.51131865Z: Add onboot containers:
[STDERR  ] 2017-06-01T16:51:33.511355023Z:   Create OCI config for kmod-test
[STDERR  ] 2017-06-01T16:51:33.864194002Z:   Create OCI config for linuxkit/poweroff:7404cf2295df89ccfa2dda41997a28307a90cf28
[STDERR  ] 2017-06-01T16:51:33.867714123Z: Pull image: linuxkit/poweroff:7404cf2295df89ccfa2dda41997a28307a90cf28
[STDERR  ] 2017-06-01T16:51:37.039934788Z: Create outputs:
[STDERR  ] 2017-06-01T16:51:43.579412695Z:   kmod-kernel kmod-initrd.img kmod-cmdline
[STDERR  ] 2017-06-01T16:51:43.633895681Z: + grep -q Hello LinuxKit
[STDERR  ] 2017-06-01T16:51:43.634982979Z: + linuxkit run qemu kmod
[STDERR  ] 2017-06-01T16:51:43.65180894Z: Unable to find qemu-system-x86_64 within the $PATH. Using a container
[STDERR  ] 2017-06-01T16:52:00.156166954Z: write /dev/stdout: broken pipe
[STDERR  ] 2017-06-01T16:52:00.15912448Z: time="2017-06-01T16:52:00Z" level=fatal msg="exit status 1" 
[STDERR  ] 2017-06-01T16:52:00.159141149Z: + clean_up
[STDERR  ] 2017-06-01T16:52:00.159148422Z: + docker rmi kmod-test
[STDOUT  ] 2017-06-01T16:52:00.223065843Z: Untagged: kmod-test:latest
[STDOUT  ] 2017-06-01T16:52:00.223081628Z: Deleted: sha256:f0ded92af66301946a4e14c8f030ed1dec35739afc2b32472ccc6d2588147ac3
[STDOUT  ] 2017-06-01T16:52:00.223094788Z: Deleted: sha256:8be7bdbf23f99a1d783632be8bcaf389d7afc2c5fb06bbbfbd7a0558e119a858
[STDOUT  ] 2017-06-01T16:52:00.223098169Z: Deleted: sha256:20587243f6a0686bc3b905b42e616e758824874144a218032f8108af49a9a9b4
[STDOUT  ] 2017-06-01T16:52:00.223119718Z: Deleted: sha256:0c73caa5d312110e89a43e2c352426dfee51cb4666f2f24ce37209e27d4fe995
[STDOUT  ] 2017-06-01T16:52:00.223129316Z: Deleted: sha256:0ccba25ee09fdc8200a871107027f5feed116d15aaa984140403cfb07153f4d0
[STDERR  ] 2017-06-01T16:52:00.224025897Z: + find . -iname kmod* -not -iname *.yml -exec rm -rf {} ;
[PASS    ] linuxkit.kernel.kmod_4.9.x 75.57s
