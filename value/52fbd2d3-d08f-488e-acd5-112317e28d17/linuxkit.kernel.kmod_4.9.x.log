[INFO    ] 2017-05-26T21:59:12.180773999Z: Running Test linuxkit.kernel.kmod_4.9.x in /tmp/build/test/cases/020_kernel/010_kmod_4.9.x
[INFO    ] 2017-05-26T21:59:12.180850696Z: Running command: [/bin/sh -x /tmp/build/test/cases/020_kernel/010_kmod_4.9.x/test.sh]
[STDERR  ] 2017-05-26T21:59:12.206862967Z: + set -e
[STDERR  ] 2017-05-26T21:59:12.206908244Z: + . /tmp/build/test/cases/_lib/lib.sh
[STDERR  ] 2017-05-26T21:59:12.206980826Z: + [ -f src/github.com/linuxkit/rtf/lib/lib.sh ]
[STDERR  ] 2017-05-26T21:59:12.207021836Z: + LINUXKIT_TMPDIR=/tmp/build/test/cases/_tmp
[STDERR  ] 2017-05-26T21:59:12.207063242Z: + [ -f /tmp/build/test/cases/_tmp/env.sh ]
[STDERR  ] 2017-05-26T21:59:12.207083699Z: + . /tmp/build/test/cases/_tmp/env.sh
[STDERR  ] 2017-05-26T21:59:12.207122666Z: + export LINUXKIT_EXAMPLES_DIR=/tmp/build/test/cases/../../examples
[STDERR  ] 2017-05-26T21:59:12.207155731Z: + RT_CANCEL=253
[STDERR  ] 2017-05-26T21:59:12.20717093Z: + IMAGE_NAME=kmod-test
[STDERR  ] 2017-05-26T21:59:12.207228614Z: + trap clean_up EXIT
[STDERR  ] 2017-05-26T21:59:12.207253331Z: + docker pull linuxkit/kernel:4.9.x
[STDOUT  ] 2017-05-26T21:59:13.294029549Z: 4.9.x: Pulling from linuxkit/kernel
[STDOUT  ] 2017-05-26T21:59:13.294112933Z: Digest: sha256:41235c0c1093801dea6bf8acfb31091fcddd4848a752a77b89729f1e6320bbc7
[STDOUT  ] 2017-05-26T21:59:13.294200572Z: Status: Image is up to date for linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-26T21:59:13.294988513Z: + docker build -t kmod-test .
[STDOUT  ] 2017-05-26T21:59:13.326169507Z: Sending build context to Docker daemon  9.216kB
[STDOUT  ] 2017-05-26T21:59:13.372383722Z: Step 1/11 : FROM linuxkit/kernel:4.9.x AS ksrc
[STDOUT  ] 2017-05-26T21:59:13.386514999Z:  ---> 3173edc4f8bb
[STDOUT  ] 2017-05-26T21:59:13.38669772Z: Step 2/11 : FROM linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b AS build
[STDOUT  ] 2017-05-26T21:59:14.527584306Z: 1b396c221af673757703258159ddc8539843b02b: Pulling from linuxkit/kernel-compile
[STDOUT  ] 2017-05-26T21:59:14.571486178Z: 627beaf3eaaf: Already exists
[STDOUT  ] 2017-05-26T21:59:14.593609184Z: 26dc4067def6: Pulling fs layer
[STDOUT  ] 2017-05-26T21:59:16.243907889Z: 26dc4067def6: Verifying Checksum
[STDOUT  ] 2017-05-26T21:59:16.244006994Z: 26dc4067def6: Download complete
[STDOUT  ] 2017-05-26T21:59:22.815487566Z: 26dc4067def6: Pull complete
[STDOUT  ] 2017-05-26T21:59:22.85727691Z: Digest: sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-26T21:59:22.879932277Z: Status: Downloaded newer image for linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-26T21:59:22.880255855Z:  ---> 261c60c4eb02
[STDOUT  ] 2017-05-26T21:59:22.880391672Z: Step 3/11 : COPY --from=ksrc /kernel-dev.tar /
[STDOUT  ] 2017-05-26T21:59:24.823217031Z:  ---> 32cdd7b2ff72
[STDOUT  ] 2017-05-26T21:59:24.842190108Z: Removing intermediate container 4786a5c7b586
[STDOUT  ] 2017-05-26T21:59:24.842328891Z: Step 4/11 : RUN tar xf kernel-dev.tar
[STDOUT  ] 2017-05-26T21:59:24.920780967Z:  ---> Running in af544bf3496f
[STDOUT  ] 2017-05-26T21:59:31.934290613Z:  ---> c738db287f41
[STDOUT  ] 2017-05-26T21:59:32.299710224Z: Removing intermediate container af544bf3496f
[STDOUT  ] 2017-05-26T21:59:32.299846557Z: Step 5/11 : WORKDIR /kmod
[STDOUT  ] 2017-05-26T21:59:32.489304844Z:  ---> fd951e03b46a
[STDOUT  ] 2017-05-26T21:59:32.495822611Z: Removing intermediate container 22376ff90d6b
[STDOUT  ] 2017-05-26T21:59:32.495958892Z: Step 6/11 : COPY ./src/* ./
[STDOUT  ] 2017-05-26T21:59:32.685820614Z:  ---> f98c9b2ce1ad
[STDOUT  ] 2017-05-26T21:59:32.691895995Z: Removing intermediate container 21b39bb6e257
[STDOUT  ] 2017-05-26T21:59:32.692015886Z: Step 7/11 : RUN make all
[STDOUT  ] 2017-05-26T21:59:32.764198645Z:  ---> Running in 3015dd007ef9
[STDOUT  ] 2017-05-26T21:59:32.900363902Z: make -C /usr/src/linux-headers-4.9.29-linuxkit M=/kmod modules
[STDOUT  ] 2017-05-26T21:59:32.901363948Z: make[1]: Entering directory '/usr/src/linux-headers-4.9.29-linuxkit'
[STDOUT  ] 2017-05-26T21:59:33.725223904Z:   CC [M]  /kmod/hello_world.o
[STDOUT  ] 2017-05-26T21:59:33.91336638Z:   Building modules, stage 2.
[STDOUT  ] 2017-05-26T21:59:33.919570571Z:   MODPOST 1 modules
[STDOUT  ] 2017-05-26T21:59:33.929705481Z:   CC      /kmod/hello_world.mod.o
[STDOUT  ] 2017-05-26T21:59:34.099404679Z:   LD [M]  /kmod/hello_world.ko
[STDOUT  ] 2017-05-26T21:59:34.101724045Z: make[1]: Leaving directory '/usr/src/linux-headers-4.9.29-linuxkit'
[STDOUT  ] 2017-05-26T21:59:34.288221914Z:  ---> 6d5b74f7e9c7
[STDOUT  ] 2017-05-26T21:59:34.298952719Z: Removing intermediate container 3015dd007ef9
[STDOUT  ] 2017-05-26T21:59:34.299053894Z: Step 8/11 : FROM alpine:3.5
[STDOUT  ] 2017-05-26T21:59:35.4284528Z: 3.5: Pulling from library/alpine
[STDOUT  ] 2017-05-26T21:59:35.429162666Z: 6f821164d5b7: Pulling fs layer
[STDOUT  ] 2017-05-26T21:59:36.014217832Z: 6f821164d5b7: Verifying Checksum
[STDOUT  ] 2017-05-26T21:59:36.015586407Z: 6f821164d5b7: Download complete
[STDOUT  ] 2017-05-26T21:59:36.189218599Z: 6f821164d5b7: Pull complete
[STDOUT  ] 2017-05-26T21:59:36.189301093Z: Digest: sha256:f02537b30c729bb1ee0c67c8bff3a28972bed0abbee8f5520421994c5247b896
[STDOUT  ] 2017-05-26T21:59:36.189365702Z: Status: Downloaded newer image for alpine:3.5
[STDOUT  ] 2017-05-26T21:59:36.189672728Z:  ---> 75b63e430bd1
[STDOUT  ] 2017-05-26T21:59:36.189792954Z: Step 9/11 : COPY --from=build /kmod/hello_world.ko /
[STDOUT  ] 2017-05-26T21:59:36.356672066Z:  ---> 32fb7cd8c82d
[STDOUT  ] 2017-05-26T21:59:36.36429991Z: Removing intermediate container 4b0567a4e9af
[STDOUT  ] 2017-05-26T21:59:36.364468498Z: Step 10/11 : COPY check.sh /check.sh
[STDOUT  ] 2017-05-26T21:59:36.514964516Z:  ---> fc1e97fcd8ae
[STDOUT  ] 2017-05-26T21:59:36.52366817Z: Removing intermediate container dbdb74719ebc
[STDOUT  ] 2017-05-26T21:59:36.523790432Z: Step 11/11 : ENTRYPOINT /bin/sh /check.sh
[STDOUT  ] 2017-05-26T21:59:36.593995649Z:  ---> Running in 58030adac51e
[STDOUT  ] 2017-05-26T21:59:36.64145485Z:  ---> 39c76aad0703
[STDOUT  ] 2017-05-26T21:59:36.647593282Z: Removing intermediate container 58030adac51e
[STDOUT  ] 2017-05-26T21:59:36.647702765Z: Successfully built 39c76aad0703
[STDOUT  ] 2017-05-26T21:59:36.651825833Z: Successfully tagged kmod-test:latest
[STDERR  ] 2017-05-26T21:59:36.663467684Z: + moby build -output kernel+initrd kmod
[STDERR  ] 2017-05-26T21:59:36.671773435Z: Extract kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-26T21:59:37.128239541Z: Add init containers:
[STDERR  ] 2017-05-26T21:59:37.128280169Z: Process init image: linuxkit/init:4fc8aa82ab34d62d510575c8fbe0c58b7ba9c480
[STDERR  ] 2017-05-26T21:59:37.23543536Z: Process init image: linuxkit/runc:3a4e6cbf15470f62501b019b55e1caac5ee7689f
[STDERR  ] 2017-05-26T21:59:37.355833672Z: Process init image: linuxkit/containerd:b1766e4c4c09f63ac4925a6e4612852a93f7e73b
[STDERR  ] 2017-05-26T21:59:37.805372781Z: Add onboot containers:
[STDERR  ] 2017-05-26T21:59:37.805415175Z:   Create OCI config for kmod-test
[STDERR  ] 2017-05-26T21:59:37.929984281Z:   Create OCI config for linuxkit/poweroff:a8f1e4ad8d459f1fdaad9e4b007512cb3b504ae8
[STDERR  ] 2017-05-26T21:59:38.063961072Z: Create outputs:
[STDERR  ] 2017-05-26T21:59:44.161268577Z:   kmod-kernel kmod-initrd.img kmod-cmdline
[STDERR  ] 2017-05-26T21:59:44.204102502Z: + grep -q Hello LinuxKit
[STDERR  ] 2017-05-26T21:59:44.20489532Z: + linuxkit run qemu kmod
[STDERR  ] 2017-05-26T21:59:44.21758295Z: Unable to find qemu-system-x86_64 within the $PATH. Using a container
[STDERR  ] 2017-05-26T22:00:04.058890165Z: write /dev/stdout: broken pipe
[STDERR  ] 2017-05-26T22:00:04.061991856Z: time="2017-05-26T22:00:04Z" level=fatal msg="exit status 1" 
[STDERR  ] 2017-05-26T22:00:04.062009474Z: + clean_up
[STDERR  ] 2017-05-26T22:00:04.062034757Z: + docker rmi kmod-test
[STDOUT  ] 2017-05-26T22:00:04.154376116Z: Untagged: kmod-test:latest
[STDOUT  ] 2017-05-26T22:00:04.154384836Z: Deleted: sha256:39c76aad07034a5f73c80ad13798d36bdc2b4e6e73f7d1fc8617063c41d7cdf2
[STDOUT  ] 2017-05-26T22:00:04.154392806Z: Deleted: sha256:fc1e97fcd8ae81770402369b8a8d211550034b6508cbc10e760d44b7967c19a2
[STDOUT  ] 2017-05-26T22:00:04.154416363Z: Deleted: sha256:ef2c79b918bb3602ae9670009e65f394b982d145dccb6e020ae908f35057a7c6
[STDOUT  ] 2017-05-26T22:00:04.154422972Z: Deleted: sha256:32fb7cd8c82da3b7c2261689cbef96c200d89b8994294289c32e08ba5d17995f
[STDOUT  ] 2017-05-26T22:00:04.154433982Z: Deleted: sha256:092306d58371a8b28e05cf8bd0a5152804fecbbde41fa0df40df59c230497964
[STDERR  ] 2017-05-26T22:00:04.155152526Z: + find . -iname kmod* -not -iname *.yml -exec rm -rf {} ;
[PASS    ] linuxkit.kernel.kmod_4.9.x 52.00s
