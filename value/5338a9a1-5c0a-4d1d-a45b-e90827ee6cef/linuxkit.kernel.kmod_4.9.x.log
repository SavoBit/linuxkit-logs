[INFO    ] 2017-05-24T18:19:59.532127194Z: Running Test linuxkit.kernel.kmod_4.9.x in /tmp/build/test/cases/020_kernel/010_kmod_4.9.x
[INFO    ] 2017-05-24T18:19:59.532202813Z: Running command: [/bin/sh -x /tmp/build/test/cases/020_kernel/010_kmod_4.9.x/test.sh]
[STDERR  ] 2017-05-24T18:19:59.574775436Z: + set -e
[STDERR  ] 2017-05-24T18:19:59.574820781Z: + . /tmp/build/test/cases/_lib/lib.sh
[STDERR  ] 2017-05-24T18:19:59.57487779Z: + [ -f src/github.com/linuxkit/rtf/lib/lib.sh ]
[STDERR  ] 2017-05-24T18:19:59.574919371Z: + LINUXKIT_TMPDIR=/tmp/build/test/cases/_tmp
[STDERR  ] 2017-05-24T18:19:59.574954626Z: + [ -f /tmp/build/test/cases/_tmp/env.sh ]
[STDERR  ] 2017-05-24T18:19:59.574977185Z: + . /tmp/build/test/cases/_tmp/env.sh
[STDERR  ] 2017-05-24T18:19:59.575004662Z: + export LINUXKIT_EXAMPLES_DIR=/tmp/build/test/cases/../../examples
[STDERR  ] 2017-05-24T18:19:59.575031096Z: + RT_CANCEL=253
[STDERR  ] 2017-05-24T18:19:59.575052712Z: + IMAGE_NAME=kmod-test
[STDERR  ] 2017-05-24T18:19:59.575080687Z: + trap clean_up EXIT
[STDERR  ] 2017-05-24T18:19:59.57511246Z: + docker pull linuxkit/kernel:4.9.x
[STDOUT  ] 2017-05-24T18:20:00.755391816Z: 4.9.x: Pulling from linuxkit/kernel
[STDOUT  ] 2017-05-24T18:20:00.75556178Z: Digest: sha256:41235c0c1093801dea6bf8acfb31091fcddd4848a752a77b89729f1e6320bbc7
[STDOUT  ] 2017-05-24T18:20:00.755600403Z: Status: Image is up to date for linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-24T18:20:00.756368722Z: + docker build -t kmod-test .
[STDOUT  ] 2017-05-24T18:20:00.799716118Z: Sending build context to Docker daemon  9.216kB
[STDOUT  ] 2017-05-24T18:20:00.867282072Z: Step 1/11 : FROM linuxkit/kernel:4.9.x AS ksrc
[STDOUT  ] 2017-05-24T18:20:00.867352396Z:  ---> 3173edc4f8bb
[STDOUT  ] 2017-05-24T18:20:00.867384962Z: Step 2/11 : FROM linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b AS build
[STDOUT  ] 2017-05-24T18:20:01.961956621Z: 1b396c221af673757703258159ddc8539843b02b: Pulling from linuxkit/kernel-compile
[STDOUT  ] 2017-05-24T18:20:01.972857889Z: 627beaf3eaaf: Already exists
[STDOUT  ] 2017-05-24T18:20:01.996842048Z: 26dc4067def6: Pulling fs layer
[STDOUT  ] 2017-05-24T18:20:07.153523136Z: 26dc4067def6: Verifying Checksum
[STDOUT  ] 2017-05-24T18:20:07.154927874Z: 26dc4067def6: Download complete
[STDOUT  ] 2017-05-24T18:20:13.173835451Z: 26dc4067def6: Pull complete
[STDOUT  ] 2017-05-24T18:20:13.183042168Z: Digest: sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-24T18:20:13.185996678Z: Status: Downloaded newer image for linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-24T18:20:13.186315575Z:  ---> 261c60c4eb02
[STDOUT  ] 2017-05-24T18:20:13.186416507Z: Step 3/11 : COPY --from=ksrc /kernel-dev.tar /
[STDOUT  ] 2017-05-24T18:20:15.262358285Z:  ---> a75793579690
[STDOUT  ] 2017-05-24T18:20:15.278924907Z: Removing intermediate container 88918d665e82
[STDOUT  ] 2017-05-24T18:20:15.279024472Z: Step 4/11 : RUN tar xf kernel-dev.tar
[STDOUT  ] 2017-05-24T18:20:15.350604342Z:  ---> Running in cada45792a7f
[STDOUT  ] 2017-05-24T18:20:23.990235964Z:  ---> 7a49334f39f3
[STDOUT  ] 2017-05-24T18:20:24.325565157Z: Removing intermediate container cada45792a7f
[STDOUT  ] 2017-05-24T18:20:24.325700113Z: Step 5/11 : WORKDIR /kmod
[STDOUT  ] 2017-05-24T18:20:24.530287315Z:  ---> 96fc054176e3
[STDOUT  ] 2017-05-24T18:20:24.553423881Z: Removing intermediate container ef1fa3e9c32d
[STDOUT  ] 2017-05-24T18:20:24.553578978Z: Step 6/11 : COPY ./src/* ./
[STDOUT  ] 2017-05-24T18:20:24.802323451Z:  ---> 9a35ce2e8151
[STDOUT  ] 2017-05-24T18:20:24.808359063Z: Removing intermediate container 029724a12259
[STDOUT  ] 2017-05-24T18:20:24.808498267Z: Step 7/11 : RUN make all
[STDOUT  ] 2017-05-24T18:20:24.869868219Z:  ---> Running in c3841394d29a
[STDOUT  ] 2017-05-24T18:20:25.060933649Z: make -C /usr/src/linux-headers-4.9.29-linuxkit M=/kmod modules
[STDOUT  ] 2017-05-24T18:20:25.06202818Z: make[1]: Entering directory '/usr/src/linux-headers-4.9.29-linuxkit'
[STDOUT  ] 2017-05-24T18:20:26.051425624Z:   CC [M]  /kmod/hello_world.o
[STDOUT  ] 2017-05-24T18:20:26.238775245Z:   Building modules, stage 2.
[STDOUT  ] 2017-05-24T18:20:26.245618395Z:   MODPOST 1 modules
[STDOUT  ] 2017-05-24T18:20:26.255936937Z:   CC      /kmod/hello_world.mod.o
[STDOUT  ] 2017-05-24T18:20:26.428900167Z:   LD [M]  /kmod/hello_world.ko
[STDOUT  ] 2017-05-24T18:20:26.431342575Z: make[1]: Leaving directory '/usr/src/linux-headers-4.9.29-linuxkit'
[STDOUT  ] 2017-05-24T18:20:26.642918046Z:  ---> 9f2813593621
[STDOUT  ] 2017-05-24T18:20:26.654182769Z: Removing intermediate container c3841394d29a
[STDOUT  ] 2017-05-24T18:20:26.65426908Z: Step 8/11 : FROM alpine:3.5
[STDOUT  ] 2017-05-24T18:20:27.766707459Z: 3.5: Pulling from library/alpine
[STDOUT  ] 2017-05-24T18:20:27.792747Z: cfc728c1c558: Already exists
[STDOUT  ] 2017-05-24T18:20:28.222539763Z: Digest: sha256:c0537ff6a5218ef531ece93d4984efc99bbf3f7497c0a7726c88e2bb7584dc96
[STDOUT  ] 2017-05-24T18:20:28.229235168Z: Status: Downloaded newer image for alpine:3.5
[STDOUT  ] 2017-05-24T18:20:28.229564541Z:  ---> 02674b9cb179
[STDOUT  ] 2017-05-24T18:20:28.229648891Z: Step 9/11 : COPY --from=build /kmod/hello_world.ko /
[STDOUT  ] 2017-05-24T18:20:28.40623759Z:  ---> 5e497724bb49
[STDOUT  ] 2017-05-24T18:20:28.413598351Z: Removing intermediate container 14beba6882cc
[STDOUT  ] 2017-05-24T18:20:28.413724185Z: Step 10/11 : COPY check.sh /check.sh
[STDOUT  ] 2017-05-24T18:20:28.570231897Z:  ---> 545350e180e1
[STDOUT  ] 2017-05-24T18:20:28.575311729Z: Removing intermediate container 75f448f9728a
[STDOUT  ] 2017-05-24T18:20:28.575438539Z: Step 11/11 : ENTRYPOINT /bin/sh /check.sh
[STDOUT  ] 2017-05-24T18:20:28.638535477Z:  ---> Running in e9dc156abf4a
[STDOUT  ] 2017-05-24T18:20:28.682446235Z:  ---> 42be2c140ea4
[STDOUT  ] 2017-05-24T18:20:28.687714417Z: Removing intermediate container e9dc156abf4a
[STDOUT  ] 2017-05-24T18:20:28.687784082Z: Successfully built 42be2c140ea4
[STDOUT  ] 2017-05-24T18:20:28.692039124Z: Successfully tagged kmod-test:latest
[STDERR  ] 2017-05-24T18:20:28.703137405Z: + moby build kmod
[STDERR  ] 2017-05-24T18:20:28.711717589Z: Extract kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-24T18:20:29.179152197Z: Add init containers:
[STDERR  ] 2017-05-24T18:20:29.179192324Z: Process init image: linuxkit/init:cbd7ae748f0a082516501a3e914fa0c924ee941e
[STDERR  ] 2017-05-24T18:20:29.301284709Z: Process init image: linuxkit/runc:24dfe632ed3ff53a026ee3fac046fd544434e2d6
[STDERR  ] 2017-05-24T18:20:29.42847974Z: Process init image: linuxkit/containerd:f1130450206d4f64f0ddc13d15bb68435aa1ff61
[STDERR  ] 2017-05-24T18:20:29.934653266Z: Add onboot containers:
[STDERR  ] 2017-05-24T18:20:29.934744409Z:   Create OCI config for kmod-test
[STDERR  ] 2017-05-24T18:20:30.056246231Z:   Create OCI config for linuxkit/poweroff:a8f1e4ad8d459f1fdaad9e4b007512cb3b504ae8
[STDERR  ] 2017-05-24T18:20:30.176940954Z: Create outputs:
[STDERR  ] 2017-05-24T18:20:35.758261762Z:   kmod-kernel kmod-initrd.img kmod-cmdline
[STDERR  ] 2017-05-24T18:20:35.805623097Z: + grep -q Hello LinuxKit
[STDERR  ] 2017-05-24T18:20:35.806518426Z: + linuxkit run qemu kmod
[STDERR  ] 2017-05-24T18:20:35.813047276Z: Unable to find qemu-system-x86_64 within the $PATH. Using a container
[STDERR  ] 2017-05-24T18:20:52.624199088Z: write /dev/stdout: broken pipe
[STDERR  ] 2017-05-24T18:20:52.62580055Z: time="2017-05-24T18:20:52Z" level=fatal msg="exit status 1" 
[STDERR  ] 2017-05-24T18:20:52.625811052Z: + clean_up
[STDERR  ] 2017-05-24T18:20:52.625814735Z: + docker rmi kmod-test
[STDOUT  ] 2017-05-24T18:20:52.661911533Z: Untagged: kmod-test:latest
[STDOUT  ] 2017-05-24T18:20:52.661923554Z: Deleted: sha256:42be2c140ea47f23463d6c867ceb37f7d0d950fa6c6d39685a74b428bd4d8b5c
[STDOUT  ] 2017-05-24T18:20:52.661931113Z: Deleted: sha256:545350e180e1c31dac24681dddc1613debda1acd29583028a7509b026deb2094
[STDOUT  ] 2017-05-24T18:20:52.661937819Z: Deleted: sha256:d7df8b365d99b71ffd224c2d3ab124466fa6abcbe09143b6e8d9418731f7bbf0
[STDOUT  ] 2017-05-24T18:20:52.661944141Z: Deleted: sha256:5e497724bb491d0da75ab57e93438faeaea87484bf6b50d31fe8dccd04178221
[STDOUT  ] 2017-05-24T18:20:52.661957302Z: Deleted: sha256:7e6d8cd3c2d81cc51ae6e99029a2a9bb6745c574c434ce6bac15daf10e967259
[STDERR  ] 2017-05-24T18:20:52.662721623Z: + find . -iname kmod* -not -iname *.yml -exec rm -rf {} ;
[PASS    ] linuxkit.kernel.kmod_4.9.x 53.15s
