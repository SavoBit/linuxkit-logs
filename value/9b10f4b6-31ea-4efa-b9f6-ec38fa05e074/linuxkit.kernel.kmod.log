[INFO    ] 2017-05-17T15:25:14.233698396Z: Running Test linuxkit.kernel.kmod in /tmp/build/test/cases/020_kernel/010_kmod
[INFO    ] 2017-05-17T15:25:14.233779503Z: Running command: [/bin/sh -x /tmp/build/test/cases/020_kernel/010_kmod/test.sh]
[STDERR  ] 2017-05-17T15:25:14.276975798Z: + set -e
[STDERR  ] 2017-05-17T15:25:14.277130729Z: + . /tmp/build/test/cases/_lib/lib.sh
[STDERR  ] 2017-05-17T15:25:14.277221087Z: + [ -f src/github.com/linuxkit/rtf/lib/lib.sh ]
[STDERR  ] 2017-05-17T15:25:14.29635318Z: + LINUXKIT_TMPDIR=/tmp/build/test/cases/_tmp
[STDERR  ] 2017-05-17T15:25:14.29640032Z: + [ -f /tmp/build/test/cases/_tmp/env.sh ]
[STDERR  ] 2017-05-17T15:25:14.296426306Z: + . /tmp/build/test/cases/_tmp/env.sh
[STDERR  ] 2017-05-17T15:25:14.296490319Z: + export LINUXKIT_EXAMPLES_DIR=/tmp/build/test/cases/../../examples
[STDERR  ] 2017-05-17T15:25:14.296541156Z: + RT_CANCEL=253
[STDERR  ] 2017-05-17T15:25:14.296563206Z: + IMAGE_NAME=kmod-test
[STDERR  ] 2017-05-17T15:25:14.29660161Z: + trap clean_up EXIT
[STDERR  ] 2017-05-17T15:25:14.296632493Z: + docker pull linuxkit/kernel:4.9.x
[STDOUT  ] 2017-05-17T15:25:15.478260302Z: 4.9.x: Pulling from linuxkit/kernel
[STDOUT  ] 2017-05-17T15:25:15.478368954Z: Digest: sha256:dd706d391fddc3d2efc254a6c03223d6cb82b86a3dc059a9264063be2fd8911f
[STDOUT  ] 2017-05-17T15:25:15.478450405Z: Status: Image is up to date for linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-17T15:25:15.479257614Z: + docker build -t kmod-test .
[STDOUT  ] 2017-05-17T15:25:15.519644269Z: Sending build context to Docker daemon  9.216kB
[STDOUT  ] 2017-05-17T15:25:15.539265435Z: Step 1/11 : FROM linuxkit/kernel:4.9.x AS ksrc
[STDOUT  ] 2017-05-17T15:25:15.625647007Z:  ---> cc9f6cd19506
[STDOUT  ] 2017-05-17T15:25:15.625778373Z: Step 2/11 : FROM linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b AS build
[STDOUT  ] 2017-05-17T15:25:16.730837803Z: 1b396c221af673757703258159ddc8539843b02b: Pulling from linuxkit/kernel-compile
[STDOUT  ] 2017-05-17T15:25:16.73085301Z: 627beaf3eaaf: Already exists
[STDOUT  ] 2017-05-17T15:25:16.737017397Z: 26dc4067def6: Pulling fs layer
[STDOUT  ] 2017-05-17T15:25:19.932584456Z: 26dc4067def6: Verifying Checksum
[STDOUT  ] 2017-05-17T15:25:19.934024889Z: 26dc4067def6: Download complete
[STDOUT  ] 2017-05-17T15:25:26.719733841Z: 26dc4067def6: Pull complete
[STDOUT  ] 2017-05-17T15:25:26.730569921Z: Digest: sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-17T15:25:26.734424741Z: Status: Downloaded newer image for linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-17T15:25:26.735437383Z:  ---> 261c60c4eb02
[STDOUT  ] 2017-05-17T15:25:26.735614459Z: Step 3/11 : COPY --from=ksrc /kernel-dev.tar /
[STDOUT  ] 2017-05-17T15:25:28.915097594Z:  ---> 895af6feb0e8
[STDOUT  ] 2017-05-17T15:25:28.939969154Z: Removing intermediate container 6ef0388e35d0
[STDOUT  ] 2017-05-17T15:25:28.940132773Z: Step 4/11 : RUN tar xf kernel-dev.tar
[STDOUT  ] 2017-05-17T15:25:29.020821687Z:  ---> Running in 31d65ceeae11
[STDOUT  ] 2017-05-17T15:25:35.708781659Z:  ---> 6e64e5dc45c3
[STDOUT  ] 2017-05-17T15:25:36.065439803Z: Removing intermediate container 31d65ceeae11
[STDOUT  ] 2017-05-17T15:25:36.06556996Z: Step 5/11 : WORKDIR /kmod
[STDOUT  ] 2017-05-17T15:25:36.232896376Z:  ---> 5d5bd04fb6fe
[STDOUT  ] 2017-05-17T15:25:36.23824073Z: Removing intermediate container 15e8c2ce78d9
[STDOUT  ] 2017-05-17T15:25:36.238384252Z: Step 6/11 : COPY ./src/* ./
[STDOUT  ] 2017-05-17T15:25:36.421273469Z:  ---> e998da4e37b0
[STDOUT  ] 2017-05-17T15:25:36.426931449Z: Removing intermediate container 87f4ac42046e
[STDOUT  ] 2017-05-17T15:25:36.427059956Z: Step 7/11 : RUN make all
[STDOUT  ] 2017-05-17T15:25:36.51845854Z:  ---> Running in aa8b986735bd
[STDOUT  ] 2017-05-17T15:25:36.684904956Z: make -C /usr/src/linux-headers-4.9.28-linuxkit M=/kmod modules
[STDOUT  ] 2017-05-17T15:25:36.685977345Z: make[1]: Entering directory '/usr/src/linux-headers-4.9.28-linuxkit'
[STDOUT  ] 2017-05-17T15:25:37.601852587Z:   CC [M]  /kmod/hello_world.o
[STDOUT  ] 2017-05-17T15:25:37.79700083Z:   Building modules, stage 2.
[STDOUT  ] 2017-05-17T15:25:37.803052612Z:   MODPOST 1 modules
[STDOUT  ] 2017-05-17T15:25:37.813287051Z:   CC      /kmod/hello_world.mod.o
[STDOUT  ] 2017-05-17T15:25:37.987153012Z:   LD [M]  /kmod/hello_world.ko
[STDOUT  ] 2017-05-17T15:25:37.989621458Z: make[1]: Leaving directory '/usr/src/linux-headers-4.9.28-linuxkit'
[STDOUT  ] 2017-05-17T15:25:38.188319076Z:  ---> 7399f52f09e9
[STDOUT  ] 2017-05-17T15:25:38.198429707Z: Removing intermediate container aa8b986735bd
[STDOUT  ] 2017-05-17T15:25:38.198591671Z: Step 8/11 : FROM alpine:3.5
[STDOUT  ] 2017-05-17T15:25:39.282486527Z: 3.5: Pulling from library/alpine
[STDOUT  ] 2017-05-17T15:25:39.301709701Z: cfc728c1c558: Already exists
[STDOUT  ] 2017-05-17T15:25:39.768661999Z: Digest: sha256:c0537ff6a5218ef531ece93d4984efc99bbf3f7497c0a7726c88e2bb7584dc96
[STDOUT  ] 2017-05-17T15:25:39.777261951Z: Status: Downloaded newer image for alpine:3.5
[STDOUT  ] 2017-05-17T15:25:39.777623233Z:  ---> 02674b9cb179
[STDOUT  ] 2017-05-17T15:25:39.777782767Z: Step 9/11 : COPY --from=build /kmod/hello_world.ko /
[STDOUT  ] 2017-05-17T15:25:41.727467748Z:  ---> 18674c4b9099
[STDOUT  ] 2017-05-17T15:25:41.737115861Z: Removing intermediate container b0aae20e4b5b
[STDOUT  ] 2017-05-17T15:25:41.737295547Z: Step 10/11 : COPY check.sh /check.sh
[STDOUT  ] 2017-05-17T15:25:41.895060878Z:  ---> 6d13359da061
[STDOUT  ] 2017-05-17T15:25:41.901540273Z: Removing intermediate container 29056769c83c
[STDOUT  ] 2017-05-17T15:25:41.901656713Z: Step 11/11 : ENTRYPOINT /bin/sh /check.sh
[STDOUT  ] 2017-05-17T15:25:41.967803013Z:  ---> Running in a19e2630698b
[STDOUT  ] 2017-05-17T15:25:42.012936009Z:  ---> 316699d5fec1
[STDOUT  ] 2017-05-17T15:25:42.018059757Z: Removing intermediate container a19e2630698b
[STDOUT  ] 2017-05-17T15:25:42.018174957Z: Successfully built 316699d5fec1
[STDOUT  ] 2017-05-17T15:25:42.022443232Z: Successfully tagged kmod-test:latest
[STDERR  ] 2017-05-17T15:25:42.032444724Z: + moby build kmod
[STDERR  ] 2017-05-17T15:25:42.041019749Z: Extract kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-17T15:25:42.491007169Z: Add init containers:
[STDERR  ] 2017-05-17T15:25:42.491044576Z: Process init image: linuxkit/init:b3740303f3d1e5689a84c87b7dfb48fd2a40a192
[STDERR  ] 2017-05-17T15:25:42.611489512Z: Process init image: linuxkit/runc:47b1c38d63468c0f3078f8b1b055d07965a1895d
[STDERR  ] 2017-05-17T15:25:42.7352467Z: Process init image: linuxkit/containerd:cf2614f5a96c569a0bd4bd54e054a65ba17d167f
[STDERR  ] 2017-05-17T15:25:43.115954082Z: Add onboot containers:
[STDERR  ] 2017-05-17T15:25:43.116011736Z:   Create OCI config for kmod-test
[STDERR  ] 2017-05-17T15:25:43.298396525Z:   Create OCI config for linuxkit/poweroff:961412b8ef5c5285de0d40ec076701d955eaa084
[STDERR  ] 2017-05-17T15:25:43.430724354Z: Create outputs:
[STDERR  ] 2017-05-17T15:25:48.042972586Z:   kmod-kernel kmod-initrd.img kmod-cmdline
[STDERR  ] 2017-05-17T15:25:48.084136927Z: + grep -q Hello LinuxKit
[STDERR  ] 2017-05-17T15:25:48.084961272Z: + linuxkit run qemu kmod
[STDERR  ] 2017-05-17T15:25:48.090488279Z: Unable to find qemu-system-x86_64 within the $PATH. Using a container
[STDERR  ] 2017-05-17T15:26:04.495506816Z: write /dev/stdout: broken pipe
[STDERR  ] 2017-05-17T15:26:04.49700706Z: time="2017-05-17T15:26:04Z" level=fatal msg="exit status 1" 
[STDERR  ] 2017-05-17T15:26:04.497030841Z: + clean_up
[STDERR  ] 2017-05-17T15:26:04.497034614Z: + docker rmi kmod-test
[STDOUT  ] 2017-05-17T15:26:04.537940913Z: Untagged: kmod-test:latest
[STDOUT  ] 2017-05-17T15:26:04.537977429Z: Deleted: sha256:316699d5fec1783148d4938236604bfa062ce383313408e575707be6822c0700
[STDOUT  ] 2017-05-17T15:26:04.537989509Z: Deleted: sha256:6d13359da0619de30a37ed799ea20d6b605d95b43a1f538fd09d9e78d0157751
[STDOUT  ] 2017-05-17T15:26:04.537996258Z: Deleted: sha256:3944c9c6d206d27a81db0ec2eced9a0d1f0376e365590f4ec578b35264671ac0
[STDOUT  ] 2017-05-17T15:26:04.538003035Z: Deleted: sha256:18674c4b90992fc7e574ee7bc3542189e526b8e1ac7717a882fe3aecf4e40e97
[STDOUT  ] 2017-05-17T15:26:04.538017311Z: Deleted: sha256:041de99e14e00c6eb29f1524c5e3271ffbf81887ce585fd287f0922ee859de36
[STDERR  ] 2017-05-17T15:26:04.538614101Z: + find . -iname kmod* -not -iname *.yml -exec rm -rf {} ;
[PASS    ] linuxkit.kernel.kmod 50.32s
