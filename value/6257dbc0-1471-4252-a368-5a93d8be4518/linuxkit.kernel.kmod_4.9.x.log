[INFO    ] 2017-05-30T11:29:23.436078587Z: Running Test linuxkit.kernel.kmod_4.9.x in /tmp/build/test/cases/020_kernel/010_kmod_4.9.x
[INFO    ] 2017-05-30T11:29:23.436131786Z: Running command: [/bin/sh -x /tmp/build/test/cases/020_kernel/010_kmod_4.9.x/test.sh]
[STDERR  ] 2017-05-30T11:29:23.468131002Z: + set -e
[STDERR  ] 2017-05-30T11:29:23.468174963Z: + . /tmp/build/test/cases/_lib/lib.sh
[STDERR  ] 2017-05-30T11:29:23.468229576Z: + [ -f src/github.com/linuxkit/rtf/lib/lib.sh ]
[STDERR  ] 2017-05-30T11:29:23.468259648Z: + LINUXKIT_TMPDIR=/tmp/build/test/cases/_tmp
[STDERR  ] 2017-05-30T11:29:23.468283578Z: + [ -f /tmp/build/test/cases/_tmp/env.sh ]
[STDERR  ] 2017-05-30T11:29:23.468312393Z: + . /tmp/build/test/cases/_tmp/env.sh
[STDERR  ] 2017-05-30T11:29:23.468345601Z: + export LINUXKIT_EXAMPLES_DIR=/tmp/build/test/cases/../../examples
[STDERR  ] 2017-05-30T11:29:23.468362857Z: + RT_CANCEL=253
[STDERR  ] 2017-05-30T11:29:23.468388536Z: + IMAGE_NAME=kmod-test
[STDERR  ] 2017-05-30T11:29:23.468427724Z: + trap clean_up EXIT
[STDERR  ] 2017-05-30T11:29:23.468455888Z: + docker pull linuxkit/kernel:4.9.x
[STDOUT  ] 2017-05-30T11:29:24.589278771Z: 4.9.x: Pulling from linuxkit/kernel
[STDOUT  ] 2017-05-30T11:29:24.589431003Z: Digest: sha256:41235c0c1093801dea6bf8acfb31091fcddd4848a752a77b89729f1e6320bbc7
[STDOUT  ] 2017-05-30T11:29:24.589463695Z: Status: Image is up to date for linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-30T11:29:24.590154924Z: + docker build -t kmod-test .
[STDOUT  ] 2017-05-30T11:29:24.626377385Z: Sending build context to Docker daemon  9.216kB
[STDOUT  ] 2017-05-30T11:29:24.650674243Z: Step 1/11 : FROM linuxkit/kernel:4.9.x AS ksrc
[STDOUT  ] 2017-05-30T11:29:24.655995845Z:  ---> 3173edc4f8bb
[STDOUT  ] 2017-05-30T11:29:24.656067606Z: Step 2/11 : FROM linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b AS build
[STDOUT  ] 2017-05-30T11:29:25.759847537Z: 1b396c221af673757703258159ddc8539843b02b: Pulling from linuxkit/kernel-compile
[STDOUT  ] 2017-05-30T11:29:25.78710069Z: 627beaf3eaaf: Already exists
[STDOUT  ] 2017-05-30T11:29:25.803006618Z: 26dc4067def6: Pulling fs layer
[STDOUT  ] 2017-05-30T11:29:28.895899192Z: 26dc4067def6: Verifying Checksum
[STDOUT  ] 2017-05-30T11:29:28.89597134Z: 26dc4067def6: Download complete
[STDOUT  ] 2017-05-30T11:29:34.869944691Z: 26dc4067def6: Pull complete
[STDOUT  ] 2017-05-30T11:29:34.881329054Z: Digest: sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-30T11:29:34.883615958Z: Status: Downloaded newer image for linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-30T11:29:34.883935546Z:  ---> 261c60c4eb02
[STDOUT  ] 2017-05-30T11:29:34.884033Z: Step 3/11 : COPY --from=ksrc /kernel-dev.tar /
[STDOUT  ] 2017-05-30T11:29:36.905101242Z:  ---> 9334ee1f3054
[STDOUT  ] 2017-05-30T11:29:36.955316374Z: Removing intermediate container bd623094b234
[STDOUT  ] 2017-05-30T11:29:36.955421052Z: Step 4/11 : RUN tar xf kernel-dev.tar
[STDOUT  ] 2017-05-30T11:29:37.128947248Z:  ---> Running in 23d781fcbfdf
[STDOUT  ] 2017-05-30T11:29:43.244553977Z:  ---> 7d1ac6ae18d1
[STDOUT  ] 2017-05-30T11:29:43.590108608Z: Removing intermediate container 23d781fcbfdf
[STDOUT  ] 2017-05-30T11:29:43.590213576Z: Step 5/11 : WORKDIR /kmod
[STDOUT  ] 2017-05-30T11:29:43.913214109Z:  ---> 5590bbc3cff6
[STDOUT  ] 2017-05-30T11:29:43.92967731Z: Removing intermediate container 7b0073f5681a
[STDOUT  ] 2017-05-30T11:29:43.929832257Z: Step 6/11 : COPY ./src/* ./
[STDOUT  ] 2017-05-30T11:29:44.235919026Z:  ---> aeda945e350a
[STDOUT  ] 2017-05-30T11:29:44.253186591Z: Removing intermediate container acb16ce68dc1
[STDOUT  ] 2017-05-30T11:29:44.253268664Z: Step 7/11 : RUN make all
[STDOUT  ] 2017-05-30T11:29:44.32244195Z:  ---> Running in 5403845fbb61
[STDOUT  ] 2017-05-30T11:29:44.463539138Z: make -C /usr/src/linux-headers-4.9.29-linuxkit M=/kmod modules
[STDOUT  ] 2017-05-30T11:29:44.464760733Z: make[1]: Entering directory '/usr/src/linux-headers-4.9.29-linuxkit'
[STDOUT  ] 2017-05-30T11:29:45.357929242Z:   CC [M]  /kmod/hello_world.o
[STDOUT  ] 2017-05-30T11:29:45.551603123Z:   Building modules, stage 2.
[STDOUT  ] 2017-05-30T11:29:45.558930742Z:   MODPOST 1 modules
[STDOUT  ] 2017-05-30T11:29:45.569580693Z:   CC      /kmod/hello_world.mod.o
[STDOUT  ] 2017-05-30T11:29:45.745949708Z:   LD [M]  /kmod/hello_world.ko
[STDOUT  ] 2017-05-30T11:29:45.748459645Z: make[1]: Leaving directory '/usr/src/linux-headers-4.9.29-linuxkit'
[STDOUT  ] 2017-05-30T11:29:45.938377172Z:  ---> 6f65d19b1f97
[STDOUT  ] 2017-05-30T11:29:45.95520796Z: Removing intermediate container 5403845fbb61
[STDOUT  ] 2017-05-30T11:29:45.955303652Z: Step 8/11 : FROM alpine:3.5
[STDOUT  ] 2017-05-30T11:29:47.072510185Z: 3.5: Pulling from library/alpine
[STDOUT  ] 2017-05-30T11:29:47.095300023Z: 6f821164d5b7: Already exists
[STDOUT  ] 2017-05-30T11:29:47.563309925Z: Digest: sha256:f02537b30c729bb1ee0c67c8bff3a28972bed0abbee8f5520421994c5247b896
[STDOUT  ] 2017-05-30T11:29:47.57157704Z: Status: Downloaded newer image for alpine:3.5
[STDOUT  ] 2017-05-30T11:29:47.57185758Z:  ---> 75b63e430bd1
[STDOUT  ] 2017-05-30T11:29:47.571943318Z: Step 9/11 : COPY --from=build /kmod/hello_world.ko /
[STDOUT  ] 2017-05-30T11:29:47.727565735Z:  ---> 47ade5fc4907
[STDOUT  ] 2017-05-30T11:29:47.732934028Z: Removing intermediate container 939cb83d53cb
[STDOUT  ] 2017-05-30T11:29:47.732944277Z: Step 10/11 : COPY check.sh /check.sh
[STDOUT  ] 2017-05-30T11:29:47.882870736Z:  ---> fabaefed2f2e
[STDOUT  ] 2017-05-30T11:29:47.888933273Z: Removing intermediate container 96f4146d42c1
[STDOUT  ] 2017-05-30T11:29:47.88894291Z: Step 11/11 : ENTRYPOINT /bin/sh /check.sh
[STDOUT  ] 2017-05-30T11:29:47.955715515Z:  ---> Running in 1e4267364d33
[STDOUT  ] 2017-05-30T11:29:48.007432021Z:  ---> f3890b7c4c4d
[STDOUT  ] 2017-05-30T11:29:48.013621015Z: Removing intermediate container 1e4267364d33
[STDOUT  ] 2017-05-30T11:29:48.01372705Z: Successfully built f3890b7c4c4d
[STDOUT  ] 2017-05-30T11:29:48.031115845Z: Successfully tagged kmod-test:latest
[STDERR  ] 2017-05-30T11:29:48.042192894Z: + moby build -output kernel+initrd kmod
[STDERR  ] 2017-05-30T11:29:48.051246186Z: Pull kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-30T11:29:50.720831569Z: Extract kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-30T11:29:50.720878673Z: Pull image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-30T11:29:53.966730964Z: Add init containers:
[STDERR  ] 2017-05-30T11:29:53.966772052Z: Process init image: linuxkit/init:4fc8aa82ab34d62d510575c8fbe0c58b7ba9c480
[STDERR  ] 2017-05-30T11:29:53.966811301Z: Pull image: linuxkit/init:4fc8aa82ab34d62d510575c8fbe0c58b7ba9c480
[STDERR  ] 2017-05-30T11:29:56.668136129Z: Process init image: linuxkit/runc:3a4e6cbf15470f62501b019b55e1caac5ee7689f
[STDERR  ] 2017-05-30T11:29:56.668171008Z: Pull image: linuxkit/runc:3a4e6cbf15470f62501b019b55e1caac5ee7689f
[STDERR  ] 2017-05-30T11:29:59.530933552Z: Process init image: linuxkit/containerd:b1766e4c4c09f63ac4925a6e4612852a93f7e73b
[STDERR  ] 2017-05-30T11:29:59.530976042Z: Pull image: linuxkit/containerd:b1766e4c4c09f63ac4925a6e4612852a93f7e73b
[STDERR  ] 2017-05-30T11:30:03.051837901Z: Add onboot containers:
[STDERR  ] 2017-05-30T11:30:03.051912386Z:   Create OCI config for kmod-test
[STDERR  ] 2017-05-30T11:30:03.187399826Z:   Create OCI config for linuxkit/poweroff:a8f1e4ad8d459f1fdaad9e4b007512cb3b504ae8
[STDERR  ] 2017-05-30T11:30:03.189609328Z: Pull image: linuxkit/poweroff:a8f1e4ad8d459f1fdaad9e4b007512cb3b504ae8
[STDERR  ] 2017-05-30T11:30:06.028665177Z: Create outputs:
[STDERR  ] 2017-05-30T11:30:11.93166946Z:   kmod-kernel kmod-initrd.img kmod-cmdline
[STDERR  ] 2017-05-30T11:30:11.977736269Z: + grep -q Hello LinuxKit
[STDERR  ] 2017-05-30T11:30:11.978685016Z: + linuxkit run qemu kmod
[STDERR  ] 2017-05-30T11:30:11.992272169Z: Unable to find qemu-system-x86_64 within the $PATH. Using a container
[STDERR  ] 2017-05-30T11:30:29.916636074Z: write /dev/stdout: broken pipe
[STDERR  ] 2017-05-30T11:30:29.919178544Z: time="2017-05-30T11:30:29Z" level=fatal msg="exit status 1" 
[STDERR  ] 2017-05-30T11:30:29.919256597Z: + clean_up
[STDERR  ] 2017-05-30T11:30:29.91926334Z: + docker rmi kmod-test
[STDOUT  ] 2017-05-30T11:30:29.961965959Z: Untagged: kmod-test:latest
[STDOUT  ] 2017-05-30T11:30:29.961979867Z: Deleted: sha256:f3890b7c4c4d7ebd5e06b481174e45dbc74881a0a99f6f113920de2bc3e8c0b5
[STDOUT  ] 2017-05-30T11:30:29.961987044Z: Deleted: sha256:fabaefed2f2e20f258ccf295d1bf4b60f91383e7fffcb52f2e106e1905492352
[STDOUT  ] 2017-05-30T11:30:29.961993762Z: Deleted: sha256:f839d24351045084cb0de4ae7edbcbf0062942601a29243e0d1edd100a53535e
[STDOUT  ] 2017-05-30T11:30:29.962001187Z: Deleted: sha256:47ade5fc49078ed64072e9a79cbe31b7be19dd7a51a84d760e25308bf00b946f
[STDOUT  ] 2017-05-30T11:30:29.962012501Z: Deleted: sha256:562d34f6e500ba519cd4710f8d41a678b137f1fe181817b0599f2fbfe82d4ba3
[STDERR  ] 2017-05-30T11:30:29.962752582Z: + find . -iname kmod* -not -iname *.yml -exec rm -rf {} ;
[PASS    ] linuxkit.kernel.kmod_4.9.x 66.55s
