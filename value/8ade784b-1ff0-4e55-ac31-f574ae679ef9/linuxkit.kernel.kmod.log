[INFO    ] 2017-05-18T20:59:47.314754579Z: Running Test linuxkit.kernel.kmod in /tmp/build/test/cases/020_kernel/010_kmod
[INFO    ] 2017-05-18T20:59:47.314835895Z: Running command: [/bin/sh -x /tmp/build/test/cases/020_kernel/010_kmod/test.sh]
[STDERR  ] 2017-05-18T20:59:47.346507031Z: + set -e
[STDERR  ] 2017-05-18T20:59:47.346553649Z: + . /tmp/build/test/cases/_lib/lib.sh
[STDERR  ] 2017-05-18T20:59:47.346627272Z: + [ -f src/github.com/linuxkit/rtf/lib/lib.sh ]
[STDERR  ] 2017-05-18T20:59:47.368530688Z: + LINUXKIT_TMPDIR=/tmp/build/test/cases/_tmp
[STDERR  ] 2017-05-18T20:59:47.368580063Z: + [ -f /tmp/build/test/cases/_tmp/env.sh ]
[STDERR  ] 2017-05-18T20:59:47.368622643Z: + . /tmp/build/test/cases/_tmp/env.sh
[STDERR  ] 2017-05-18T20:59:47.368670238Z: + export LINUXKIT_EXAMPLES_DIR=/tmp/build/test/cases/../../examples
[STDERR  ] 2017-05-18T20:59:47.368707575Z: + RT_CANCEL=253
[STDERR  ] 2017-05-18T20:59:47.368726348Z: + IMAGE_NAME=kmod-test
[STDERR  ] 2017-05-18T20:59:47.36876375Z: + trap clean_up EXIT
[STDERR  ] 2017-05-18T20:59:47.368792386Z: + docker pull linuxkit/kernel:4.9.x
[STDOUT  ] 2017-05-18T20:59:48.571678122Z: 4.9.x: Pulling from linuxkit/kernel
[STDOUT  ] 2017-05-18T20:59:48.571888953Z: Digest: sha256:2ddac8acd71d8e20484c8a4cc1ec6218b4331ea7239e1542e872ae4c2967e0af
[STDOUT  ] 2017-05-18T20:59:48.571937752Z: Status: Image is up to date for linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-18T20:59:48.572850889Z: + docker build -t kmod-test .
[STDOUT  ] 2017-05-18T20:59:48.624913012Z: Sending build context to Docker daemon  9.216kB
[STDOUT  ] 2017-05-18T20:59:48.641419747Z: Step 1/11 : FROM linuxkit/kernel:4.9.x AS ksrc
[STDOUT  ] 2017-05-18T20:59:48.657086691Z:  ---> e5d78905f6de
[STDOUT  ] 2017-05-18T20:59:48.657220597Z: Step 2/11 : FROM linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b AS build
[STDOUT  ] 2017-05-18T20:59:49.753772653Z: 1b396c221af673757703258159ddc8539843b02b: Pulling from linuxkit/kernel-compile
[STDOUT  ] 2017-05-18T20:59:49.75378636Z: 627beaf3eaaf: Already exists
[STDOUT  ] 2017-05-18T20:59:49.76120748Z: 26dc4067def6: Pulling fs layer
[STDOUT  ] 2017-05-18T20:59:54.297913483Z: 26dc4067def6: Verifying Checksum
[STDOUT  ] 2017-05-18T20:59:54.299529714Z: 26dc4067def6: Download complete
[STDOUT  ] 2017-05-18T21:00:01.19499087Z: 26dc4067def6: Pull complete
[STDOUT  ] 2017-05-18T21:00:01.204548899Z: Digest: sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-18T21:00:01.208056505Z: Status: Downloaded newer image for linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-18T21:00:01.208498563Z:  ---> 261c60c4eb02
[STDOUT  ] 2017-05-18T21:00:01.208586638Z: Step 3/11 : COPY --from=ksrc /kernel-dev.tar /
[STDOUT  ] 2017-05-18T21:00:03.514790832Z:  ---> 2ecd3a7d33ab
[STDOUT  ] 2017-05-18T21:00:03.538070631Z: Removing intermediate container aa48e6762023
[STDOUT  ] 2017-05-18T21:00:03.538222193Z: Step 4/11 : RUN tar xf kernel-dev.tar
[STDOUT  ] 2017-05-18T21:00:03.608036922Z:  ---> Running in 3b7ce05d89d5
[STDOUT  ] 2017-05-18T21:00:10.219481924Z:  ---> b72660a18cba
[STDOUT  ] 2017-05-18T21:00:10.558932528Z: Removing intermediate container 3b7ce05d89d5
[STDOUT  ] 2017-05-18T21:00:10.559101618Z: Step 5/11 : WORKDIR /kmod
[STDOUT  ] 2017-05-18T21:00:10.780404635Z:  ---> be93cab8e241
[STDOUT  ] 2017-05-18T21:00:10.790582148Z: Removing intermediate container 0eca548b8235
[STDOUT  ] 2017-05-18T21:00:10.790713448Z: Step 6/11 : COPY ./src/* ./
[STDOUT  ] 2017-05-18T21:00:11.04018425Z:  ---> 329f8275e23b
[STDOUT  ] 2017-05-18T21:00:11.050960332Z: Removing intermediate container 1bf12eb1da41
[STDOUT  ] 2017-05-18T21:00:11.051074422Z: Step 7/11 : RUN make all
[STDOUT  ] 2017-05-18T21:00:11.130953757Z:  ---> Running in 960e03e77b9f
[STDOUT  ] 2017-05-18T21:00:11.304717912Z: make -C /usr/src/linux-headers-4.9.28-linuxkit M=/kmod modules
[STDOUT  ] 2017-05-18T21:00:11.30735596Z: make[1]: Entering directory '/usr/src/linux-headers-4.9.28-linuxkit'
[STDOUT  ] 2017-05-18T21:00:12.305676755Z:   CC [M]  /kmod/hello_world.o
[STDOUT  ] 2017-05-18T21:00:12.516707096Z:   Building modules, stage 2.
[STDOUT  ] 2017-05-18T21:00:12.526157327Z:   MODPOST 1 modules
[STDOUT  ] 2017-05-18T21:00:12.54011527Z:   CC      /kmod/hello_world.mod.o
[STDOUT  ] 2017-05-18T21:00:12.734276047Z:   LD [M]  /kmod/hello_world.ko
[STDOUT  ] 2017-05-18T21:00:12.73673691Z: make[1]: Leaving directory '/usr/src/linux-headers-4.9.28-linuxkit'
[STDOUT  ] 2017-05-18T21:00:12.950523448Z:  ---> 6074fc0e1283
[STDOUT  ] 2017-05-18T21:00:12.963310449Z: Removing intermediate container 960e03e77b9f
[STDOUT  ] 2017-05-18T21:00:12.963459055Z: Step 8/11 : FROM alpine:3.5
[STDOUT  ] 2017-05-18T21:00:14.170008948Z: 3.5: Pulling from library/alpine
[STDOUT  ] 2017-05-18T21:00:14.186838496Z: cfc728c1c558: Already exists
[STDOUT  ] 2017-05-18T21:00:14.634645472Z: Digest: sha256:c0537ff6a5218ef531ece93d4984efc99bbf3f7497c0a7726c88e2bb7584dc96
[STDOUT  ] 2017-05-18T21:00:14.654577256Z: Status: Downloaded newer image for alpine:3.5
[STDOUT  ] 2017-05-18T21:00:14.655473776Z:  ---> 02674b9cb179
[STDOUT  ] 2017-05-18T21:00:14.655631018Z: Step 9/11 : COPY --from=build /kmod/hello_world.ko /
[STDOUT  ] 2017-05-18T21:00:14.850376455Z:  ---> 3218eed83b59
[STDOUT  ] 2017-05-18T21:00:14.858405896Z: Removing intermediate container 1fb68d1645ae
[STDOUT  ] 2017-05-18T21:00:14.858569876Z: Step 10/11 : COPY check.sh /check.sh
[STDOUT  ] 2017-05-18T21:00:15.031930764Z:  ---> ffff620be3ff
[STDOUT  ] 2017-05-18T21:00:15.038923883Z: Removing intermediate container 3d74d2d9bb53
[STDOUT  ] 2017-05-18T21:00:15.039077624Z: Step 11/11 : ENTRYPOINT /bin/sh /check.sh
[STDOUT  ] 2017-05-18T21:00:15.115266389Z:  ---> Running in 1cfdb59f7297
[STDOUT  ] 2017-05-18T21:00:15.204911414Z:  ---> 5d46e7d81b53
[STDOUT  ] 2017-05-18T21:00:15.212698554Z: Removing intermediate container 1cfdb59f7297
[STDOUT  ] 2017-05-18T21:00:15.212771875Z: Successfully built 5d46e7d81b53
[STDOUT  ] 2017-05-18T21:00:15.220477665Z: Successfully tagged kmod-test:latest
[STDERR  ] 2017-05-18T21:00:15.2375945Z: + moby build kmod
[STDERR  ] 2017-05-18T21:00:15.247830686Z: Extract kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-18T21:00:15.75678863Z: Add init containers:
[STDERR  ] 2017-05-18T21:00:15.756821659Z: Process init image: linuxkit/init:cbd7ae748f0a082516501a3e914fa0c924ee941e
[STDERR  ] 2017-05-18T21:00:15.885129522Z: Process init image: linuxkit/runc:24dfe632ed3ff53a026ee3fac046fd544434e2d6
[STDERR  ] 2017-05-18T21:00:16.030594546Z: Process init image: linuxkit/containerd:1c71f95fa36040ea7e987deb98a7a2a363853f01
[STDERR  ] 2017-05-18T21:00:16.486993908Z: Add onboot containers:
[STDERR  ] 2017-05-18T21:00:16.487081986Z:   Create OCI config for kmod-test
[STDERR  ] 2017-05-18T21:00:16.715511433Z:   Create OCI config for linuxkit/poweroff:961412b8ef5c5285de0d40ec076701d955eaa084
[STDERR  ] 2017-05-18T21:00:16.852482703Z: Create outputs:
[STDERR  ] 2017-05-18T21:00:22.887863989Z:   kmod-kernel kmod-initrd.img kmod-cmdline
[STDERR  ] 2017-05-18T21:00:22.955904259Z: + grep -q Hello LinuxKit
[STDERR  ] 2017-05-18T21:00:22.956774284Z: + linuxkit run qemu kmod
[STDERR  ] 2017-05-18T21:00:22.966376307Z: Unable to find qemu-system-x86_64 within the $PATH. Using a container
[STDERR  ] 2017-05-18T21:00:42.839643187Z: write /dev/stdout: broken pipe
[STDERR  ] 2017-05-18T21:00:42.841266913Z: time="2017-05-18T21:00:42Z" level=fatal msg="exit status 1" 
[STDERR  ] 2017-05-18T21:00:42.841277364Z: + clean_up
[STDERR  ] 2017-05-18T21:00:42.841284108Z: + docker rmi kmod-test
[STDOUT  ] 2017-05-18T21:00:42.875109079Z: Untagged: kmod-test:latest
[STDOUT  ] 2017-05-18T21:00:42.875128665Z: Deleted: sha256:5d46e7d81b530e5e977b3b6604d1eae9eb63b5f79fd901869e1b5392334c3ce6
[STDOUT  ] 2017-05-18T21:00:42.875138255Z: Deleted: sha256:ffff620be3ffbdc12a7a856ebc102f25c4816be7bbba2a456ceb67eceeed7d65
[STDOUT  ] 2017-05-18T21:00:42.875147282Z: Deleted: sha256:e7bb2ab46f0cfc5a72e9c19d9da30c11d62d1783fa30f4436b720b34a0719f0a
[STDOUT  ] 2017-05-18T21:00:42.875156423Z: Deleted: sha256:3218eed83b594299f183fe6ad405ab6f3771c3772134cef018173e2d073cf84d
[STDOUT  ] 2017-05-18T21:00:42.875174626Z: Deleted: sha256:8adba7fca0591f82abb0bc0fe14c416eb21439abbcf899e6d53bf9106ff9bd32
[STDERR  ] 2017-05-18T21:00:42.875807249Z: + find . -iname kmod* -not -iname *.yml -exec rm -rf {} ;
[PASS    ] linuxkit.kernel.kmod 55.58s
