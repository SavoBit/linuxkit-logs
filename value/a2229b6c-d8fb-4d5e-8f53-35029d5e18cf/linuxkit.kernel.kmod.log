[INFO    ] 2017-05-22T14:14:33.434596708Z: Running Test linuxkit.kernel.kmod in /tmp/with_clone33061658/test/cases/020_kernel/010_kmod
[INFO    ] 2017-05-22T14:14:33.434731387Z: Running command: [/bin/sh -x /tmp/with_clone33061658/test/cases/020_kernel/010_kmod/test.sh]
[STDERR  ] 2017-05-22T14:14:33.43570044Z: + set -e
[STDERR  ] 2017-05-22T14:14:33.435720947Z: + . /tmp/with_clone33061658/test/cases/_lib/lib.sh
[STDERR  ] 2017-05-22T14:14:33.435728321Z: + [ -f src/github.com/linuxkit/rtf/lib/lib.sh ]
[STDERR  ] 2017-05-22T14:14:33.435777415Z: + LINUXKIT_TMPDIR=/tmp/with_clone33061658/test/cases/_tmp
[STDERR  ] 2017-05-22T14:14:33.435794123Z: + [ -f /tmp/with_clone33061658/test/cases/_tmp/env.sh ]
[STDERR  ] 2017-05-22T14:14:33.435809941Z: + . /tmp/with_clone33061658/test/cases/_tmp/env.sh
[STDERR  ] 2017-05-22T14:14:33.435828406Z: + export LINUXKIT_EXAMPLES_DIR=/tmp/with_clone33061658/test/cases/../../examples
[STDERR  ] 2017-05-22T14:14:33.435844991Z: + RT_CANCEL=253
[STDERR  ] 2017-05-22T14:14:33.435861383Z: + IMAGE_NAME=kmod-test
[STDERR  ] 2017-05-22T14:14:33.435876509Z: + trap clean_up EXIT
[STDERR  ] 2017-05-22T14:14:33.435920475Z: + docker pull linuxkit/kernel:4.9.x
[STDOUT  ] 2017-05-22T14:14:34.844682867Z: 4.9.x: Pulling from linuxkit/kernel
[STDOUT  ] 2017-05-22T14:14:34.844723591Z: Digest: sha256:41235c0c1093801dea6bf8acfb31091fcddd4848a752a77b89729f1e6320bbc7
[STDOUT  ] 2017-05-22T14:14:34.844758344Z: Status: Image is up to date for linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-22T14:14:34.849135916Z: + docker build -t kmod-test .
[STDOUT  ] 2017-05-22T14:14:34.866439461Z: Sending build context to Docker daemon 9.216 kB
[STDOUT  ] 2017-05-22T14:14:35.088635281Z: Step 1/11 : FROM linuxkit/kernel:4.9.x AS ksrc
[STDOUT  ] 2017-05-22T14:14:35.088706349Z:  ---> 3173edc4f8bb
[STDOUT  ] 2017-05-22T14:14:35.088750295Z: Step 2/11 : FROM linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b AS build
[STDOUT  ] 2017-05-22T14:14:35.08875662Z:  ---> 261c60c4eb02
[STDOUT  ] 2017-05-22T14:14:35.088770753Z: Step 3/11 : COPY --from=ksrc /kernel-dev.tar /
[STDOUT  ] 2017-05-22T14:14:36.733745172Z:  ---> 0cfa3025a7d5
[STDOUT  ] 2017-05-22T14:14:36.789514509Z: Removing intermediate container 8f0acce83ea8
[STDOUT  ] 2017-05-22T14:14:36.789535135Z: Step 4/11 : RUN tar xf kernel-dev.tar
[STDOUT  ] 2017-05-22T14:14:36.926918843Z:  ---> Running in 74a402fa722f
[STDOUT  ] 2017-05-22T14:14:41.743078316Z:  ---> b826ce78a5eb
[STDOUT  ] 2017-05-22T14:14:42.169562757Z: Removing intermediate container 74a402fa722f
[STDOUT  ] 2017-05-22T14:14:42.169572078Z: Step 5/11 : WORKDIR /kmod
[STDOUT  ] 2017-05-22T14:14:42.694806856Z:  ---> 3f1f74a8a50d
[STDOUT  ] 2017-05-22T14:14:42.711019723Z: Removing intermediate container cc5a0aeb90f8
[STDOUT  ] 2017-05-22T14:14:42.711031923Z: Step 6/11 : COPY ./src/* ./
[STDOUT  ] 2017-05-22T14:14:43.359018569Z:  ---> acf1511849fc
[STDOUT  ] 2017-05-22T14:14:43.375217415Z: Removing intermediate container caf5b7040635
[STDOUT  ] 2017-05-22T14:14:43.375237179Z: Step 7/11 : RUN make all
[STDOUT  ] 2017-05-22T14:14:43.468056955Z:  ---> Running in 0e8465876183
[STDOUT  ] 2017-05-22T14:14:43.873655487Z: make -C /usr/src/linux-headers-4.9.29-linuxkit M=/kmod modules
[STDOUT  ] 2017-05-22T14:14:43.889768024Z: make[1]: Entering directory '/usr/src/linux-headers-4.9.29-linuxkit'
[STDOUT  ] 2017-05-22T14:14:44.567413965Z:   CC [M]  /kmod/hello_world.o
[STDOUT  ] 2017-05-22T14:14:44.757137181Z:   Building modules, stage 2.
[STDOUT  ] 2017-05-22T14:14:44.773381561Z:   MODPOST 1 modules
[STDOUT  ] 2017-05-22T14:14:44.773400508Z:   CC      /kmod/hello_world.mod.o
[STDOUT  ] 2017-05-22T14:14:44.941743156Z:   LD [M]  /kmod/hello_world.ko
[STDOUT  ] 2017-05-22T14:14:44.957918401Z: make[1]: Leaving directory '/usr/src/linux-headers-4.9.29-linuxkit'
[STDOUT  ] 2017-05-22T14:14:45.568833726Z:  ---> 73dd8d31fb60
[STDOUT  ] 2017-05-22T14:14:45.583817399Z: Removing intermediate container 0e8465876183
[STDOUT  ] 2017-05-22T14:14:45.583829155Z: Step 8/11 : FROM alpine:3.5
[STDOUT  ] 2017-05-22T14:14:45.583864313Z:  ---> 02674b9cb179
[STDOUT  ] 2017-05-22T14:14:45.583871431Z: Step 9/11 : COPY --from=build /kmod/hello_world.ko /
[STDOUT  ] 2017-05-22T14:14:46.070985853Z:  ---> 9765aaa14bbe
[STDOUT  ] 2017-05-22T14:14:46.087109103Z: Removing intermediate container 7fa7a66294de
[STDOUT  ] 2017-05-22T14:14:46.087127703Z: Step 10/11 : COPY check.sh /check.sh
[STDOUT  ] 2017-05-22T14:14:46.56711739Z:  ---> cab020a4f122
[STDOUT  ] 2017-05-22T14:14:46.583255765Z: Removing intermediate container 033074fb3a16
[STDOUT  ] 2017-05-22T14:14:46.583274704Z: Step 11/11 : ENTRYPOINT /bin/sh /check.sh
[STDOUT  ] 2017-05-22T14:14:46.699135267Z:  ---> Running in 1fcd4c620742
[STDOUT  ] 2017-05-22T14:14:46.887550585Z:  ---> 0e291e878022
[STDOUT  ] 2017-05-22T14:14:46.903775786Z: Removing intermediate container 1fcd4c620742
[STDOUT  ] 2017-05-22T14:14:46.903797523Z: Successfully built 0e291e878022
[STDOUT  ] 2017-05-22T14:14:46.903812749Z: Successfully tagged kmod-test:latest
[STDERR  ] 2017-05-22T14:14:46.97122538Z: + moby build kmod
[STDERR  ] 2017-05-22T14:14:46.984406746Z: Extract kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-22T14:14:52.651216755Z: Add init containers:
[STDERR  ] 2017-05-22T14:14:52.65125342Z: Process init image: linuxkit/init:cbd7ae748f0a082516501a3e914fa0c924ee941e
[STDERR  ] 2017-05-22T14:14:52.9871189Z: Process init image: linuxkit/runc:24dfe632ed3ff53a026ee3fac046fd544434e2d6
[STDERR  ] 2017-05-22T14:14:53.663070309Z: Process init image: linuxkit/containerd:f1130450206d4f64f0ddc13d15bb68435aa1ff61
[STDERR  ] 2017-05-22T14:14:58.513668163Z: Add onboot containers:
[STDERR  ] 2017-05-22T14:14:58.513713881Z:   Create OCI config for kmod-test
[STDERR  ] 2017-05-22T14:14:59.766271733Z:   Create OCI config for linuxkit/poweroff:a8f1e4ad8d459f1fdaad9e4b007512cb3b504ae8
[STDERR  ] 2017-05-22T14:15:00.589305579Z: Create outputs:
[STDERR  ] 2017-05-22T14:15:09.957765802Z:   kmod-kernel kmod-initrd.img kmod-cmdline
[STDERR  ] 2017-05-22T14:15:10.140646037Z: + linuxkit run qemu kmod
[STDERR  ] 2017-05-22T14:15:10.14080712Z: + grep -q Hello LinuxKit
[STDERR  ] 2017-05-22T14:15:39.620486483Z: + clean_up
[STDERR  ] 2017-05-22T14:15:39.620510335Z: + docker rmi kmod-test
[STDOUT  ] 2017-05-22T14:15:39.67174009Z: Untagged: kmod-test:latest
[STDOUT  ] 2017-05-22T14:15:39.671764297Z: Deleted: sha256:0e291e878022c3f32dafd30f481445de8374a84f75e17f316857c93f1d85df45
[STDOUT  ] 2017-05-22T14:15:39.671777743Z: Deleted: sha256:cab020a4f122cfecdd636470c14f2e905879863285021f67c958273f7e248ca2
[STDOUT  ] 2017-05-22T14:15:39.671787883Z: Deleted: sha256:70d31f228f77e5efc9f0acdf921b900835c907c3edd8e269e4155a3109f7954d
[STDOUT  ] 2017-05-22T14:15:39.671797212Z: Deleted: sha256:9765aaa14bbe46fa5c875be2f915272c4d5cd4c21a07b2c94e9417306329bd5f
[STDOUT  ] 2017-05-22T14:15:39.671811161Z: Deleted: sha256:7370442089a20445f62a0fc2cab19534ad1e1bff13c23d387b0371ed167732df
[STDERR  ] 2017-05-22T14:15:39.674876171Z: + find . -iname kmod* -not -iname *.yml -exec rm -rf {} ;
[PASS    ] linuxkit.kernel.kmod 66.26s
