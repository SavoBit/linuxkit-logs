[INFO    ] 2017-05-31T16:59:23.008477246Z: Running Test linuxkit.kernel.kmod_4.9.x in /tmp/build/test/cases/020_kernel/010_kmod_4.9.x
[INFO    ] 2017-05-31T16:59:23.008532936Z: Running command: [/bin/sh -x /tmp/build/test/cases/020_kernel/010_kmod_4.9.x/test.sh]
[STDERR  ] 2017-05-31T16:59:23.044151831Z: + set -e
[STDERR  ] 2017-05-31T16:59:23.044200962Z: + . /tmp/build/test/cases/_lib/lib.sh
[STDERR  ] 2017-05-31T16:59:23.044269617Z: + [ -f src/github.com/linuxkit/rtf/lib/lib.sh ]
[STDERR  ] 2017-05-31T16:59:23.044305894Z: + LINUXKIT_TMPDIR=/tmp/build/test/cases/_tmp
[STDERR  ] 2017-05-31T16:59:23.044346018Z: + [ -f /tmp/build/test/cases/_tmp/env.sh ]
[STDERR  ] 2017-05-31T16:59:23.044369337Z: + . /tmp/build/test/cases/_tmp/env.sh
[STDERR  ] 2017-05-31T16:59:23.044398642Z: + export LINUXKIT_EXAMPLES_DIR=/tmp/build/test/cases/../../examples
[STDERR  ] 2017-05-31T16:59:23.044430773Z: + RT_CANCEL=253
[STDERR  ] 2017-05-31T16:59:23.044455141Z: + IMAGE_NAME=kmod-test
[STDERR  ] 2017-05-31T16:59:23.044489447Z: + trap clean_up EXIT
[STDERR  ] 2017-05-31T16:59:23.044518641Z: + docker pull linuxkit/kernel:4.9.x
[STDOUT  ] 2017-05-31T16:59:24.302174376Z: 4.9.x: Pulling from linuxkit/kernel
[STDOUT  ] 2017-05-31T16:59:24.30228268Z: Digest: sha256:a0bc40648edf7e73b9801f2887b0aefab9ec1878dcbe3bcff8ea48ebfffdb4d7
[STDOUT  ] 2017-05-31T16:59:24.30234424Z: Status: Image is up to date for linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-31T16:59:24.30305342Z: + docker build -t kmod-test .
[STDOUT  ] 2017-05-31T16:59:24.317990275Z: Sending build context to Docker daemon  9.216kB
[STDOUT  ] 2017-05-31T16:59:24.365810989Z: Step 1/11 : FROM linuxkit/kernel:4.9.x AS ksrc
[STDOUT  ] 2017-05-31T16:59:24.375339156Z:  ---> 15f175ba5ede
[STDOUT  ] 2017-05-31T16:59:24.375369944Z: Step 2/11 : FROM linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b AS build
[STDOUT  ] 2017-05-31T16:59:25.802380483Z: 1b396c221af673757703258159ddc8539843b02b: Pulling from linuxkit/kernel-compile
[STDOUT  ] 2017-05-31T16:59:25.873958459Z: 627beaf3eaaf: Already exists
[STDOUT  ] 2017-05-31T16:59:25.910535431Z: 26dc4067def6: Pulling fs layer
[STDOUT  ] 2017-05-31T16:59:30.165928071Z: 26dc4067def6: Verifying Checksum
[STDOUT  ] 2017-05-31T16:59:30.167254782Z: 26dc4067def6: Download complete
[STDOUT  ] 2017-05-31T16:59:36.7762832Z: 26dc4067def6: Pull complete
[STDOUT  ] 2017-05-31T16:59:36.797915834Z: Digest: sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-31T16:59:36.806072944Z: Status: Downloaded newer image for linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-31T16:59:36.806414001Z:  ---> 261c60c4eb02
[STDOUT  ] 2017-05-31T16:59:36.806525093Z: Step 3/11 : COPY --from=ksrc /kernel-dev.tar /
[STDOUT  ] 2017-05-31T16:59:38.839925155Z:  ---> 8e735c19a4a6
[STDOUT  ] 2017-05-31T16:59:38.860740044Z: Removing intermediate container ec4366f65a77
[STDOUT  ] 2017-05-31T16:59:38.86091285Z: Step 4/11 : RUN tar xf kernel-dev.tar
[STDOUT  ] 2017-05-31T16:59:38.953658734Z:  ---> Running in a9872a8d81b0
[STDOUT  ] 2017-05-31T16:59:46.351308864Z:  ---> 92ba917ae818
[STDOUT  ] 2017-05-31T16:59:46.70592615Z: Removing intermediate container a9872a8d81b0
[STDOUT  ] 2017-05-31T16:59:46.706053824Z: Step 5/11 : WORKDIR /kmod
[STDOUT  ] 2017-05-31T16:59:46.86867441Z:  ---> 5e3b98996a7d
[STDOUT  ] 2017-05-31T16:59:46.874990606Z: Removing intermediate container 9c698d726fc0
[STDOUT  ] 2017-05-31T16:59:46.875140007Z: Step 6/11 : COPY ./src/* ./
[STDOUT  ] 2017-05-31T16:59:47.079561446Z:  ---> 63d52061169b
[STDOUT  ] 2017-05-31T16:59:47.085232729Z: Removing intermediate container 6d1f8b9180b0
[STDOUT  ] 2017-05-31T16:59:47.085358335Z: Step 7/11 : RUN make all
[STDOUT  ] 2017-05-31T16:59:47.151821675Z:  ---> Running in 0faac182ce13
[STDOUT  ] 2017-05-31T16:59:47.292318424Z: make -C /usr/src/linux-headers-4.9.30-linuxkit M=/kmod modules
[STDOUT  ] 2017-05-31T16:59:47.293392796Z: make[1]: Entering directory '/usr/src/linux-headers-4.9.30-linuxkit'
[STDOUT  ] 2017-05-31T16:59:48.078895775Z:   CC [M]  /kmod/hello_world.o
[STDOUT  ] 2017-05-31T16:59:48.266194358Z:   Building modules, stage 2.
[STDOUT  ] 2017-05-31T16:59:48.271945292Z:   MODPOST 1 modules
[STDOUT  ] 2017-05-31T16:59:48.282060958Z:   CC      /kmod/hello_world.mod.o
[STDOUT  ] 2017-05-31T16:59:48.448601712Z:   LD [M]  /kmod/hello_world.ko
[STDOUT  ] 2017-05-31T16:59:48.450762559Z: make[1]: Leaving directory '/usr/src/linux-headers-4.9.30-linuxkit'
[STDOUT  ] 2017-05-31T16:59:48.599305189Z:  ---> 2804b61f45e9
[STDOUT  ] 2017-05-31T16:59:48.604861136Z: Removing intermediate container 0faac182ce13
[STDOUT  ] 2017-05-31T16:59:48.604992159Z: Step 8/11 : FROM alpine:3.5
[STDOUT  ] 2017-05-31T16:59:49.700841219Z: 3.5: Pulling from library/alpine
[STDOUT  ] 2017-05-31T16:59:49.701538578Z: 6f821164d5b7: Pulling fs layer
[STDOUT  ] 2017-05-31T16:59:50.321653424Z: 6f821164d5b7: Verifying Checksum
[STDOUT  ] 2017-05-31T16:59:50.323061231Z: 6f821164d5b7: Download complete
[STDOUT  ] 2017-05-31T16:59:50.500183648Z: 6f821164d5b7: Pull complete
[STDOUT  ] 2017-05-31T16:59:50.500268089Z: Digest: sha256:f02537b30c729bb1ee0c67c8bff3a28972bed0abbee8f5520421994c5247b896
[STDOUT  ] 2017-05-31T16:59:50.500333239Z: Status: Downloaded newer image for alpine:3.5
[STDOUT  ] 2017-05-31T16:59:50.500627604Z:  ---> 75b63e430bd1
[STDOUT  ] 2017-05-31T16:59:50.500731399Z: Step 9/11 : COPY --from=build /kmod/hello_world.ko /
[STDOUT  ] 2017-05-31T16:59:50.676926381Z:  ---> 4cff2dbe62b8
[STDOUT  ] 2017-05-31T16:59:50.682719331Z: Removing intermediate container 90c79bd5f001
[STDOUT  ] 2017-05-31T16:59:50.682863818Z: Step 10/11 : COPY check.sh /check.sh
[STDOUT  ] 2017-05-31T16:59:50.828468247Z:  ---> 14691d7eca23
[STDOUT  ] 2017-05-31T16:59:50.833989182Z: Removing intermediate container 3144bd9fd1bf
[STDOUT  ] 2017-05-31T16:59:50.834143842Z: Step 11/11 : ENTRYPOINT /bin/sh /check.sh
[STDOUT  ] 2017-05-31T16:59:50.900208348Z:  ---> Running in 1f6aa2a078fd
[STDOUT  ] 2017-05-31T16:59:50.946567864Z:  ---> dde0548532ab
[STDOUT  ] 2017-05-31T16:59:50.952675545Z: Removing intermediate container 1f6aa2a078fd
[STDOUT  ] 2017-05-31T16:59:50.952771567Z: Successfully built dde0548532ab
[STDOUT  ] 2017-05-31T16:59:50.957165213Z: Successfully tagged kmod-test:latest
[STDERR  ] 2017-05-31T16:59:50.968121105Z: + moby build -output kernel+initrd kmod
[STDERR  ] 2017-05-31T16:59:50.976489121Z: Pull kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-31T16:59:53.944929801Z: Extract kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-31T16:59:53.944941481Z: Pull image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-31T16:59:57.372344598Z: Add init containers:
[STDERR  ] 2017-05-31T16:59:57.372435755Z: Process init image: linuxkit/init:1b8a7e394d2ec2f1fdb4d67645829d1b5bdca037
[STDERR  ] 2017-05-31T16:59:57.372471366Z: Pull image: linuxkit/init:1b8a7e394d2ec2f1fdb4d67645829d1b5bdca037
[STDERR  ] 2017-05-31T17:00:00.455107105Z: Process init image: linuxkit/runc:3a4e6cbf15470f62501b019b55e1caac5ee7689f
[STDERR  ] 2017-05-31T17:00:00.455149073Z: Pull image: linuxkit/runc:3a4e6cbf15470f62501b019b55e1caac5ee7689f
[STDERR  ] 2017-05-31T17:00:03.352684377Z: Process init image: linuxkit/containerd:deaf5bf838bf7f131c2287ecff3ed9835b0497e2
[STDERR  ] 2017-05-31T17:00:03.352769341Z: Pull image: linuxkit/containerd:deaf5bf838bf7f131c2287ecff3ed9835b0497e2
[STDERR  ] 2017-05-31T17:00:06.67299338Z: Add onboot containers:
[STDERR  ] 2017-05-31T17:00:06.673042704Z:   Create OCI config for kmod-test
[STDERR  ] 2017-05-31T17:00:06.820732916Z:   Create OCI config for linuxkit/poweroff:7404cf2295df89ccfa2dda41997a28307a90cf28
[STDERR  ] 2017-05-31T17:00:06.823061643Z: Pull image: linuxkit/poweroff:7404cf2295df89ccfa2dda41997a28307a90cf28
[STDERR  ] 2017-05-31T17:00:10.064089384Z: Create outputs:
[STDERR  ] 2017-05-31T17:00:16.026154004Z:   kmod-kernel kmod-initrd.img kmod-cmdline
[STDERR  ] 2017-05-31T17:00:16.078602148Z: + grep -q Hello LinuxKit
[STDERR  ] 2017-05-31T17:00:16.07950644Z: + linuxkit run qemu kmod
[STDERR  ] 2017-05-31T17:00:16.093177688Z: Unable to find qemu-system-x86_64 within the $PATH. Using a container
[STDERR  ] 2017-05-31T17:00:34.491095531Z: write /dev/stdout: broken pipe
[STDERR  ] 2017-05-31T17:00:34.493363292Z: time="2017-05-31T17:00:34Z" level=fatal msg="exit status 1" 
[STDERR  ] 2017-05-31T17:00:34.493371922Z: + clean_up
[STDERR  ] 2017-05-31T17:00:34.493378454Z: + docker rmi kmod-test
[STDOUT  ] 2017-05-31T17:00:34.544550591Z: Untagged: kmod-test:latest
[STDOUT  ] 2017-05-31T17:00:34.544562938Z: Deleted: sha256:dde0548532ab65223533b9b572d095fe993ea2e3cf9b9dfbc9fc0ff4ac745ed8
[STDOUT  ] 2017-05-31T17:00:34.544569526Z: Deleted: sha256:14691d7eca239b93b8c8e010aa32af3e10072cbe657c0f7bd9531536f10c3d38
[STDOUT  ] 2017-05-31T17:00:34.544576902Z: Deleted: sha256:c7d773909c946a6534d5bc210dc63b2a4960025af2106ecf045e5192cd234336
[STDOUT  ] 2017-05-31T17:00:34.544598999Z: Deleted: sha256:4cff2dbe62b81abba835e8cbc48a220807b076700d85eb6f80a57f49fab95379
[STDOUT  ] 2017-05-31T17:00:34.544605517Z: Deleted: sha256:84a39393ed1f782b28a377435e3d6c00b5b1c24d0dc55834971ceacba892eb5f
[STDERR  ] 2017-05-31T17:00:34.545284414Z: + find . -iname kmod* -not -iname *.yml -exec rm -rf {} ;
[PASS    ] linuxkit.kernel.kmod_4.9.x 71.56s
