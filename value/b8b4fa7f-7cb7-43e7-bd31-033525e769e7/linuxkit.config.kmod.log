[INFO    ] 2017-05-16T10:53:45.246694625Z: Running Test linuxkit.config.kmod in /tmp/build/test/cases/000_config/010_kmod
[INFO    ] 2017-05-16T10:53:45.246770678Z: Running command: [/bin/sh -x /tmp/build/test/cases/000_config/010_kmod/test.sh]
[STDERR  ] 2017-05-16T10:53:45.247663246Z: + set -e
[STDERR  ] 2017-05-16T10:53:45.247726945Z: + . /tmp/build/test/cases/_lib/lib.sh
[STDERR  ] 2017-05-16T10:53:45.247785173Z: + [ -f src/github.com/linuxkit/rtf/lib/lib.sh ]
[STDERR  ] 2017-05-16T10:53:45.247827237Z: + LINUXKIT_TMPDIR=/tmp/build/test/cases/_tmp
[STDERR  ] 2017-05-16T10:53:45.247857463Z: + LINUXKIT_ARTIFACTS_DIR=/tmp/build/test/cases/../../artifacts
[STDERR  ] 2017-05-16T10:53:45.247904387Z: + [ -f /tmp/build/test/cases/_tmp/env.sh ]
[STDERR  ] 2017-05-16T10:53:45.247944127Z: + . /tmp/build/test/cases/_tmp/env.sh
[STDERR  ] 2017-05-16T10:53:45.247981247Z: + export LINUXKIT_EXAMPLES_DIR=/tmp/build/test/cases/../../examples
[STDERR  ] 2017-05-16T10:53:45.248018012Z: + RT_CANCEL=253
[STDERR  ] 2017-05-16T10:53:45.248050687Z: + IMAGE_NAME=kmod-test
[STDERR  ] 2017-05-16T10:53:45.248096723Z: + trap clean_up EXIT
[STDERR  ] 2017-05-16T10:53:45.248141474Z: + docker pull linuxkit/kernel:4.9.x
[STDOUT  ] 2017-05-16T10:53:46.369830095Z: 4.9.x: Pulling from linuxkit/kernel
[STDOUT  ] 2017-05-16T10:53:46.370115499Z: Digest: sha256:dd706d391fddc3d2efc254a6c03223d6cb82b86a3dc059a9264063be2fd8911f
[STDOUT  ] 2017-05-16T10:53:46.37018952Z: Status: Image is up to date for linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-16T10:53:46.371077246Z: + docker build -t kmod-test .
[STDOUT  ] 2017-05-16T10:53:46.40614277Z: Sending build context to Docker daemon  9.216kB
[STDOUT  ] 2017-05-16T10:53:46.409963572Z: Step 1/11 : FROM linuxkit/kernel:4.9.x AS ksrc
[STDOUT  ] 2017-05-16T10:53:46.410094417Z:  ---> cc9f6cd19506
[STDOUT  ] 2017-05-16T10:53:46.410138421Z: Step 2/11 : FROM linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b AS build
[STDOUT  ] 2017-05-16T10:53:47.583755948Z: 1b396c221af673757703258159ddc8539843b02b: Pulling from linuxkit/kernel-compile
[STDOUT  ] 2017-05-16T10:53:47.583834832Z: 627beaf3eaaf: Already exists
[STDOUT  ] 2017-05-16T10:53:47.596168851Z: 26dc4067def6: Pulling fs layer
[STDOUT  ] 2017-05-16T10:53:51.401254805Z: 26dc4067def6: Verifying Checksum
[STDOUT  ] 2017-05-16T10:53:51.401449746Z: 26dc4067def6: Download complete
[STDOUT  ] 2017-05-16T10:53:58.445630547Z: 26dc4067def6: Pull complete
[STDOUT  ] 2017-05-16T10:53:58.445887935Z: Digest: sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-16T10:53:58.445999808Z: Status: Downloaded newer image for linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-16T10:53:58.446484778Z:  ---> 261c60c4eb02
[STDOUT  ] 2017-05-16T10:53:58.44664095Z: Step 3/11 : COPY --from=ksrc /kernel-dev.tar /
[STDOUT  ] 2017-05-16T10:54:00.676119803Z:  ---> 89374d6e41ab
[STDOUT  ] 2017-05-16T10:54:00.697484971Z: Removing intermediate container cd127fe41771
[STDOUT  ] 2017-05-16T10:54:00.697816766Z: Step 4/11 : RUN tar xf kernel-dev.tar
[STDOUT  ] 2017-05-16T10:54:00.783128957Z:  ---> Running in 010bbcb121fb
[STDOUT  ] 2017-05-16T10:54:10.235865701Z:  ---> e6add5f420b1
[STDOUT  ] 2017-05-16T10:54:10.542349635Z: Removing intermediate container 010bbcb121fb
[STDOUT  ] 2017-05-16T10:54:10.54262421Z: Step 5/11 : WORKDIR /kmod
[STDOUT  ] 2017-05-16T10:54:10.721519124Z:  ---> 7ae6eb707d61
[STDOUT  ] 2017-05-16T10:54:10.727014721Z: Removing intermediate container 61114f153c5c
[STDOUT  ] 2017-05-16T10:54:10.727280861Z: Step 6/11 : COPY ./src/* ./
[STDOUT  ] 2017-05-16T10:54:10.908656613Z:  ---> d6b575f06da7
[STDOUT  ] 2017-05-16T10:54:10.914023931Z: Removing intermediate container 393b06c68193
[STDOUT  ] 2017-05-16T10:54:10.914257306Z: Step 7/11 : RUN make all
[STDOUT  ] 2017-05-16T10:54:10.974539738Z:  ---> Running in f4c640a4d75e
[STDOUT  ] 2017-05-16T10:54:11.147569507Z: make -C /usr/src/linux-headers-4.9.28-linuxkit M=/kmod modules
[STDOUT  ] 2017-05-16T10:54:11.148888975Z: make[1]: Entering directory '/usr/src/linux-headers-4.9.28-linuxkit'
[STDOUT  ] 2017-05-16T10:54:12.047728212Z:   CC [M]  /kmod/hello_world.o
[STDOUT  ] 2017-05-16T10:54:12.233674111Z:   Building modules, stage 2.
[STDOUT  ] 2017-05-16T10:54:12.240713382Z:   MODPOST 1 modules
[STDOUT  ] 2017-05-16T10:54:12.251297857Z:   CC      /kmod/hello_world.mod.o
[STDOUT  ] 2017-05-16T10:54:12.424424777Z:   LD [M]  /kmod/hello_world.ko
[STDOUT  ] 2017-05-16T10:54:12.427005042Z: make[1]: Leaving directory '/usr/src/linux-headers-4.9.28-linuxkit'
[STDOUT  ] 2017-05-16T10:54:12.577788966Z:  ---> 5154b703a4c4
[STDOUT  ] 2017-05-16T10:54:12.585762606Z: Removing intermediate container f4c640a4d75e
[STDOUT  ] 2017-05-16T10:54:12.585999906Z: Step 8/11 : FROM alpine:3.5
[STDOUT  ] 2017-05-16T10:54:13.740519528Z: 3.5: Pulling from library/alpine
[STDOUT  ] 2017-05-16T10:54:13.74140197Z: cfc728c1c558: Pulling fs layer
[STDOUT  ] 2017-05-16T10:54:14.379053327Z: cfc728c1c558: Verifying Checksum
[STDOUT  ] 2017-05-16T10:54:14.380394154Z: cfc728c1c558: Download complete
[STDOUT  ] 2017-05-16T10:54:14.566039159Z: cfc728c1c558: Pull complete
[STDOUT  ] 2017-05-16T10:54:14.566220588Z: Digest: sha256:c0537ff6a5218ef531ece93d4984efc99bbf3f7497c0a7726c88e2bb7584dc96
[STDOUT  ] 2017-05-16T10:54:14.566299693Z: Status: Downloaded newer image for alpine:3.5
[STDOUT  ] 2017-05-16T10:54:14.566605297Z:  ---> 02674b9cb179
[STDOUT  ] 2017-05-16T10:54:14.566721121Z: Step 9/11 : COPY --from=build /kmod/hello_world.ko /
[STDOUT  ] 2017-05-16T10:54:14.739195491Z:  ---> ae3cb0063d61
[STDOUT  ] 2017-05-16T10:54:14.746966303Z: Removing intermediate container 31c0b3d2b2ba
[STDOUT  ] 2017-05-16T10:54:14.747191554Z: Step 10/11 : COPY check.sh /check.sh
[STDOUT  ] 2017-05-16T10:54:14.898808208Z:  ---> d972fdb8639d
[STDOUT  ] 2017-05-16T10:54:14.90504951Z: Removing intermediate container 8f73f0fb3e0f
[STDOUT  ] 2017-05-16T10:54:14.905271643Z: Step 11/11 : ENTRYPOINT /bin/sh /check.sh
[STDOUT  ] 2017-05-16T10:54:14.966529241Z:  ---> Running in 74746cbccb05
[STDOUT  ] 2017-05-16T10:54:15.041188288Z:  ---> 7be5c4d732c6
[STDOUT  ] 2017-05-16T10:54:15.048194559Z: Removing intermediate container 74746cbccb05
[STDOUT  ] 2017-05-16T10:54:15.048459045Z: Successfully built 7be5c4d732c6
[STDOUT  ] 2017-05-16T10:54:15.053174555Z: Successfully tagged kmod-test:latest
[STDERR  ] 2017-05-16T10:54:15.065941004Z: + moby build kmod
[STDERR  ] 2017-05-16T10:54:15.075720227Z: Extract kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-16T10:54:15.607412479Z: Add init containers:
[STDERR  ] 2017-05-16T10:54:15.607580337Z: Process init image: linuxkit/init:b3740303f3d1e5689a84c87b7dfb48fd2a40a192
[STDERR  ] 2017-05-16T10:54:15.731059207Z: Process init image: linuxkit/runc:47b1c38d63468c0f3078f8b1b055d07965a1895d
[STDERR  ] 2017-05-16T10:54:15.859402682Z: Process init image: linuxkit/containerd:cf2614f5a96c569a0bd4bd54e054a65ba17d167f
[STDERR  ] 2017-05-16T10:54:16.269664256Z: Add onboot containers:
[STDERR  ] 2017-05-16T10:54:16.26988147Z:   Create OCI config for kmod-test
[STDERR  ] 2017-05-16T10:54:16.396068544Z:   Create OCI config for linuxkit/poweroff:961412b8ef5c5285de0d40ec076701d955eaa084
[STDERR  ] 2017-05-16T10:54:16.550223887Z: Create outputs:
[STDERR  ] 2017-05-16T10:54:21.423965125Z:   kmod-kernel kmod-initrd.img kmod-cmdline
[STDERR  ] 2017-05-16T10:54:21.472372128Z: + grep -q Hello LinuxKit
[STDERR  ] 2017-05-16T10:54:21.473370616Z: + linuxkit run qemu kmod
[STDERR  ] 2017-05-16T10:54:21.4796056Z: Unable to find qemu-system-x86_64 within the $PATH. Using a container
[STDERR  ] 2017-05-16T10:54:36.951839096Z: write /dev/stdout: broken pipe
[STDERR  ] 2017-05-16T10:54:36.953360283Z: time="2017-05-16T10:54:36Z" level=fatal msg="exit status 1" 
[STDERR  ] 2017-05-16T10:54:36.953372297Z: + clean_up
[STDERR  ] 2017-05-16T10:54:36.953397651Z: + docker rmi kmod-test
[STDOUT  ] 2017-05-16T10:54:36.985758215Z: Untagged: kmod-test:latest
[STDOUT  ] 2017-05-16T10:54:36.985769Z: Deleted: sha256:7be5c4d732c6c0f0ca6c893068e15372d7c64d0c3a46087f04a25ac22e60cbd3
[STDOUT  ] 2017-05-16T10:54:36.985794385Z: Deleted: sha256:d972fdb8639df0a926a7ce8a18b941895f64d36013b5d993cb166367de71b2cb
[STDOUT  ] 2017-05-16T10:54:36.985808092Z: Deleted: sha256:5e515a68e827a5ba73c979d35e54df92bf642ea9bff2bc65545aedb70a2bf64d
[STDOUT  ] 2017-05-16T10:54:36.985813458Z: Deleted: sha256:ae3cb0063d6185224f94337ab211f5d065e92210cc29f3db2f68b7a332442721
[STDOUT  ] 2017-05-16T10:54:36.98582357Z: Deleted: sha256:9098a4ff26fb645bc134f3a376c52615a6394208d9180242eeaa15122d4ad8c2
[STDERR  ] 2017-05-16T10:54:36.986534232Z: + find . -iname kmod* -not -iname *.yml -exec rm -rf {} ;
[PASS    ] linuxkit.config.kmod 51.76s
