[INFO    ] 2017-05-22T20:51:07.4930557Z: Running Test linuxkit.kernel.kmod_4.9.x in /tmp/build/test/cases/020_kernel/010_kmod_4.9.x
[INFO    ] 2017-05-22T20:51:07.4931157Z: Running command: [/bin/sh -x /tmp/build/test/cases/020_kernel/010_kmod_4.9.x/test.sh]
[STDERR  ] 2017-05-22T20:51:07.516318053Z: + set -e
[STDERR  ] 2017-05-22T20:51:07.516467264Z: + . /tmp/build/test/cases/_lib/lib.sh
[STDERR  ] 2017-05-22T20:51:07.516526668Z: + [ -f src/github.com/linuxkit/rtf/lib/lib.sh ]
[STDERR  ] 2017-05-22T20:51:07.516593657Z: + LINUXKIT_TMPDIR=/tmp/build/test/cases/_tmp
[STDERR  ] 2017-05-22T20:51:07.516617633Z: + [ -f /tmp/build/test/cases/_tmp/env.sh ]
[STDERR  ] 2017-05-22T20:51:07.51664961Z: + . /tmp/build/test/cases/_tmp/env.sh
[STDERR  ] 2017-05-22T20:51:07.516687293Z: + export LINUXKIT_EXAMPLES_DIR=/tmp/build/test/cases/../../examples
[STDERR  ] 2017-05-22T20:51:07.516710356Z: + RT_CANCEL=253
[STDERR  ] 2017-05-22T20:51:07.516734082Z: + IMAGE_NAME=kmod-test
[STDERR  ] 2017-05-22T20:51:07.51676769Z: + trap clean_up EXIT
[STDERR  ] 2017-05-22T20:51:07.516787748Z: + docker pull linuxkit/kernel:4.9.x
[STDOUT  ] 2017-05-22T20:51:08.647930446Z: 4.9.x: Pulling from linuxkit/kernel
[STDOUT  ] 2017-05-22T20:51:08.648048759Z: Digest: sha256:41235c0c1093801dea6bf8acfb31091fcddd4848a752a77b89729f1e6320bbc7
[STDOUT  ] 2017-05-22T20:51:08.648085037Z: Status: Image is up to date for linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-22T20:51:08.649039699Z: + docker build -t kmod-test .
[STDOUT  ] 2017-05-22T20:51:08.691868903Z: Sending build context to Docker daemon  9.216kB
[STDOUT  ] 2017-05-22T20:51:08.694501141Z: Step 1/11 : FROM linuxkit/kernel:4.9.x AS ksrc
[STDOUT  ] 2017-05-22T20:51:08.720720121Z:  ---> 3173edc4f8bb
[STDOUT  ] 2017-05-22T20:51:08.720740845Z: Step 2/11 : FROM linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b AS build
[STDOUT  ] 2017-05-22T20:51:09.992854616Z: 1b396c221af673757703258159ddc8539843b02b: Pulling from linuxkit/kernel-compile
[STDOUT  ] 2017-05-22T20:51:09.992875966Z: 627beaf3eaaf: Already exists
[STDOUT  ] 2017-05-22T20:51:10.000532906Z: 26dc4067def6: Pulling fs layer
[STDOUT  ] 2017-05-22T20:51:13.625155875Z: 26dc4067def6: Verifying Checksum
[STDOUT  ] 2017-05-22T20:51:13.627201422Z: 26dc4067def6: Download complete
[STDOUT  ] 2017-05-22T20:51:20.055257854Z: 26dc4067def6: Pull complete
[STDOUT  ] 2017-05-22T20:51:20.080773819Z: Digest: sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-22T20:51:20.084109092Z: Status: Downloaded newer image for linuxkit/kernel-compile:1b396c221af673757703258159ddc8539843b02b@sha256:6b32d205bfc6407568324337b707d195d027328dbfec554428ea93e7b0a8299b
[STDOUT  ] 2017-05-22T20:51:20.084618018Z:  ---> 261c60c4eb02
[STDOUT  ] 2017-05-22T20:51:20.084723311Z: Step 3/11 : COPY --from=ksrc /kernel-dev.tar /
[STDOUT  ] 2017-05-22T20:51:22.148657918Z:  ---> 6ebe2a718584
[STDOUT  ] 2017-05-22T20:51:22.164323406Z: Removing intermediate container 3dd228494d2f
[STDOUT  ] 2017-05-22T20:51:22.164423056Z: Step 4/11 : RUN tar xf kernel-dev.tar
[STDOUT  ] 2017-05-22T20:51:22.227131993Z:  ---> Running in abbd0fc132b8
[STDOUT  ] 2017-05-22T20:51:30.793290057Z:  ---> 742a3dfd366c
[STDOUT  ] 2017-05-22T20:51:31.123799582Z: Removing intermediate container abbd0fc132b8
[STDOUT  ] 2017-05-22T20:51:31.123933002Z: Step 5/11 : WORKDIR /kmod
[STDOUT  ] 2017-05-22T20:51:31.301846045Z:  ---> 70c74e846af4
[STDOUT  ] 2017-05-22T20:51:31.308787415Z: Removing intermediate container 79d65c7ecbf2
[STDOUT  ] 2017-05-22T20:51:31.308933682Z: Step 6/11 : COPY ./src/* ./
[STDOUT  ] 2017-05-22T20:51:31.545410681Z:  ---> ba94e40d6361
[STDOUT  ] 2017-05-22T20:51:31.551962905Z: Removing intermediate container fc2373cff979
[STDOUT  ] 2017-05-22T20:51:31.552064654Z: Step 7/11 : RUN make all
[STDOUT  ] 2017-05-22T20:51:31.624180243Z:  ---> Running in 2f5ba17b87b2
[STDOUT  ] 2017-05-22T20:51:31.779120243Z: make -C /usr/src/linux-headers-4.9.29-linuxkit M=/kmod modules
[STDOUT  ] 2017-05-22T20:51:31.780419601Z: make[1]: Entering directory '/usr/src/linux-headers-4.9.29-linuxkit'
[STDOUT  ] 2017-05-22T20:51:32.724495193Z:   CC [M]  /kmod/hello_world.o
[STDOUT  ] 2017-05-22T20:51:32.914285909Z:   Building modules, stage 2.
[STDOUT  ] 2017-05-22T20:51:32.921370644Z:   MODPOST 1 modules
[STDOUT  ] 2017-05-22T20:51:32.932103639Z:   CC      /kmod/hello_world.mod.o
[STDOUT  ] 2017-05-22T20:51:33.109523577Z:   LD [M]  /kmod/hello_world.ko
[STDOUT  ] 2017-05-22T20:51:33.112044718Z: make[1]: Leaving directory '/usr/src/linux-headers-4.9.29-linuxkit'
[STDOUT  ] 2017-05-22T20:51:33.281115813Z:  ---> ae6afe51ceab
[STDOUT  ] 2017-05-22T20:51:33.287433317Z: Removing intermediate container 2f5ba17b87b2
[STDOUT  ] 2017-05-22T20:51:33.287557042Z: Step 8/11 : FROM alpine:3.5
[STDOUT  ] 2017-05-22T20:51:34.412087548Z: 3.5: Pulling from library/alpine
[STDOUT  ] 2017-05-22T20:51:34.42797009Z: cfc728c1c558: Already exists
[STDOUT  ] 2017-05-22T20:51:34.905608234Z: Digest: sha256:c0537ff6a5218ef531ece93d4984efc99bbf3f7497c0a7726c88e2bb7584dc96
[STDOUT  ] 2017-05-22T20:51:34.918339623Z: Status: Downloaded newer image for alpine:3.5
[STDOUT  ] 2017-05-22T20:51:34.9186501Z:  ---> 02674b9cb179
[STDOUT  ] 2017-05-22T20:51:34.918742759Z: Step 9/11 : COPY --from=build /kmod/hello_world.ko /
[STDOUT  ] 2017-05-22T20:51:35.096817055Z:  ---> f1367bb6bfcf
[STDOUT  ] 2017-05-22T20:51:35.103017234Z: Removing intermediate container 5064b83bc7ca
[STDOUT  ] 2017-05-22T20:51:35.103186287Z: Step 10/11 : COPY check.sh /check.sh
[STDOUT  ] 2017-05-22T20:51:35.265069749Z:  ---> 0a1f397433c7
[STDOUT  ] 2017-05-22T20:51:35.272473411Z: Removing intermediate container 8468b1c721f2
[STDOUT  ] 2017-05-22T20:51:35.272617258Z: Step 11/11 : ENTRYPOINT /bin/sh /check.sh
[STDOUT  ] 2017-05-22T20:51:35.34943939Z:  ---> Running in 0f333df3aee0
[STDOUT  ] 2017-05-22T20:51:35.412923489Z:  ---> 8305e6aa2a2a
[STDOUT  ] 2017-05-22T20:51:35.420327188Z: Removing intermediate container 0f333df3aee0
[STDOUT  ] 2017-05-22T20:51:35.420427978Z: Successfully built 8305e6aa2a2a
[STDOUT  ] 2017-05-22T20:51:35.425472184Z: Successfully tagged kmod-test:latest
[STDERR  ] 2017-05-22T20:51:35.438552437Z: + moby build kmod
[STDERR  ] 2017-05-22T20:51:35.449052759Z: Extract kernel image: linuxkit/kernel:4.9.x
[STDERR  ] 2017-05-22T20:51:35.99365826Z: Add init containers:
[STDERR  ] 2017-05-22T20:51:35.993703475Z: Process init image: linuxkit/init:cbd7ae748f0a082516501a3e914fa0c924ee941e
[STDERR  ] 2017-05-22T20:51:36.141358831Z: Process init image: linuxkit/runc:24dfe632ed3ff53a026ee3fac046fd544434e2d6
[STDERR  ] 2017-05-22T20:51:36.28253975Z: Process init image: linuxkit/containerd:f1130450206d4f64f0ddc13d15bb68435aa1ff61
[STDERR  ] 2017-05-22T20:51:36.852244736Z: Add onboot containers:
[STDERR  ] 2017-05-22T20:51:36.852287021Z:   Create OCI config for kmod-test
[STDERR  ] 2017-05-22T20:51:36.987301878Z:   Create OCI config for linuxkit/poweroff:a8f1e4ad8d459f1fdaad9e4b007512cb3b504ae8
[STDERR  ] 2017-05-22T20:51:37.124323289Z: Create outputs:
[STDERR  ] 2017-05-22T20:51:44.112190845Z:   kmod-kernel kmod-initrd.img kmod-cmdline
[STDERR  ] 2017-05-22T20:51:44.172284079Z: + grep -q Hello LinuxKit
[STDERR  ] 2017-05-22T20:51:44.173262292Z: + linuxkit run qemu kmod
[STDERR  ] 2017-05-22T20:51:44.180370757Z: Unable to find qemu-system-x86_64 within the $PATH. Using a container
[STDERR  ] 2017-05-22T20:52:07.329716122Z: write /dev/stdout: broken pipe
[STDERR  ] 2017-05-22T20:52:07.331685192Z: time="2017-05-22T20:52:07Z" level=fatal msg="exit status 1" 
[STDERR  ] 2017-05-22T20:52:07.331725376Z: + clean_up
[STDERR  ] 2017-05-22T20:52:07.331730281Z: + docker rmi kmod-test
[STDOUT  ] 2017-05-22T20:52:07.37554464Z: Untagged: kmod-test:latest
[STDOUT  ] 2017-05-22T20:52:07.375558672Z: Deleted: sha256:8305e6aa2a2af91990180ec4c5d81626e637e73c2c8d4d48df834754c7f3d339
[STDOUT  ] 2017-05-22T20:52:07.375565765Z: Deleted: sha256:0a1f397433c77903e4647cb3f6ab8c59c42844160726626e40a9ccfdaeb3a0b0
[STDOUT  ] 2017-05-22T20:52:07.375570119Z: Deleted: sha256:f256a5e971916048b2451fde60aef84a3c8dc1b417fa21cd0a3eb95d6d39442d
[STDOUT  ] 2017-05-22T20:52:07.375577119Z: Deleted: sha256:f1367bb6bfcf0f988db4b8d16488145df080714f3f6625d4551623464e1432df
[STDOUT  ] 2017-05-22T20:52:07.37559743Z: Deleted: sha256:34443e2d85a90fa495df121bf4640e3a933faea777ac6a250d8096036b5f6fd6
[STDERR  ] 2017-05-22T20:52:07.376399301Z: + find . -iname kmod* -not -iname *.yml -exec rm -rf {} ;
[PASS    ] linuxkit.kernel.kmod_4.9.x 59.91s
